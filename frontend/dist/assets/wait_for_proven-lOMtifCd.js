var ob=Object.defineProperty;var xf=r=>{throw TypeError(r)};var cb=(r,e,t)=>e in r?ob(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var u=(r,e,t)=>cb(r,typeof e!="symbol"?e+"":e,t),ub=(r,e,t)=>e.has(r)||xf("Cannot "+t);var Vc=(r,e,t)=>e.has(r)?xf("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t);var zt=(r,e,t)=>(ub(r,e,"access private method"),t);import{_ as If,p as lb,g as Ua,b as $o,i as fb}from"./index-oV6Kx-_Y.js";function*db(){const r=[1,1,1,2,4,8,16,32,64];let e=0;for(;;)yield r[Math.min(e++,r.length-1)]}function*Of(r){for(const e of r)yield e}async function Rf(r,e=db()){for(;;)try{return await r()}catch(t){const n=e.next().value;if(n===void 0)throw t;await new Promise(s=>setTimeout(s,n*1e3));continue}}class hb{constructor(e){this.numPoints=e}async init(){await this.downloadG1Data(),await this.downloadG2Data()}async streamG1Data(){return(await this.fetchG1Data()).body}async streamG2Data(){return(await this.fetchG2Data()).body}async downloadG1Data(){const e=await this.fetchG1Data();return this.data=new Uint8Array(await e.arrayBuffer())}async downloadG2Data(){const e=await this.fetchG2Data();return this.g2Data=new Uint8Array(await e.arrayBuffer())}getG1Data(){return this.data}getG2Data(){return this.g2Data}async fetchG1Data(){if(this.numPoints===0)return new Response(new Uint8Array([]));const e=this.numPoints*64-1;return await Rf(()=>fetch("https://crs.aztec.network/g1.dat",{headers:{Range:`bytes=0-${e}`},cache:"force-cache"}),Of([5,5,5]))}async fetchG2Data(){return await Rf(()=>fetch("https://crs.aztec.network/g2.dat",{cache:"force-cache"}),Of([5,5,5]))}}class mb{constructor(e){this.numPoints=e}async init(){await this.downloadG1Data()}async downloadG1Data(){const e=await this.fetchG1Data();return this.data=new Uint8Array(await e.arrayBuffer())}async streamG1Data(){return(await this.fetchG1Data()).body}getG1Data(){return this.data}async fetchG1Data(){if(this.numPoints===0)return new Response(new Uint8Array([]));const e=this.numPoints*64-1;return await fetch("https://crs.aztec.network/grumpkin_g1.dat",{headers:{Range:`bytes=0-${e}`},cache:"force-cache"})}}function Rl(r){return new Promise((e,t)=>{r.oncomplete=r.onsuccess=()=>e(r.result),r.onabort=r.onerror=()=>t(r.error)})}function pb(r,e){let t;const n=()=>{if(t)return t;const s=indexedDB.open(r);return s.onupgradeneeded=()=>s.result.createObjectStore(e),t=Rl(s),t.then(i=>{i.onclose=()=>t=void 0},()=>{}),t};return(s,i)=>n().then(a=>i(a.transaction(e,s).objectStore(e)))}let qc;function Xh(){return qc||(qc=pb("keyval-store","keyval")),qc}function Ku(r,e=Xh()){return e("readonly",t=>Rl(t.get(r)))}function Yu(r,e,t=Xh()){return t("readwrite",n=>(n.put(e,r),Rl(n.transaction)))}class Ho{constructor(e){this.numPoints=e}static async new(e){const t=new Ho(e);return await t.init(),t}async init(){const e=await Ku("g1Data"),t=await Ku("g2Data"),n=new hb(this.numPoints),s=this.numPoints*64;!e||e.length<s?(this.g1Data=await n.downloadG1Data(),await Yu("g1Data",this.g1Data)):this.g1Data=e,t?this.g2Data=t:(this.g2Data=await n.downloadG2Data(),await Yu("g2Data",this.g2Data))}getG1Data(){return this.g1Data}getG2Data(){return this.g2Data}}class Fl{constructor(e){this.numPoints=e}static async new(e){const t=new Fl(e);return await t.init(),t}async init(){const e=await Ku("grumpkinG1Data"),t=new mb(this.numPoints),n=this.numPoints*64;!e||e.length<n?(this.g1Data=await t.downloadG1Data(),await Yu("grumpkinG1Data",this.g1Data)):this.g1Data=e}getG1Data(){return this.g1Data}}/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Jh=Symbol("Comlink.proxy"),gb=Symbol("Comlink.endpoint"),yb=Symbol("Comlink.releaseProxy"),Wc=Symbol("Comlink.finalizer"),vo=Symbol("Comlink.thrown"),Qh=r=>typeof r=="object"&&r!==null||typeof r=="function",bb={canHandle:r=>Qh(r)&&r[Jh],serialize(r){const{port1:e,port2:t}=new MessageChannel;return tm(r,e),[t,[t]]},deserialize(r){return r.start(),nm(r)}},wb={canHandle:r=>Qh(r)&&vo in r,serialize({value:r}){let e;return r instanceof Error?e={isError:!0,value:{message:r.message,name:r.name,stack:r.stack}}:e={isError:!1,value:r},[e,[]]},deserialize(r){throw r.isError?Object.assign(new Error(r.value.message),r.value):r.value}},em=new Map([["proxy",bb],["throw",wb]]);function vb(r,e){for(const t of r)if(e===t||t==="*"||t instanceof RegExp&&t.test(e))return!0;return!1}function tm(r,e=globalThis,t=["*"]){e.addEventListener("message",function n(s){if(!s||!s.data)return;if(!vb(t,s.origin)){console.warn(`Invalid origin '${s.origin}' for comlink proxy`);return}const{id:i,type:a,path:o}=Object.assign({path:[]},s.data),c=(s.data.argumentList||[]).map(Ds);let f;try{const h=o.slice(0,-1).reduce((v,b)=>v[b],r),d=o.reduce((v,b)=>v[b],r);switch(a){case"GET":f=d;break;case"SET":h[o.slice(-1)[0]]=Ds(s.data.value),f=!0;break;case"APPLY":f=d.apply(h,c);break;case"CONSTRUCT":{const v=new d(...c);f=am(v)}break;case"ENDPOINT":{const{port1:v,port2:b}=new MessageChannel;tm(r,b),f=Bb(v,[v])}break;case"RELEASE":f=void 0;break;default:return}}catch(h){f={value:h,[vo]:0}}Promise.resolve(f).catch(h=>({value:h,[vo]:0})).then(h=>{const[d,v]=Uo(h);e.postMessage(Object.assign(Object.assign({},d),{id:i}),v),a==="RELEASE"&&(e.removeEventListener("message",n),rm(e),Wc in r&&typeof r[Wc]=="function"&&r[Wc]())}).catch(h=>{const[d,v]=Uo({value:new TypeError("Unserializable return value"),[vo]:0});e.postMessage(Object.assign(Object.assign({},d),{id:i}),v)})}),e.start&&e.start()}function Eb(r){return r.constructor.name==="MessagePort"}function rm(r){Eb(r)&&r.close()}function nm(r,e){const t=new Map;return r.addEventListener("message",function(s){const{data:i}=s;if(!i||!i.id)return;const a=t.get(i.id);if(a)try{a(i)}finally{t.delete(i.id)}}),Xu(r,t,[],e)}function uo(r){if(r)throw new Error("Proxy has been released and is not useable")}function sm(r){return di(r,new Map,{type:"RELEASE"}).then(()=>{rm(r)})}const Do=new WeakMap,Mo="FinalizationRegistry"in globalThis&&new FinalizationRegistry(r=>{const e=(Do.get(r)||0)-1;Do.set(r,e),e===0&&sm(r)});function Sb(r,e){const t=(Do.get(e)||0)+1;Do.set(e,t),Mo&&Mo.register(r,e,r)}function Ab(r){Mo&&Mo.unregister(r)}function Xu(r,e,t=[],n=function(){}){let s=!1;const i=new Proxy(n,{get(a,o){if(uo(s),o===yb)return()=>{Ab(i),sm(r),e.clear(),s=!0};if(o==="then"){if(t.length===0)return{then:()=>i};const c=di(r,e,{type:"GET",path:t.map(f=>f.toString())}).then(Ds);return c.then.bind(c)}return Xu(r,e,[...t,o])},set(a,o,c){uo(s);const[f,h]=Uo(c);return di(r,e,{type:"SET",path:[...t,o].map(d=>d.toString()),value:f},h).then(Ds)},apply(a,o,c){uo(s);const f=t[t.length-1];if(f===gb)return di(r,e,{type:"ENDPOINT"}).then(Ds);if(f==="bind")return Xu(r,e,t.slice(0,-1));const[h,d]=Ff(c);return di(r,e,{type:"APPLY",path:t.map(v=>v.toString()),argumentList:h},d).then(Ds)},construct(a,o){uo(s);const[c,f]=Ff(o);return di(r,e,{type:"CONSTRUCT",path:t.map(h=>h.toString()),argumentList:c},f).then(Ds)}});return Sb(i,r),i}function _b(r){return Array.prototype.concat.apply([],r)}function Ff(r){const e=r.map(Uo);return[e.map(t=>t[0]),_b(e.map(t=>t[1]))]}const im=new WeakMap;function Bb(r,e){return im.set(r,e),r}function am(r){return Object.assign(r,{[Jh]:!0})}function Uo(r){for(const[e,t]of em)if(t.canHandle(r)){const[n,s]=t.serialize(r);return[{type:"HANDLER",name:e,value:n},s]}return[{type:"RAW",value:r},im.get(r)||[]]}function Ds(r){switch(r.type){case"HANDLER":return em.get(r.name).deserialize(r.value);case"RAW":return r.value}}function di(r,e,t,n){return new Promise(s=>{const i=Tb();e.set(i,s),r.start&&r.start(),r.postMessage(Object.assign({id:i},t),n)})}function Tb(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}let on=class Ju{constructor(e,t=0){this.buffer=e,this.index=t}static asReader(e){return e instanceof Ju?e:new Ju(e)}readNumber(){const e=new DataView(this.buffer.buffer,this.buffer.byteOffset+this.index,4);return this.index+=4,e.getUint32(0,!1)}readBoolean(){return this.index+=1,!!this.buffer.at(this.index-1)}readBytes(e){return this.index+=e,this.buffer.slice(this.index-e,this.index)}readNumberVector(){return this.readVector({fromBuffer:e=>e.readNumber()})}readVector(e){const t=this.readNumber(),n=new Array(t);for(let s=0;s<t;s++)n[s]=e.fromBuffer(this);return n}readArray(e,t){const n=new Array(e);for(let s=0;s<e;s++)n[s]=t.fromBuffer(this);return n}readObject(e){return e.fromBuffer(this)}peekBytes(e){return this.buffer.subarray(this.index,e?this.index+e:void 0)}readString(){return new TextDecoder().decode(this.readBuffer())}readBuffer(){const e=this.readNumber();return this.readBytes(e)}readMap(e){const t=this.readNumber(),n={};for(let s=0;s<t;s++){const i=this.readString(),a=this.readObject(e);n[i]=a}return n}};function Nt(){return{SIZE_IN_BYTES:1,fromBuffer:r=>on.asReader(r).readBoolean()}}function Bi(){return{SIZE_IN_BYTES:4,fromBuffer:r=>on.asReader(r).readNumber()}}function Lr(r){return{fromBuffer:e=>on.asReader(e).readVector(r)}}function Ze(){return{fromBuffer:r=>on.asReader(r).readBuffer()}}function jo(){return{fromBuffer:r=>on.asReader(r).readString()}}class Ms extends Uint8Array{}function xb(r){const e=new Uint8Array(1);return e[0]=r?1:0,e}function om(r,e=4){const t=new Uint8Array(e);return new DataView(t.buffer).setUint32(t.byteLength-4,r,!1),t}function Ib(r,e=4){const t=new Uint8Array(e);return new DataView(t.buffer).setInt32(t.byteLength-4,r,!1),t}function cm(r){const e=r.reduce((s,i)=>s+i.length,0),t=new Uint8Array(e);let n=0;for(const s of r)t.set(s,n),n+=s.length;return t}function Ob(r){return r.reduce((e,t)=>e+t.toString(16).padStart(2,"0"),"")}function Cf(r){return cm([Ib(r.length),r])}function Rb(r,e=32){const t=new Uint8Array(e);for(let n=0;n<e;n++)t[e-n-1]=Number(r>>BigInt(n*8)&0xffn);return t}function Fb(r){return cm([om(r.length),...r.flat()])}function V(r){return Array.isArray(r)?Fb(r.map(V)):r instanceof Ms?r:r instanceof Uint8Array?Cf(r):typeof r=="boolean"?xb(r):typeof r=="number"?om(r):typeof r=="bigint"?Rb(r):typeof r=="string"?Cf(new TextEncoder().encode(r)):r.toBuffer()}const ja=r=>{const t=(()=>{if(typeof window<"u"&&window.crypto)return window.crypto;if(typeof globalThis<"u"&&globalThis.crypto)return globalThis.crypto})();if(!t)throw new Error("randomBytes UnsupportedEnvironment");const n=new Uint8Array(r),s=65536;if(r>s)for(let i=0;i<r;i+=s)t.getRandomValues(n.subarray(i,i+s));else t.getRandomValues(n);return n};function um(r){return(r.readBigUInt64BE(0)<<192n)+(r.readBigUInt64BE(8)<<128n)+(r.readBigUInt64BE(16)<<64n)+r.readBigUInt64BE(24)}function Ti(r){const e=Buffer.from(r);return um(e)}function lm(r,e=32){if(e!=32)throw new Error(`Only 32 bytes supported for conversion from bigint to buffer, attempted byte length: ${e}`);const t=Buffer.alloc(e);return t.writeBigUInt64BE(r>>192n,0),t.writeBigUInt64BE(r>>128n&0xffffffffffffffffn,8),t.writeBigUInt64BE(r>>64n&0xffffffffffffffffn,16),t.writeBigUInt64BE(r&0xffffffffffffffffn,24),t}function Cb(r,e=32){return new Uint8Array(lm(r,e))}var xi,pa;let Ie=class{constructor(e){const t=typeof e=="bigint"?e:e instanceof Buffer?um(e):Ti(e);if(t>xi.MAX_VALUE)throw new Error(`Value 0x${t.toString(16)} is greater or equal to field modulus.`);this.value=typeof e=="bigint"?Cb(e):e instanceof Buffer?new Uint8Array(e):e}static random(){const e=Ti(ja(64))%xi.MODULUS;return new this(e)}static fromBuffer(e){const t=on.asReader(e);return new this(t.readBytes(this.SIZE_IN_BYTES))}static fromBufferReduce(e){const t=on.asReader(e);return new this(Ti(t.readBytes(this.SIZE_IN_BYTES))%xi.MODULUS)}static fromString(e){return this.fromBuffer(Buffer.from(e.replace(/^0x/i,""),"hex"))}toBuffer(){return this.value}toString(){return"0x"+Ob(this.toBuffer())}equals(e){return this.value.every((t,n)=>t===e.value[n])}isZero(){return this.value.every(e=>e===0)}};xi=Ie;Ie.ZERO=new xi(0n);Ie.MODULUS=0x30644e72e131a029b85045b68181585d2833e84879b9709143e1f593f0000001n;Ie.MAX_VALUE=xi.MODULUS-1n;Ie.SIZE_IN_BYTES=32;let Sc=class{constructor(e){if(this.value=e,e>pa.MAX_VALUE)throw new Error(`Fq out of range ${e}.`)}static random(){const e=Ti(ja(64))%pa.MODULUS;return new this(e)}static fromBuffer(e){const t=on.asReader(e);return new this(Ti(t.readBytes(this.SIZE_IN_BYTES)))}static fromBufferReduce(e){const t=on.asReader(e);return new this(Ti(t.readBytes(this.SIZE_IN_BYTES))%Ie.MODULUS)}static fromString(e){return this.fromBuffer(Buffer.from(e.replace(/^0x/i,""),"hex"))}toBuffer(){return lm(this.value,pa.SIZE_IN_BYTES)}toString(){return"0x"+this.value.toString(16)}equals(e){return this.value===e.value}isZero(){return this.value===0n}};pa=Sc;Sc.MODULUS=0x30644e72e131a029b85045b68181585d97816a916871ca8d3c208c16d87cfd47n;Sc.MAX_VALUE=pa.MODULUS-1n;Sc.SIZE_IN_BYTES=32;let Ta=class Qu{constructor(e,t){this.x=e,this.y=t}static random(){return new Qu(Ie.random(),Ie.random())}static fromBuffer(e){const t=on.asReader(e);return new this(Ie.fromBuffer(t),Ie.fromBuffer(t))}static fromString(e){return Qu.fromBuffer(Buffer.from(e.replace(/^0x/i,""),"hex"))}toBuffer(){return Buffer.concat([this.x.toBuffer(),this.y.toBuffer()])}toString(){return"0x"+this.toBuffer().toString("hex")}equals(e){return this.x.equals(e.x)&&this.y.equals(e.y)}};Ta.SIZE_IN_BYTES=64;Ta.EMPTY=new Ta(Ie.ZERO,Ie.ZERO);let Cl=class el{constructor(e){this.buffer=e}static fromBuffer(e){const t=on.asReader(e);return new el(t.readBytes(this.SIZE_IN_BYTES))}static random(){return new el(ja(this.SIZE_IN_BYTES))}toBuffer(){return this.buffer}};Cl.SIZE_IN_BYTES=32;class Pb{constructor(e){this.wasm=e}async pedersenCommit(e,t){const n=[e,t].map(V),s=[Ta];return(await this.wasm.callWasmExport("pedersen_commit",n,s.map(o=>o.SIZE_IN_BYTES))).map((o,c)=>s[c].fromBuffer(o))[0]}async pedersenHash(e,t){const n=[e,t].map(V),s=[Ie];return(await this.wasm.callWasmExport("pedersen_hash",n,s.map(o=>o.SIZE_IN_BYTES))).map((o,c)=>s[c].fromBuffer(o))[0]}async pedersenHashes(e,t){const n=[e,t].map(V),s=[Ie];return(await this.wasm.callWasmExport("pedersen_hashes",n,s.map(o=>o.SIZE_IN_BYTES))).map((o,c)=>s[c].fromBuffer(o))[0]}async pedersenHashBuffer(e,t){const n=[e,t].map(V),s=[Ie];return(await this.wasm.callWasmExport("pedersen_hash_buffer",n,s.map(o=>o.SIZE_IN_BYTES))).map((o,c)=>s[c].fromBuffer(o))[0]}async poseidon2Hash(e){const t=[e].map(V),n=[Ie];return(await this.wasm.callWasmExport("poseidon2_hash",t,n.map(a=>a.SIZE_IN_BYTES))).map((a,o)=>n[o].fromBuffer(a))[0]}async poseidon2Hashes(e){const t=[e].map(V),n=[Ie];return(await this.wasm.callWasmExport("poseidon2_hashes",t,n.map(a=>a.SIZE_IN_BYTES))).map((a,o)=>n[o].fromBuffer(a))[0]}async poseidon2Permutation(e){const t=[e].map(V),n=[Lr(Ie)];return(await this.wasm.callWasmExport("poseidon2_permutation",t,n.map(a=>a.SIZE_IN_BYTES))).map((a,o)=>n[o].fromBuffer(a))[0]}async poseidon2HashAccumulate(e){const t=[e].map(V),n=[Ie];return(await this.wasm.callWasmExport("poseidon2_hash_accumulate",t,n.map(a=>a.SIZE_IN_BYTES))).map((a,o)=>n[o].fromBuffer(a))[0]}async blake2s(e){const t=[e].map(V),n=[Cl];return(await this.wasm.callWasmExport("blake2s",t,n.map(a=>a.SIZE_IN_BYTES))).map((a,o)=>n[o].fromBuffer(a))[0]}async blake2sToField(e){const t=[e].map(V),n=[Ie];return(await this.wasm.callWasmExport("blake2s_to_field_",t,n.map(a=>a.SIZE_IN_BYTES))).map((a,o)=>n[o].fromBuffer(a))[0]}async aesEncryptBufferCbc(e,t,n,s){const i=[e,t,n,s].map(V),a=[Ze()];return(await this.wasm.callWasmExport("aes_encrypt_buffer_cbc",i,a.map(f=>f.SIZE_IN_BYTES))).map((f,h)=>a[h].fromBuffer(f))[0]}async aesDecryptBufferCbc(e,t,n,s){const i=[e,t,n,s].map(V),a=[Ze()];return(await this.wasm.callWasmExport("aes_decrypt_buffer_cbc",i,a.map(f=>f.SIZE_IN_BYTES))).map((f,h)=>a[h].fromBuffer(f))[0]}async srsInitSrs(e,t,n){const s=[e,t,n].map(V),i=[];(await this.wasm.callWasmExport("srs_init_srs",s,i.map(o=>o.SIZE_IN_BYTES))).map((o,c)=>i[c].fromBuffer(o))}async srsInitGrumpkinSrs(e,t){const n=[e,t].map(V),s=[];(await this.wasm.callWasmExport("srs_init_grumpkin_srs",n,s.map(a=>a.SIZE_IN_BYTES))).map((a,o)=>s[o].fromBuffer(a))}async testThreads(e,t){const n=[e,t].map(V),s=[Bi()];return(await this.wasm.callWasmExport("test_threads",n,s.map(o=>o.SIZE_IN_BYTES))).map((o,c)=>s[c].fromBuffer(o))[0]}async commonInitSlabAllocator(e){const t=[e].map(V),n=[];(await this.wasm.callWasmExport("common_init_slab_allocator",t,n.map(i=>i.SIZE_IN_BYTES))).map((i,a)=>n[a].fromBuffer(i))}async acirGetCircuitSizes(e,t,n){const s=[e,t,n].map(V),i=[Bi(),Bi()];return(await this.wasm.callWasmExport("acir_get_circuit_sizes",s,i.map(c=>c.SIZE_IN_BYTES))).map((c,f)=>i[f].fromBuffer(c))}async acirProveAndVerifyUltraHonk(e,t){const n=[e,t].map(V),s=[Nt()];return(await this.wasm.callWasmExport("acir_prove_and_verify_ultra_honk",n,s.map(o=>o.SIZE_IN_BYTES))).map((o,c)=>s[c].fromBuffer(o))[0]}async acirProveAndVerifyMegaHonk(e,t){const n=[e,t].map(V),s=[Nt()];return(await this.wasm.callWasmExport("acir_prove_and_verify_mega_honk",n,s.map(o=>o.SIZE_IN_BYTES))).map((o,c)=>s[c].fromBuffer(o))[0]}async acirProveAztecClient(e){const t=[e].map(V),n=[Ze(),Ze()];return(await this.wasm.callWasmExport("acir_prove_aztec_client",t,n.map(a=>a.SIZE_IN_BYTES))).map((a,o)=>n[o].fromBuffer(a))}async acirVerifyAztecClient(e,t){const n=[e,t].map(V),s=[Nt()];return(await this.wasm.callWasmExport("acir_verify_aztec_client",n,s.map(o=>o.SIZE_IN_BYTES))).map((o,c)=>s[c].fromBuffer(o))[0]}async acirLoadVerificationKey(e,t){const n=[e,t].map(V),s=[];(await this.wasm.callWasmExport("acir_load_verification_key",n,s.map(a=>a.SIZE_IN_BYTES))).map((a,o)=>s[o].fromBuffer(a))}async acirInitVerificationKey(e){const t=[e].map(V),n=[];(await this.wasm.callWasmExport("acir_init_verification_key",t,n.map(i=>i.SIZE_IN_BYTES))).map((i,a)=>n[a].fromBuffer(i))}async acirGetVerificationKey(e){const t=[e].map(V),n=[Ze()];return(await this.wasm.callWasmExport("acir_get_verification_key",t,n.map(a=>a.SIZE_IN_BYTES))).map((a,o)=>n[o].fromBuffer(a))[0]}async acirGetProvingKey(e,t,n){const s=[e,t,n].map(V),i=[Ze()];return(await this.wasm.callWasmExport("acir_get_proving_key",s,i.map(c=>c.SIZE_IN_BYTES))).map((c,f)=>i[f].fromBuffer(c))[0]}async acirVerifyProof(e,t){const n=[e,t].map(V),s=[Nt()];return(await this.wasm.callWasmExport("acir_verify_proof",n,s.map(o=>o.SIZE_IN_BYTES))).map((o,c)=>s[c].fromBuffer(o))[0]}async acirGetSolidityVerifier(e){const t=[e].map(V),n=[jo()];return(await this.wasm.callWasmExport("acir_get_solidity_verifier",t,n.map(a=>a.SIZE_IN_BYTES))).map((a,o)=>n[o].fromBuffer(a))[0]}async acirHonkSolidityVerifier(e,t){const n=[e,t].map(V),s=[jo()];return(await this.wasm.callWasmExport("acir_honk_solidity_verifier",n,s.map(o=>o.SIZE_IN_BYTES))).map((o,c)=>s[c].fromBuffer(o))[0]}async acirSerializeProofIntoFields(e,t,n){const s=[e,t,n].map(V),i=[Lr(Ie)];return(await this.wasm.callWasmExport("acir_serialize_proof_into_fields",s,i.map(c=>c.SIZE_IN_BYTES))).map((c,f)=>i[f].fromBuffer(c))[0]}async acirSerializeVerificationKeyIntoFields(e){const t=[e].map(V),n=[Lr(Ie),Ie];return(await this.wasm.callWasmExport("acir_serialize_verification_key_into_fields",t,n.map(a=>a.SIZE_IN_BYTES))).map((a,o)=>n[o].fromBuffer(a))}async acirProveUltraHonk(e,t){const n=[e,t].map(V),s=[Ze()];return(await this.wasm.callWasmExport("acir_prove_ultra_honk",n,s.map(o=>o.SIZE_IN_BYTES))).map((o,c)=>s[c].fromBuffer(o))[0]}async acirProveUltraKeccakHonk(e,t){const n=[e,t].map(V),s=[Ze()];return(await this.wasm.callWasmExport("acir_prove_ultra_keccak_honk",n,s.map(o=>o.SIZE_IN_BYTES))).map((o,c)=>s[c].fromBuffer(o))[0]}async acirProveUltraKeccakZkHonk(e,t){const n=[e,t].map(V),s=[Ze()];return(await this.wasm.callWasmExport("acir_prove_ultra_keccak_zk_honk",n,s.map(o=>o.SIZE_IN_BYTES))).map((o,c)=>s[c].fromBuffer(o))[0]}async acirProveUltraStarknetHonk(e,t){const n=[e,t].map(V),s=[Ze()];return(await this.wasm.callWasmExport("acir_prove_ultra_starknet_honk",n,s.map(o=>o.SIZE_IN_BYTES))).map((o,c)=>s[c].fromBuffer(o))[0]}async acirProveUltraStarknetZkHonk(e,t){const n=[e,t].map(V),s=[Ze()];return(await this.wasm.callWasmExport("acir_prove_ultra_starknet_zk_honk",n,s.map(o=>o.SIZE_IN_BYTES))).map((o,c)=>s[c].fromBuffer(o))[0]}async acirVerifyUltraHonk(e,t){const n=[e,t].map(V),s=[Nt()];return(await this.wasm.callWasmExport("acir_verify_ultra_honk",n,s.map(o=>o.SIZE_IN_BYTES))).map((o,c)=>s[c].fromBuffer(o))[0]}async acirVerifyUltraKeccakHonk(e,t){const n=[e,t].map(V),s=[Nt()];return(await this.wasm.callWasmExport("acir_verify_ultra_keccak_honk",n,s.map(o=>o.SIZE_IN_BYTES))).map((o,c)=>s[c].fromBuffer(o))[0]}async acirVerifyUltraKeccakZkHonk(e,t){const n=[e,t].map(V),s=[Nt()];return(await this.wasm.callWasmExport("acir_verify_ultra_keccak_zk_honk",n,s.map(o=>o.SIZE_IN_BYTES))).map((o,c)=>s[c].fromBuffer(o))[0]}async acirVerifyUltraStarknetHonk(e,t){const n=[e,t].map(V),s=[Nt()];return(await this.wasm.callWasmExport("acir_verify_ultra_starknet_honk",n,s.map(o=>o.SIZE_IN_BYTES))).map((o,c)=>s[c].fromBuffer(o))[0]}async acirVerifyUltraStarknetZkHonk(e,t){const n=[e,t].map(V),s=[Nt()];return(await this.wasm.callWasmExport("acir_verify_ultra_starknet_zk_honk",n,s.map(o=>o.SIZE_IN_BYTES))).map((o,c)=>s[c].fromBuffer(o))[0]}async acirWriteVkUltraHonk(e){const t=[e].map(V),n=[Ze()];return(await this.wasm.callWasmExport("acir_write_vk_ultra_honk",t,n.map(a=>a.SIZE_IN_BYTES))).map((a,o)=>n[o].fromBuffer(a))[0]}async acirWriteVkUltraKeccakHonk(e){const t=[e].map(V),n=[Ze()];return(await this.wasm.callWasmExport("acir_write_vk_ultra_keccak_honk",t,n.map(a=>a.SIZE_IN_BYTES))).map((a,o)=>n[o].fromBuffer(a))[0]}async acirWriteVkUltraKeccakZkHonk(e){const t=[e].map(V),n=[Ze()];return(await this.wasm.callWasmExport("acir_write_vk_ultra_keccak_zk_honk",t,n.map(a=>a.SIZE_IN_BYTES))).map((a,o)=>n[o].fromBuffer(a))[0]}async acirWriteVkUltraStarknetHonk(e){const t=[e].map(V),n=[Ze()];return(await this.wasm.callWasmExport("acir_write_vk_ultra_starknet_honk",t,n.map(a=>a.SIZE_IN_BYTES))).map((a,o)=>n[o].fromBuffer(a))[0]}async acirWriteVkUltraStarknetZkHonk(e){const t=[e].map(V),n=[Ze()];return(await this.wasm.callWasmExport("acir_write_vk_ultra_starknet_zk_honk",t,n.map(a=>a.SIZE_IN_BYTES))).map((a,o)=>n[o].fromBuffer(a))[0]}async acirProofAsFieldsUltraHonk(e){const t=[e].map(V),n=[Lr(Ie)];return(await this.wasm.callWasmExport("acir_proof_as_fields_ultra_honk",t,n.map(a=>a.SIZE_IN_BYTES))).map((a,o)=>n[o].fromBuffer(a))[0]}async acirVkAsFieldsUltraHonk(e){const t=[e].map(V),n=[Lr(Ie)];return(await this.wasm.callWasmExport("acir_vk_as_fields_ultra_honk",t,n.map(a=>a.SIZE_IN_BYTES))).map((a,o)=>n[o].fromBuffer(a))[0]}async acirVkAsFieldsMegaHonk(e){const t=[e].map(V),n=[Lr(Ie)];return(await this.wasm.callWasmExport("acir_vk_as_fields_mega_honk",t,n.map(a=>a.SIZE_IN_BYTES))).map((a,o)=>n[o].fromBuffer(a))[0]}async acirGatesAztecClient(e){const t=[e].map(V),n=[Ze()];return(await this.wasm.callWasmExport("acir_gates_aztec_client",t,n.map(a=>a.SIZE_IN_BYTES))).map((a,o)=>n[o].fromBuffer(a))[0]}}class Nb{constructor(e){this.wasm=e}pedersenCommit(e,t){const n=[e,t].map(V),s=[Ta];return this.wasm.callWasmExport("pedersen_commit",n,s.map(o=>o.SIZE_IN_BYTES)).map((o,c)=>s[c].fromBuffer(o))[0]}pedersenHash(e,t){const n=[e,t].map(V),s=[Ie];return this.wasm.callWasmExport("pedersen_hash",n,s.map(o=>o.SIZE_IN_BYTES)).map((o,c)=>s[c].fromBuffer(o))[0]}pedersenHashes(e,t){const n=[e,t].map(V),s=[Ie];return this.wasm.callWasmExport("pedersen_hashes",n,s.map(o=>o.SIZE_IN_BYTES)).map((o,c)=>s[c].fromBuffer(o))[0]}pedersenHashBuffer(e,t){const n=[e,t].map(V),s=[Ie];return this.wasm.callWasmExport("pedersen_hash_buffer",n,s.map(o=>o.SIZE_IN_BYTES)).map((o,c)=>s[c].fromBuffer(o))[0]}poseidon2Hash(e){const t=[e].map(V),n=[Ie];return this.wasm.callWasmExport("poseidon2_hash",t,n.map(a=>a.SIZE_IN_BYTES)).map((a,o)=>n[o].fromBuffer(a))[0]}poseidon2Hashes(e){const t=[e].map(V),n=[Ie];return this.wasm.callWasmExport("poseidon2_hashes",t,n.map(a=>a.SIZE_IN_BYTES)).map((a,o)=>n[o].fromBuffer(a))[0]}poseidon2Permutation(e){const t=[e].map(V),n=[Lr(Ie)];return this.wasm.callWasmExport("poseidon2_permutation",t,n.map(a=>a.SIZE_IN_BYTES)).map((a,o)=>n[o].fromBuffer(a))[0]}poseidon2HashAccumulate(e){const t=[e].map(V),n=[Ie];return this.wasm.callWasmExport("poseidon2_hash_accumulate",t,n.map(a=>a.SIZE_IN_BYTES)).map((a,o)=>n[o].fromBuffer(a))[0]}blake2s(e){const t=[e].map(V),n=[Cl];return this.wasm.callWasmExport("blake2s",t,n.map(a=>a.SIZE_IN_BYTES)).map((a,o)=>n[o].fromBuffer(a))[0]}blake2sToField(e){const t=[e].map(V),n=[Ie];return this.wasm.callWasmExport("blake2s_to_field_",t,n.map(a=>a.SIZE_IN_BYTES)).map((a,o)=>n[o].fromBuffer(a))[0]}aesEncryptBufferCbc(e,t,n,s){const i=[e,t,n,s].map(V),a=[Ze()];return this.wasm.callWasmExport("aes_encrypt_buffer_cbc",i,a.map(f=>f.SIZE_IN_BYTES)).map((f,h)=>a[h].fromBuffer(f))[0]}aesDecryptBufferCbc(e,t,n,s){const i=[e,t,n,s].map(V),a=[Ze()];return this.wasm.callWasmExport("aes_decrypt_buffer_cbc",i,a.map(f=>f.SIZE_IN_BYTES)).map((f,h)=>a[h].fromBuffer(f))[0]}srsInitSrs(e,t,n){const s=[e,t,n].map(V),i=[];this.wasm.callWasmExport("srs_init_srs",s,i.map(o=>o.SIZE_IN_BYTES)).map((o,c)=>i[c].fromBuffer(o))}srsInitGrumpkinSrs(e,t){const n=[e,t].map(V),s=[];this.wasm.callWasmExport("srs_init_grumpkin_srs",n,s.map(a=>a.SIZE_IN_BYTES)).map((a,o)=>s[o].fromBuffer(a))}testThreads(e,t){const n=[e,t].map(V),s=[Bi()];return this.wasm.callWasmExport("test_threads",n,s.map(o=>o.SIZE_IN_BYTES)).map((o,c)=>s[c].fromBuffer(o))[0]}commonInitSlabAllocator(e){const t=[e].map(V),n=[];this.wasm.callWasmExport("common_init_slab_allocator",t,n.map(i=>i.SIZE_IN_BYTES)).map((i,a)=>n[a].fromBuffer(i))}acirGetCircuitSizes(e,t,n){const s=[e,t,n].map(V),i=[Bi(),Bi()];return this.wasm.callWasmExport("acir_get_circuit_sizes",s,i.map(c=>c.SIZE_IN_BYTES)).map((c,f)=>i[f].fromBuffer(c))}acirProveAndVerifyUltraHonk(e,t){const n=[e,t].map(V),s=[Nt()];return this.wasm.callWasmExport("acir_prove_and_verify_ultra_honk",n,s.map(o=>o.SIZE_IN_BYTES)).map((o,c)=>s[c].fromBuffer(o))[0]}acirProveAndVerifyMegaHonk(e,t){const n=[e,t].map(V),s=[Nt()];return this.wasm.callWasmExport("acir_prove_and_verify_mega_honk",n,s.map(o=>o.SIZE_IN_BYTES)).map((o,c)=>s[c].fromBuffer(o))[0]}acirProveAztecClient(e){const t=[e].map(V),n=[Ze(),Ze()];return this.wasm.callWasmExport("acir_prove_aztec_client",t,n.map(a=>a.SIZE_IN_BYTES)).map((a,o)=>n[o].fromBuffer(a))}acirVerifyAztecClient(e,t){const n=[e,t].map(V),s=[Nt()];return this.wasm.callWasmExport("acir_verify_aztec_client",n,s.map(o=>o.SIZE_IN_BYTES)).map((o,c)=>s[c].fromBuffer(o))[0]}acirLoadVerificationKey(e,t){const n=[e,t].map(V),s=[];this.wasm.callWasmExport("acir_load_verification_key",n,s.map(a=>a.SIZE_IN_BYTES)).map((a,o)=>s[o].fromBuffer(a))}acirInitVerificationKey(e){const t=[e].map(V),n=[];this.wasm.callWasmExport("acir_init_verification_key",t,n.map(i=>i.SIZE_IN_BYTES)).map((i,a)=>n[a].fromBuffer(i))}acirGetVerificationKey(e){const t=[e].map(V),n=[Ze()];return this.wasm.callWasmExport("acir_get_verification_key",t,n.map(a=>a.SIZE_IN_BYTES)).map((a,o)=>n[o].fromBuffer(a))[0]}acirGetProvingKey(e,t,n){const s=[e,t,n].map(V),i=[Ze()];return this.wasm.callWasmExport("acir_get_proving_key",s,i.map(c=>c.SIZE_IN_BYTES)).map((c,f)=>i[f].fromBuffer(c))[0]}acirVerifyProof(e,t){const n=[e,t].map(V),s=[Nt()];return this.wasm.callWasmExport("acir_verify_proof",n,s.map(o=>o.SIZE_IN_BYTES)).map((o,c)=>s[c].fromBuffer(o))[0]}acirGetSolidityVerifier(e){const t=[e].map(V),n=[jo()];return this.wasm.callWasmExport("acir_get_solidity_verifier",t,n.map(a=>a.SIZE_IN_BYTES)).map((a,o)=>n[o].fromBuffer(a))[0]}acirHonkSolidityVerifier(e,t){const n=[e,t].map(V),s=[jo()];return this.wasm.callWasmExport("acir_honk_solidity_verifier",n,s.map(o=>o.SIZE_IN_BYTES)).map((o,c)=>s[c].fromBuffer(o))[0]}acirSerializeProofIntoFields(e,t,n){const s=[e,t,n].map(V),i=[Lr(Ie)];return this.wasm.callWasmExport("acir_serialize_proof_into_fields",s,i.map(c=>c.SIZE_IN_BYTES)).map((c,f)=>i[f].fromBuffer(c))[0]}acirSerializeVerificationKeyIntoFields(e){const t=[e].map(V),n=[Lr(Ie),Ie];return this.wasm.callWasmExport("acir_serialize_verification_key_into_fields",t,n.map(a=>a.SIZE_IN_BYTES)).map((a,o)=>n[o].fromBuffer(a))}acirProveUltraHonk(e,t){const n=[e,t].map(V),s=[Ze()];return this.wasm.callWasmExport("acir_prove_ultra_honk",n,s.map(o=>o.SIZE_IN_BYTES)).map((o,c)=>s[c].fromBuffer(o))[0]}acirProveUltraKeccakHonk(e,t){const n=[e,t].map(V),s=[Ze()];return this.wasm.callWasmExport("acir_prove_ultra_keccak_honk",n,s.map(o=>o.SIZE_IN_BYTES)).map((o,c)=>s[c].fromBuffer(o))[0]}acirProveUltraKeccakZkHonk(e,t){const n=[e,t].map(V),s=[Ze()];return this.wasm.callWasmExport("acir_prove_ultra_keccak_zk_honk",n,s.map(o=>o.SIZE_IN_BYTES)).map((o,c)=>s[c].fromBuffer(o))[0]}acirProveUltraStarknetHonk(e,t){const n=[e,t].map(V),s=[Ze()];return this.wasm.callWasmExport("acir_prove_ultra_starknet_honk",n,s.map(o=>o.SIZE_IN_BYTES)).map((o,c)=>s[c].fromBuffer(o))[0]}acirProveUltraStarknetZkHonk(e,t){const n=[e,t].map(V),s=[Ze()];return this.wasm.callWasmExport("acir_prove_ultra_starknet_zk_honk",n,s.map(o=>o.SIZE_IN_BYTES)).map((o,c)=>s[c].fromBuffer(o))[0]}acirVerifyUltraHonk(e,t){const n=[e,t].map(V),s=[Nt()];return this.wasm.callWasmExport("acir_verify_ultra_honk",n,s.map(o=>o.SIZE_IN_BYTES)).map((o,c)=>s[c].fromBuffer(o))[0]}acirVerifyUltraKeccakHonk(e,t){const n=[e,t].map(V),s=[Nt()];return this.wasm.callWasmExport("acir_verify_ultra_keccak_honk",n,s.map(o=>o.SIZE_IN_BYTES)).map((o,c)=>s[c].fromBuffer(o))[0]}acirVerifyUltraKeccakZkHonk(e,t){const n=[e,t].map(V),s=[Nt()];return this.wasm.callWasmExport("acir_verify_ultra_keccak_zk_honk",n,s.map(o=>o.SIZE_IN_BYTES)).map((o,c)=>s[c].fromBuffer(o))[0]}acirVerifyUltraStarknetHonk(e,t){const n=[e,t].map(V),s=[Nt()];return this.wasm.callWasmExport("acir_verify_ultra_starknet_honk",n,s.map(o=>o.SIZE_IN_BYTES)).map((o,c)=>s[c].fromBuffer(o))[0]}acirVerifyUltraStarknetZkHonk(e,t){const n=[e,t].map(V),s=[Nt()];return this.wasm.callWasmExport("acir_verify_ultra_starknet_zk_honk",n,s.map(o=>o.SIZE_IN_BYTES)).map((o,c)=>s[c].fromBuffer(o))[0]}acirWriteVkUltraHonk(e){const t=[e].map(V),n=[Ze()];return this.wasm.callWasmExport("acir_write_vk_ultra_honk",t,n.map(a=>a.SIZE_IN_BYTES)).map((a,o)=>n[o].fromBuffer(a))[0]}acirWriteVkUltraKeccakHonk(e){const t=[e].map(V),n=[Ze()];return this.wasm.callWasmExport("acir_write_vk_ultra_keccak_honk",t,n.map(a=>a.SIZE_IN_BYTES)).map((a,o)=>n[o].fromBuffer(a))[0]}acirWriteVkUltraKeccakZkHonk(e){const t=[e].map(V),n=[Ze()];return this.wasm.callWasmExport("acir_write_vk_ultra_keccak_zk_honk",t,n.map(a=>a.SIZE_IN_BYTES)).map((a,o)=>n[o].fromBuffer(a))[0]}acirWriteVkUltraStarknetHonk(e){const t=[e].map(V),n=[Ze()];return this.wasm.callWasmExport("acir_write_vk_ultra_starknet_honk",t,n.map(a=>a.SIZE_IN_BYTES)).map((a,o)=>n[o].fromBuffer(a))[0]}acirWriteVkUltraStarknetZkHonk(e){const t=[e].map(V),n=[Ze()];return this.wasm.callWasmExport("acir_write_vk_ultra_starknet_zk_honk",t,n.map(a=>a.SIZE_IN_BYTES)).map((a,o)=>n[o].fromBuffer(a))[0]}acirProofAsFieldsUltraHonk(e){const t=[e].map(V),n=[Lr(Ie)];return this.wasm.callWasmExport("acir_proof_as_fields_ultra_honk",t,n.map(a=>a.SIZE_IN_BYTES)).map((a,o)=>n[o].fromBuffer(a))[0]}acirVkAsFieldsUltraHonk(e){const t=[e].map(V),n=[Lr(Ie)];return this.wasm.callWasmExport("acir_vk_as_fields_ultra_honk",t,n.map(a=>a.SIZE_IN_BYTES)).map((a,o)=>n[o].fromBuffer(a))[0]}acirVkAsFieldsMegaHonk(e){const t=[e].map(V),n=[Lr(Ie)];return this.wasm.callWasmExport("acir_vk_as_fields_mega_honk",t,n.map(a=>a.SIZE_IN_BYTES)).map((a,o)=>n[o].fromBuffer(a))[0]}acirGatesAztecClient(e){const t=[e].map(V),n=[Ze()];return this.wasm.callWasmExport("acir_gates_aztec_client",t,n.map(a=>a.SIZE_IN_BYTES)).map((a,o)=>n[o].fromBuffer(a))[0]}}var Pl={exports:{}};function kb(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}var Lb=$b;function $b(r,e,t){var n=t&&t.stringify||kb,s=1;if(typeof r=="object"&&r!==null){var i=e.length+s;if(i===1)return r;var a=new Array(i);a[0]=n(r);for(var o=1;o<i;o++)a[o]=n(e[o]);return a.join(" ")}if(typeof r!="string")return r;var c=e.length;if(c===0)return r;for(var f="",h=1-s,d=-1,v=r&&r.length||0,b=0;b<v;){if(r.charCodeAt(b)===37&&b+1<v){switch(d=d>-1?d:0,r.charCodeAt(b+1)){case 100:case 102:if(h>=c||e[h]==null)break;d<b&&(f+=r.slice(d,b)),f+=Number(e[h]),d=b+2,b++;break;case 105:if(h>=c||e[h]==null)break;d<b&&(f+=r.slice(d,b)),f+=Math.floor(Number(e[h])),d=b+2,b++;break;case 79:case 111:case 106:if(h>=c||e[h]===void 0)break;d<b&&(f+=r.slice(d,b));var D=typeof e[h];if(D==="string"){f+="'"+e[h]+"'",d=b+2,b++;break}if(D==="function"){f+=e[h].name||"<anonymous>",d=b+2,b++;break}f+=n(e[h]),d=b+2,b++;break;case 115:if(h>=c)break;d<b&&(f+=r.slice(d,b)),f+=String(e[h]),d=b+2,b++;break;case 37:d<b&&(f+=r.slice(d,b)),f+="%",d=b+2,b++,h--;break}++h}++b}return d===-1?r:(d<v&&(f+=r.slice(d)),f)}const Pf=Lb;Pl.exports=ns;const xa=Jb().console||{},Hb={mapHttpRequest:lo,mapHttpResponse:lo,wrapRequestSerializer:Gc,wrapResponseSerializer:Gc,wrapErrorSerializer:Gc,req:lo,res:lo,err:kf,errWithCause:kf};function vs(r,e){return r==="silent"?1/0:e.levels.values[r]}const Nl=Symbol("pino.logFuncs"),tl=Symbol("pino.hierarchy"),Db={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function Nf(r,e){const t={logger:e,parent:r[tl]};e[tl]=t}function Mb(r,e,t){const n={};e.forEach(s=>{n[s]=t[s]?t[s]:xa[s]||xa[Db[s]||"log"]||Ii}),r[Nl]=n}function Ub(r,e){return Array.isArray(r)?r.filter(function(n){return n!=="!stdSerializers.err"}):r===!0?Object.keys(e):!1}function ns(r){r=r||{},r.browser=r.browser||{};const e=r.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const t=r.browser.write||xa;r.browser.write&&(r.browser.asObject=!0);const n=r.serializers||{},s=Ub(r.browser.serialize,n);let i=r.browser.serialize;Array.isArray(r.browser.serialize)&&r.browser.serialize.indexOf("!stdSerializers.err")>-1&&(i=!1);const a=Object.keys(r.customLevels||{}),o=["error","fatal","warn","info","debug","trace"].concat(a);typeof t=="function"&&o.forEach(function(U){t[U]=t}),(r.enabled===!1||r.browser.disabled)&&(r.level="silent");const c=r.level||"info",f=Object.create(t);f.log||(f.log=Ii),Mb(f,o,t),Nf({},f),Object.defineProperty(f,"levelVal",{get:d}),Object.defineProperty(f,"level",{get:v,set:b});const h={transmit:e,serialize:s,asObject:r.browser.asObject,asObjectBindingsOnly:r.browser.asObjectBindingsOnly,formatters:r.browser.formatters,levels:o,timestamp:Kb(r),messageKey:r.messageKey||"msg",onChild:r.onChild||Ii};f.levels=jb(r),f.level=c,f.isLevelEnabled=function(U){return this.levels.values[U]?this.levels.values[U]>=this.levels.values[this.level]:!1},f.setMaxListeners=f.getMaxListeners=f.emit=f.addListener=f.on=f.prependListener=f.once=f.prependOnceListener=f.removeListener=f.removeAllListeners=f.listeners=f.listenerCount=f.eventNames=f.write=f.flush=Ii,f.serializers=n,f._serialize=s,f._stdErrSerialize=i,f.child=function(...U){return D.call(this,h,...U)},e&&(f._logEvent=rl());function d(){return vs(this.level,this)}function v(){return this._level}function b(U){if(U!=="silent"&&!this.levels.values[U])throw Error("unknown level "+U);this._level=U,Ls(this,h,f,"error"),Ls(this,h,f,"fatal"),Ls(this,h,f,"warn"),Ls(this,h,f,"info"),Ls(this,h,f,"debug"),Ls(this,h,f,"trace"),a.forEach(ie=>{Ls(this,h,f,ie)})}function D(U,ie,K){if(!ie)throw new Error("missing bindings for child Pino");K=K||{},s&&ie.serializers&&(K.serializers=ie.serializers);const I=K.serializers;if(s&&I){var x=Object.assign({},n,I),k=r.browser.serialize===!0?Object.keys(x):s;delete ie.serializers,kl([ie],k,x,this._stdErrSerialize)}function re(fe){this._childLevel=(fe._childLevel|0)+1,this.bindings=ie,x&&(this.serializers=x,this._serialize=k),e&&(this._logEvent=rl([].concat(fe._logEvent.bindings,ie)))}re.prototype=this;const ye=new re(this);return Nf(this,ye),ye.child=function(...fe){return D.call(this,U,...fe)},ye.level=K.level||this.level,U.onChild(ye),ye}return f}function jb(r){const e=r.customLevels||{},t=Object.assign({},ns.levels.values,e),n=Object.assign({},ns.levels.labels,Zb(e));return{values:t,labels:n}}function Zb(r){const e={};return Object.keys(r).forEach(function(t){e[r[t]]=t}),e}ns.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};ns.stdSerializers=Hb;ns.stdTimeFunctions=Object.assign({},{nullTime:fm,epochTime:dm,unixTime:Yb,isoTime:Xb});function zb(r){const e=[];r.bindings&&e.push(r.bindings);let t=r[tl];for(;t.parent;)t=t.parent,t.logger.bindings&&e.push(t.logger.bindings);return e.reverse()}function Ls(r,e,t,n){if(Object.defineProperty(r,n,{value:vs(r.level,t)>vs(n,t)?Ii:t[Nl][n],writable:!0,enumerable:!0,configurable:!0}),r[n]===Ii){if(!e.transmit)return;const i=e.transmit.level||r.level,a=vs(i,t);if(vs(n,t)<a)return}r[n]=qb(r,e,t,n);const s=zb(r);s.length!==0&&(r[n]=Vb(s,r[n]))}function Vb(r,e){return function(){return e.apply(this,[...r,...arguments])}}function qb(r,e,t,n){return function(s){return function(){const a=e.timestamp(),o=new Array(arguments.length),c=Object.getPrototypeOf&&Object.getPrototypeOf(this)===xa?xa:this;for(var f=0;f<o.length;f++)o[f]=arguments[f];var h=!1;if(e.serialize&&(kl(o,this._serialize,this.serializers,this._stdErrSerialize),h=!0),e.asObject||e.formatters?s.call(c,...Wb(this,n,o,a,e)):s.apply(c,o),e.transmit){const d=e.transmit.level||r._level,v=vs(d,t),b=vs(n,t);if(b<v)return;Gb(this,{ts:a,methodLevel:n,methodValue:b,transmitValue:t.levels.values[e.transmit.level||r._level],send:e.transmit.send,val:vs(r._level,t)},o,h)}}}(r[Nl][n])}function Wb(r,e,t,n,s){const{level:i,log:a=d=>d}=s.formatters||{},o=t.slice();let c=o[0];const f={};let h=(r._childLevel|0)+1;if(h<1&&(h=1),n&&(f.time=n),i){const d=i(e,r.levels.values[e]);Object.assign(f,d)}else f.level=r.levels.values[e];if(s.asObjectBindingsOnly){if(c!==null&&typeof c=="object")for(;h--&&typeof o[0]=="object";)Object.assign(f,o.shift());return[a(f),...o]}else{if(c!==null&&typeof c=="object"){for(;h--&&typeof o[0]=="object";)Object.assign(f,o.shift());c=o.length?Pf(o.shift(),o):void 0}else typeof c=="string"&&(c=Pf(o.shift(),o));return c!==void 0&&(f[s.messageKey]=c),[a(f)]}}function kl(r,e,t,n){for(const s in r)if(n&&r[s]instanceof Error)r[s]=ns.stdSerializers.err(r[s]);else if(typeof r[s]=="object"&&!Array.isArray(r[s])&&e)for(const i in r[s])e.indexOf(i)>-1&&i in t&&(r[s][i]=t[i](r[s][i]))}function Gb(r,e,t,n=!1){const s=e.send,i=e.ts,a=e.methodLevel,o=e.methodValue,c=e.val,f=r._logEvent.bindings;n||kl(t,r._serialize||Object.keys(r.serializers),r.serializers,r._stdErrSerialize===void 0?!0:r._stdErrSerialize),r._logEvent.ts=i,r._logEvent.messages=t.filter(function(h){return f.indexOf(h)===-1}),r._logEvent.level.label=a,r._logEvent.level.value=o,s(a,r._logEvent,c),r._logEvent=rl(f)}function rl(r){return{ts:0,messages:[],bindings:r||[],level:{label:"",value:0}}}function kf(r){const e={type:r.constructor.name,msg:r.message,stack:r.stack};for(const t in r)e[t]===void 0&&(e[t]=r[t]);return e}function Kb(r){return typeof r.timestamp=="function"?r.timestamp:r.timestamp===!1?fm:dm}function lo(){return{}}function Gc(r){return r}function Ii(){}function fm(){return!1}function dm(){return Date.now()}function Yb(){return Math.round(Date.now()/1e3)}function Xb(){return new Date(Date.now()).toISOString()}function Jb(){function r(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return r(self)||r(window)||r(this)||{}}}Pl.exports.default=ns;var bs=Pl.exports.pino=ns;const Qb={name:"bb.js",useOnlyCustomLevels:!1,customLevels:{verbose:25},browser:{asObject:!1}};let Ll,Eo;function e0({level:r="info"}={level:"info",useStdErr:!1}){if(Eo)return Eo;Ll={level:r,useStdErr:!1},Eo=bs({...Qb,level:r})}function Di(r){e0();const e=Eo.child({name:r});return t=>{e.debug(t)}}function hm(){const r=typeof window<"u"?window:globalThis;return typeof SharedArrayBuffer<"u"&&r.crossOriginIsolated}function mm(r){return nm(r)}function t0(){return navigator.hardwareConcurrency}function r0(r){return typeof navigator<"u"&&navigator.hardwareConcurrency?navigator.hardwareConcurrency:(r("Could not detect environment to query number of threads. Falling back to one thread."),1)}function pm(r,e){r.addEventListener("message",function t(n){n.data&&n.data.ready===!0&&(r.removeEventListener("message",t),e())})}async function n0(){const r=new Worker(new URL("/assets/main.worker-CSfLnNeL.js",import.meta.url),{type:"module"});return r.postMessage({log:Ll}),await new Promise(e=>pm(r,e)),r}async function s0(){const r=new Worker(new URL("/assets/thread.worker-kpU2nMrq.js",import.meta.url),{type:"module"});return r.postMessage({log:Ll}),await new Promise(e=>pm(r,e)),r}class i0{constructor(){this.memStore={},this.logger=Di("bb_wasm_base")}getImportObj(e){return{wasi_snapshot_preview1:{random_get:(n,s)=>{n=n>>>0;const i=ja(s);this.getMemory().set(i,n)},clock_time_get:(n,s,i)=>{i=i>>>0;const a=BigInt(new Date().getTime())*1000000n;new DataView(this.getMemory().buffer).setBigUint64(i,a,!0)},proc_exit:()=>{throw this.logger("PANIC: proc_exit was called."),new Error}},env:{logstr:n=>{const s=this.stringFromAddress(n),i=this.getMemory(),a=`${s} (mem: ${(i.length/(1024*1024)).toFixed(2)}MiB)`;this.logger(a)},get_data:(n,s)=>{const i=this.stringFromAddress(n);s=s>>>0;const a=this.memStore[i];if(!a){this.logger(`get_data miss ${i}`);return}this.writeMemory(s,a)},set_data:(n,s,i)=>{const a=this.stringFromAddress(n);s=s>>>0,this.memStore[a]=this.getMemorySlice(s,s+i)},memory:e}}}exports(){return this.instance.exports}call(e,...t){if(!this.exports()[e])throw new Error(`WASM function ${e} not found.`);try{return this.exports()[e](...t)>>>0}catch(n){const s=`WASM function ${e} aborted, error: ${n}`;throw this.logger(s),this.logger(n.stack),n}}memSize(){return this.getMemory().length}getMemorySlice(e,t){return this.getMemory().subarray(e,t).slice()}writeMemory(e,t){this.getMemory().set(t,e)}getMemory(){return new Uint8Array(this.memory.buffer)}stringFromAddress(e){e=e>>>0;const t=this.getMemory();let n=e;for(;t[n]!==0;++n);return new TextDecoder("ascii").decode(t.slice(e,n))}}class a0{constructor(e){this.wasm=e,this.allocs=[],this.inScratchRemaining=1024,this.outScratchRemaining=1024}getInputs(e){return e.map(t=>{if(typeof t=="object")if(t.length<=this.inScratchRemaining){const n=this.inScratchRemaining-=t.length;return this.wasm.writeMemory(n,t),n}else{const n=this.wasm.call("bbmalloc",t.length);return this.wasm.writeMemory(n,t),this.allocs.push(n),n}else return t})}getOutputPtrs(e){return e.map(t=>{const n=t||4;if(n<=this.outScratchRemaining)return this.outScratchRemaining-=n;{const s=this.wasm.call("bbmalloc",n);return this.allocs.push(s),s}})}addOutputPtr(e){e>=1024&&this.allocs.push(e)}freeAll(){for(const e of this.allocs)this.wasm.call("bbfree",e)}}class Ac extends i0{constructor(){super(...arguments),this.workers=[],this.remoteWasms=[],this.nextWorker=0,this.nextThreadId=1}getNumThreads(){return this.workers.length+1}async init(e,t=Math.min(t0(),Ac.MAX_THREADS),n=Di("bb_wasm"),s=32,i=2**16){this.logger=n;const a=s*2**16/(1024*1024),o=i*2**16/(1024*1024),c=hm();this.logger(`Initializing bb wasm: initial memory ${s} pages ${a}MiB; max memory: ${i} pages, ${o}MiB; threads: ${t}; shared memory: ${c}`),this.memory=new WebAssembly.Memory({initial:s,maximum:i,shared:c});const f=await WebAssembly.instantiate(e,this.getImportObj(this.memory));this.instance=f,this.call("_initialize"),t>1&&(this.logger(`Creating ${t} worker threads`),this.workers=await Promise.all(Array.from({length:t-1}).map(s0)),this.remoteWasms=await Promise.all(this.workers.map(mm)),await Promise.all(this.remoteWasms.map(h=>h.initThread(e,this.memory))))}async destroy(){await Promise.all(this.workers.map(e=>e.terminate()))}getImportObj(e){const t=super.getImportObj(e);return{...t,wasi:{"thread-spawn":n=>{n=n>>>0;const s=this.nextThreadId++,i=this.nextWorker++%this.remoteWasms.length;return this.remoteWasms[i].call("wasi_thread_start",s,n).catch(this.logger),s}},env:{...t.env,env_hardware_concurrency:()=>this.remoteWasms.length+1}}}callWasmExport(e,t,n){const s=new a0(this),i=s.getInputs(t),a=s.getOutputPtrs(n);this.call(e,...i,...a);const o=this.getOutputArgs(n,a,s);return s.freeAll(),o}getOutputArgs(e,t,n){return e.map((s,i)=>{if(s)return this.getMemorySlice(t[i],t[i]+s);const a=this.getMemorySlice(t[i],t[i]+4),o=new DataView(a.buffer,a.byteOffset,a.byteLength).getUint32(0,!0);n.addOutputPtr(o);const c=this.getMemorySlice(o,o+4),f=new DataView(c.buffer,c.byteOffset,c.byteLength).getUint32(0,!1);return this.getMemorySlice(o+4,o+4+f)})}}Ac.MAX_THREADS=32;async function o0(r,e){let t;if(e){const o=r?"-threads":"",c=e.split("/").slice(0,-1).join("/"),f=e.split("/").pop(),[h,...d]=f.split(".");t=`${c}/${h}${o}.${d.join(".")}`}else t=r?(await If(async()=>{const{default:o}=await import("./barretenberg-threads-z79dJMgG.js");return{default:o}},[])).default:(await If(async()=>{const{default:o}=await import("./barretenberg-BpuEyCqR.js");return{default:o}},[])).default;const s=await(await fetch(t)).arrayBuffer(),i=new Uint8Array(s);return i[0]===31&&i[1]===139&&i[2]===8?lb.ungzip(i).buffer:i}async function gm(r=32,e,t=Di("fetch_mat")){const n=hm(),s=n?await r0(t):1,i=Math.min(r,s,32);t(`Fetching bb wasm from ${e??"default location"}`);const a=await o0(n,e);t(`Compiling bb wasm of ${a.byteLength} bytes`);const o=await WebAssembly.compile(a);return t("Compilation of bb wasm complete"),{module:o,threads:i}}var nl;try{nl=new TextDecoder}catch{}var oe,Sn,w=0,ot={},Me,Es,kr=0,yn=0,kt,ts,yr=[],He,Lf={useRecords:!1,mapsAsObjects:!0};class ym{}const bm=new ym;bm.name="MessagePack 0xC1";var _s=!1,wm=2,c0;try{new Function("")}catch{wm=1/0}class Ia{constructor(e){e&&(e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.sequential&&e.trusted!==!1&&(e.trusted=!0,!e.structures&&e.useRecords!=!1&&(e.structures=[],e.maxSharedStructures||(e.maxSharedStructures=0))),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0),e.int64AsNumber&&(e.int64AsType="number")),Object.assign(this,e)}unpack(e,t){if(oe)return Bm(()=>(il(),this?this.unpack(e,t):Ia.prototype.unpack.call(Lf,e,t)));!e.buffer&&e.constructor===ArrayBuffer&&(e=typeof Buffer<"u"?Buffer.from(e):new Uint8Array(e)),typeof t=="object"?(Sn=t.end||e.length,w=t.start||0):(w=0,Sn=t>-1?t:e.length),yn=0,Es=null,kt=null,oe=e;try{He=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(n){throw oe=null,e instanceof Uint8Array?n:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof Ia){if(ot=this,this.structures)return Me=this.structures,fo(t);(!Me||Me.length>0)&&(Me=[])}else ot=Lf,(!Me||Me.length>0)&&(Me=[]);return fo(t)}unpackMultiple(e,t){let n,s=0;try{_s=!0;let i=e.length,a=this?this.unpack(e,i):_c.unpack(e,i);if(t){if(t(a,s,w)===!1)return;for(;w<i;)if(s=w,t(fo(),s,w)===!1)return}else{for(n=[a];w<i;)s=w,n.push(fo());return n}}catch(i){throw i.lastPosition=s,i.values=n,i}finally{_s=!1,il()}}_mergeStructures(e,t){e=e||[],Object.isFrozen(e)&&(e=e.map(n=>n.slice(0)));for(let n=0,s=e.length;n<s;n++){let i=e[n];i&&(i.isShared=!0,n>=32&&(i.highByte=n-32>>5))}e.sharedLength=e.length;for(let n in t||[])if(n>=0){let s=e[n],i=t[n];i&&(s&&((e.restoreStructures||(e.restoreStructures=[]))[n]=s),e[n]=i)}return this.structures=e}decode(e,t){return this.unpack(e,t)}}function fo(r){try{if(!ot.trusted&&!_s){let t=Me.sharedLength||0;t<Me.length&&(Me.length=t)}let e;if(ot.randomAccessStructure&&oe[w]<64&&oe[w]>=32&&c0||(e=St()),kt&&(w=kt.postBundlePosition,kt=null),_s&&(Me.restoreStructures=null),w==Sn)Me&&Me.restoreStructures&&$f(),Me=null,oe=null,ts&&(ts=null);else{if(w>Sn)throw new Error("Unexpected end of MessagePack data");if(!_s){let t;try{t=JSON.stringify(e,(n,s)=>typeof s=="bigint"?`${s}n`:s).slice(0,100)}catch(n){t="(JSON view not available "+n+")"}throw new Error("Data read, but end of buffer not reached "+t)}}return e}catch(e){throw Me&&Me.restoreStructures&&$f(),il(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer")||w>Sn)&&(e.incomplete=!0),e}}function $f(){for(let r in Me.restoreStructures)Me[r]=Me.restoreStructures[r];Me.restoreStructures=null}function St(){let r=oe[w++];if(r<160)if(r<128){if(r<64)return r;{let e=Me[r&63]||ot.getStructures&&vm()[r&63];return e?(e.read||(e.read=$l(e,r&63)),e.read()):r}}else if(r<144)if(r-=128,ot.mapsAsObjects){let e={};for(let t=0;t<r;t++){let n=Sm();n==="__proto__"&&(n="__proto_"),e[n]=St()}return e}else{let e=new Map;for(let t=0;t<r;t++)e.set(St(),St());return e}else{r-=144;let e=new Array(r);for(let t=0;t<r;t++)e[t]=St();return ot.freezeData?Object.freeze(e):e}else if(r<192){let e=r-160;if(yn>=w)return Es.slice(w-kr,(w+=e)-kr);if(yn==0&&Sn<140){let t=e<16?Hl(e):Em(e);if(t!=null)return t}return sl(e)}else{let e;switch(r){case 192:return null;case 193:return kt?(e=St(),e>0?kt[1].slice(kt.position1,kt.position1+=e):kt[0].slice(kt.position0,kt.position0-=e)):bm;case 194:return!1;case 195:return!0;case 196:if(e=oe[w++],e===void 0)throw new Error("Unexpected end of buffer");return Kc(e);case 197:return e=He.getUint16(w),w+=2,Kc(e);case 198:return e=He.getUint32(w),w+=4,Kc(e);case 199:return $s(oe[w++]);case 200:return e=He.getUint16(w),w+=2,$s(e);case 201:return e=He.getUint32(w),w+=4,$s(e);case 202:if(e=He.getFloat32(w),ot.useFloat32>2){let t=Dl[(oe[w]&127)<<1|oe[w+1]>>7];return w+=4,(t*e+(e>0?.5:-.5)>>0)/t}return w+=4,e;case 203:return e=He.getFloat64(w),w+=8,e;case 204:return oe[w++];case 205:return e=He.getUint16(w),w+=2,e;case 206:return e=He.getUint32(w),w+=4,e;case 207:return ot.int64AsType==="number"?(e=He.getUint32(w)*4294967296,e+=He.getUint32(w+4)):ot.int64AsType==="string"?e=He.getBigUint64(w).toString():ot.int64AsType==="auto"?(e=He.getBigUint64(w),e<=BigInt(2)<<BigInt(52)&&(e=Number(e))):e=He.getBigUint64(w),w+=8,e;case 208:return He.getInt8(w++);case 209:return e=He.getInt16(w),w+=2,e;case 210:return e=He.getInt32(w),w+=4,e;case 211:return ot.int64AsType==="number"?(e=He.getInt32(w)*4294967296,e+=He.getUint32(w+4)):ot.int64AsType==="string"?e=He.getBigInt64(w).toString():ot.int64AsType==="auto"?(e=He.getBigInt64(w),e>=BigInt(-2)<<BigInt(52)&&e<=BigInt(2)<<BigInt(52)&&(e=Number(e))):e=He.getBigInt64(w),w+=8,e;case 212:if(e=oe[w++],e==114)return Zf(oe[w++]&63);{let t=yr[e];if(t)return t.read?(w++,t.read(St())):t.noBuffer?(w++,t()):t(oe.subarray(w,++w));throw new Error("Unknown extension "+e)}case 213:return e=oe[w],e==114?(w++,Zf(oe[w++]&63,oe[w++])):$s(2);case 214:return $s(4);case 215:return $s(8);case 216:return $s(16);case 217:return e=oe[w++],yn>=w?Es.slice(w-kr,(w+=e)-kr):l0(e);case 218:return e=He.getUint16(w),w+=2,yn>=w?Es.slice(w-kr,(w+=e)-kr):f0(e);case 219:return e=He.getUint32(w),w+=4,yn>=w?Es.slice(w-kr,(w+=e)-kr):d0(e);case 220:return e=He.getUint16(w),w+=2,Df(e);case 221:return e=He.getUint32(w),w+=4,Df(e);case 222:return e=He.getUint16(w),w+=2,Mf(e);case 223:return e=He.getUint32(w),w+=4,Mf(e);default:if(r>=224)return r-256;if(r===void 0){let t=new Error("Unexpected end of MessagePack data");throw t.incomplete=!0,t}throw new Error("Unknown MessagePack token "+r)}}}const u0=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function $l(r,e){function t(){if(t.count++>wm){let s=r.read=new Function("r","return function(){return "+(ot.freezeData?"Object.freeze":"")+"({"+r.map(i=>i==="__proto__"?"__proto_:r()":u0.test(i)?i+":r()":"["+JSON.stringify(i)+"]:r()").join(",")+"})}")(St);return r.highByte===0&&(r.read=Hf(e,r.read)),s()}let n={};for(let s=0,i=r.length;s<i;s++){let a=r[s];a==="__proto__"&&(a="__proto_"),n[a]=St()}return ot.freezeData?Object.freeze(n):n}return t.count=0,r.highByte===0?Hf(e,t):t}const Hf=(r,e)=>function(){let t=oe[w++];if(t===0)return e();let n=r<32?-(r+(t<<5)):r+(t<<5),s=Me[n]||vm()[n];if(!s)throw new Error("Record id is not defined for "+n);return s.read||(s.read=$l(s,r)),s.read()};function vm(){let r=Bm(()=>(oe=null,ot.getStructures()));return Me=ot._mergeStructures(r,Me)}var sl=Za,l0=Za,f0=Za,d0=Za;function Za(r){let e;if(r<16&&(e=Hl(r)))return e;if(r>64&&nl)return nl.decode(oe.subarray(w,w+=r));const t=w+r,n=[];for(e="";w<t;){const s=oe[w++];if(!(s&128))n.push(s);else if((s&224)===192){const i=oe[w++]&63;n.push((s&31)<<6|i)}else if((s&240)===224){const i=oe[w++]&63,a=oe[w++]&63;n.push((s&31)<<12|i<<6|a)}else if((s&248)===240){const i=oe[w++]&63,a=oe[w++]&63,o=oe[w++]&63;let c=(s&7)<<18|i<<12|a<<6|o;c>65535&&(c-=65536,n.push(c>>>10&1023|55296),c=56320|c&1023),n.push(c)}else n.push(s);n.length>=4096&&(e+=Ft.apply(String,n),n.length=0)}return n.length>0&&(e+=Ft.apply(String,n)),e}function Df(r){let e=new Array(r);for(let t=0;t<r;t++)e[t]=St();return ot.freezeData?Object.freeze(e):e}function Mf(r){if(ot.mapsAsObjects){let e={};for(let t=0;t<r;t++){let n=Sm();n==="__proto__"&&(n="__proto_"),e[n]=St()}return e}else{let e=new Map;for(let t=0;t<r;t++)e.set(St(),St());return e}}var Ft=String.fromCharCode;function Em(r){let e=w,t=new Array(r);for(let n=0;n<r;n++){const s=oe[w++];if((s&128)>0){w=e;return}t[n]=s}return Ft.apply(String,t)}function Hl(r){if(r<4)if(r<2){if(r===0)return"";{let e=oe[w++];if((e&128)>1){w-=1;return}return Ft(e)}}else{let e=oe[w++],t=oe[w++];if((e&128)>0||(t&128)>0){w-=2;return}if(r<3)return Ft(e,t);let n=oe[w++];if((n&128)>0){w-=3;return}return Ft(e,t,n)}else{let e=oe[w++],t=oe[w++],n=oe[w++],s=oe[w++];if((e&128)>0||(t&128)>0||(n&128)>0||(s&128)>0){w-=4;return}if(r<6){if(r===4)return Ft(e,t,n,s);{let i=oe[w++];if((i&128)>0){w-=5;return}return Ft(e,t,n,s,i)}}else if(r<8){let i=oe[w++],a=oe[w++];if((i&128)>0||(a&128)>0){w-=6;return}if(r<7)return Ft(e,t,n,s,i,a);let o=oe[w++];if((o&128)>0){w-=7;return}return Ft(e,t,n,s,i,a,o)}else{let i=oe[w++],a=oe[w++],o=oe[w++],c=oe[w++];if((i&128)>0||(a&128)>0||(o&128)>0||(c&128)>0){w-=8;return}if(r<10){if(r===8)return Ft(e,t,n,s,i,a,o,c);{let f=oe[w++];if((f&128)>0){w-=9;return}return Ft(e,t,n,s,i,a,o,c,f)}}else if(r<12){let f=oe[w++],h=oe[w++];if((f&128)>0||(h&128)>0){w-=10;return}if(r<11)return Ft(e,t,n,s,i,a,o,c,f,h);let d=oe[w++];if((d&128)>0){w-=11;return}return Ft(e,t,n,s,i,a,o,c,f,h,d)}else{let f=oe[w++],h=oe[w++],d=oe[w++],v=oe[w++];if((f&128)>0||(h&128)>0||(d&128)>0||(v&128)>0){w-=12;return}if(r<14){if(r===12)return Ft(e,t,n,s,i,a,o,c,f,h,d,v);{let b=oe[w++];if((b&128)>0){w-=13;return}return Ft(e,t,n,s,i,a,o,c,f,h,d,v,b)}}else{let b=oe[w++],D=oe[w++];if((b&128)>0||(D&128)>0){w-=14;return}if(r<15)return Ft(e,t,n,s,i,a,o,c,f,h,d,v,b,D);let U=oe[w++];if((U&128)>0){w-=15;return}return Ft(e,t,n,s,i,a,o,c,f,h,d,v,b,D,U)}}}}}function Uf(){let r=oe[w++],e;if(r<192)e=r-160;else switch(r){case 217:e=oe[w++];break;case 218:e=He.getUint16(w),w+=2;break;case 219:e=He.getUint32(w),w+=4;break;default:throw new Error("Expected string")}return Za(e)}function Kc(r){return ot.copyBuffers?Uint8Array.prototype.slice.call(oe,w,w+=r):oe.subarray(w,w+=r)}function $s(r){let e=oe[w++];if(yr[e]){let t;return yr[e](oe.subarray(w,t=w+=r),n=>{w=n;try{return St()}finally{w=t}})}else throw new Error("Unknown extension type "+e)}var jf=new Array(4096);function Sm(){let r=oe[w++];if(r>=160&&r<192){if(r=r-160,yn>=w)return Es.slice(w-kr,(w+=r)-kr);if(!(yn==0&&Sn<180))return sl(r)}else return w--,Am(St());let e=(r<<5^(r>1?He.getUint16(w):r>0?oe[w]:0))&4095,t=jf[e],n=w,s=w+r-3,i,a=0;if(t&&t.bytes==r){for(;n<s;){if(i=He.getUint32(n),i!=t[a++]){n=1879048192;break}n+=4}for(s+=3;n<s;)if(i=oe[n++],i!=t[a++]){n=1879048192;break}if(n===s)return w=n,t.string;s-=3,n=w}for(t=[],jf[e]=t,t.bytes=r;n<s;)i=He.getUint32(n),t.push(i),n+=4;for(s+=3;n<s;)i=oe[n++],t.push(i);let o=r<16?Hl(r):Em(r);return o!=null?t.string=o:t.string=sl(r)}function Am(r){if(typeof r=="string")return r;if(typeof r=="number"||typeof r=="boolean"||typeof r=="bigint")return r.toString();if(r==null)return r+"";if(ot.allowArraysInMapKeys&&Array.isArray(r)&&r.flat().every(e=>["string","number","boolean","bigint"].includes(typeof e)))return r.flat().toString();throw new Error(`Invalid property type for record: ${typeof r}`)}const Zf=(r,e)=>{let t=St().map(Am),n=r;e!==void 0&&(r=r<32?-((e<<5)+r):(e<<5)+r,t.highByte=e);let s=Me[r];return s&&(s.isShared||_s)&&((Me.restoreStructures||(Me.restoreStructures=[]))[r]=s),Me[r]=t,t.read=$l(t,n),t.read()};yr[0]=()=>{};yr[0].noBuffer=!0;yr[66]=r=>{let e=r.length,t=BigInt(r[0]&128?r[0]-256:r[0]);for(let n=1;n<e;n++)t<<=BigInt(8),t+=BigInt(r[n]);return t};let h0={Error,TypeError,ReferenceError};yr[101]=()=>{let r=St();return(h0[r[0]]||Error)(r[1],{cause:r[2]})};yr[105]=r=>{if(ot.structuredClone===!1)throw new Error("Structured clone extension is disabled");let e=He.getUint32(w-4);ts||(ts=new Map);let t=oe[w],n;t>=144&&t<160||t==220||t==221?n=[]:t>=128&&t<144||t==222||t==223?n=new Map:(t>=199&&t<=201||t>=212&&t<=216)&&oe[w+1]===115?n=new Set:n={};let s={target:n};ts.set(e,s);let i=St();if(s.used)Object.assign(n,i);else return s.target=i;if(n instanceof Map)for(let[a,o]of i.entries())n.set(a,o);if(n instanceof Set)for(let a of Array.from(i))n.add(a);return n};yr[112]=r=>{if(ot.structuredClone===!1)throw new Error("Structured clone extension is disabled");let e=He.getUint32(w-4),t=ts.get(e);return t.used=!0,t.target};yr[115]=()=>new Set(St());const _m=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(r=>r+"Array");let m0=typeof globalThis=="object"?globalThis:window;yr[116]=r=>{let e=r[0],t=Uint8Array.prototype.slice.call(r,1).buffer,n=_m[e];if(!n){if(e===16)return t;if(e===17)return new DataView(t);throw new Error("Could not find typed array for code "+e)}return new m0[n](t)};yr[120]=()=>{let r=St();return new RegExp(r[0],r[1])};const p0=[];yr[98]=r=>{let e=(r[0]<<24)+(r[1]<<16)+(r[2]<<8)+r[3],t=w;return w+=e-r.length,kt=p0,kt=[Uf(),Uf()],kt.position0=0,kt.position1=0,kt.postBundlePosition=w,w=t,St()};yr[255]=r=>r.length==4?new Date((r[0]*16777216+(r[1]<<16)+(r[2]<<8)+r[3])*1e3):r.length==8?new Date(((r[0]<<22)+(r[1]<<14)+(r[2]<<6)+(r[3]>>2))/1e6+((r[3]&3)*4294967296+r[4]*16777216+(r[5]<<16)+(r[6]<<8)+r[7])*1e3):r.length==12?new Date(((r[0]<<24)+(r[1]<<16)+(r[2]<<8)+r[3])/1e6+((r[4]&128?-281474976710656:0)+r[6]*1099511627776+r[7]*4294967296+r[8]*16777216+(r[9]<<16)+(r[10]<<8)+r[11])*1e3):new Date("invalid");function Bm(r){let e=Sn,t=w,n=kr,s=yn,i=Es,a=ts,o=kt,c=new Uint8Array(oe.slice(0,Sn)),f=Me,h=Me.slice(0,Me.length),d=ot,v=_s,b=r();return Sn=e,w=t,kr=n,yn=s,Es=i,ts=a,kt=o,oe=c,_s=v,Me=f,Me.splice(0,Me.length,...h),ot=d,He=new DataView(oe.buffer,oe.byteOffset,oe.byteLength),b}function il(){oe=null,ts=null,Me=null}const Dl=new Array(147);for(let r=0;r<256;r++)Dl[r]=+("1e"+Math.floor(45.15-r*.30103));var _c=new Ia({useRecords:!1});_c.unpack;_c.unpackMultiple;_c.unpack;let g0=new Float32Array(1);new Uint8Array(g0.buffer,0,4);let So;try{So=new TextEncoder}catch{}let al,Tm;const Oa=typeof Buffer<"u",ho=Oa?function(r){return Buffer.allocUnsafeSlow(r)}:Uint8Array,xm=Oa?Buffer:Uint8Array,zf=Oa?4294967296:2144337920;let T,ia,it,A=0,Jt,bt=null,y0;const b0=21760,w0=/[\u0080-\uFFFF]/,ci=Symbol("record-id");class Im extends Ia{constructor(e){super(e),this.offset=0;let t,n,s,i,a=xm.prototype.utf8Write?function(B,Q){return T.utf8Write(B,Q,T.byteLength-Q)}:So&&So.encodeInto?function(B,Q){return So.encodeInto(B,T.subarray(Q)).written}:!1,o=this;e||(e={});let c=e&&e.sequential,f=e.structures||e.saveStructures,h=e.maxSharedStructures;if(h==null&&(h=f?32:0),h>8160)throw new Error("Maximum maxSharedStructure is 8160");e.structuredClone&&e.moreTypes==null&&(this.moreTypes=!0);let d=e.maxOwnStructures;d==null&&(d=f?32:64),!this.structures&&e.useRecords!=!1&&(this.structures=[]);let v=h>32||d+h>64,b=h+64,D=h+d+64;if(D>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let U=[],ie=0,K=0;this.pack=this.encode=function(B,Q){if(T||(T=new ho(8192),it=T.dataView||(T.dataView=new DataView(T.buffer,0,8192)),A=0),Jt=T.length-10,Jt-A<2048?(T=new ho(T.length),it=T.dataView||(T.dataView=new DataView(T.buffer,0,T.length)),Jt=T.length-10,A=0):A=A+7&2147483640,t=A,Q&B0&&(A+=Q&255),i=o.structuredClone?new Map:null,o.bundleStrings&&typeof B!="string"?(bt=[],bt.size=1/0):bt=null,s=o.structures,s){s.uninitialized&&(s=o._mergeStructures(o.getStructures()));let L=s.sharedLength||0;if(L>h)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+s.sharedLength);if(!s.transitions){s.transitions=Object.create(null);for(let te=0;te<L;te++){let he=s[te];if(!he)continue;let P,F=s.transitions;for(let Y=0,Z=he.length;Y<Z;Y++){let y=he[Y];P=F[y],P||(P=F[y]=Object.create(null)),F=P}F[ci]=te+64}this.lastNamedStructuresLength=L}c||(s.nextId=L+64)}n&&(n=!1);let z;try{o.randomAccessStructure&&B&&B.constructor&&B.constructor===Object?Te(B):k(B);let L=bt;if(bt&&Vf(t,k,0),i&&i.idsToInsert){let te=i.idsToInsert.sort((Y,Z)=>Y.offset>Z.offset?1:-1),he=te.length,P=-1;for(;L&&he>0;){let Y=te[--he].offset+t;Y<L.stringsPosition+t&&P===-1&&(P=0),Y>L.position+t?P>=0&&(P+=6):(P>=0&&(it.setUint32(L.position+t,it.getUint32(L.position+t)+P),P=-1),L=L.previous,he++)}P>=0&&L&&it.setUint32(L.position+t,it.getUint32(L.position+t)+P),A+=te.length*6,A>Jt&&Se(A),o.offset=A;let F=E0(T.subarray(t,A),te);return i=null,F}return o.offset=A,Q&A0?(T.start=t,T.end=A,T):T.subarray(t,A)}catch(L){throw z=L,L}finally{if(s&&(I(),n&&o.saveStructures)){let L=s.sharedLength||0,te=T.subarray(t,A),he=S0(s,o);if(!z)return o.saveStructures(he,he.isCompatible)===!1?o.pack(B,Q):(o.lastNamedStructuresLength=L,T.length>1073741824&&(T=null),te)}T.length>1073741824&&(T=null),Q&_0&&(A=t)}};const I=()=>{K<10&&K++;let B=s.sharedLength||0;if(s.length>B&&!c&&(s.length=B),ie>1e4)s.transitions=null,K=0,ie=0,U.length>0&&(U=[]);else if(U.length>0&&!c){for(let Q=0,z=U.length;Q<z;Q++)U[Q][ci]=0;U=[]}},x=B=>{var Q=B.length;Q<16?T[A++]=144|Q:Q<65536?(T[A++]=220,T[A++]=Q>>8,T[A++]=Q&255):(T[A++]=221,it.setUint32(A,Q),A+=4);for(let z=0;z<Q;z++)k(B[z])},k=B=>{A>Jt&&(T=Se(A));var Q=typeof B,z;if(Q==="string"){let L=B.length;if(bt&&L>=4&&L<4096){if((bt.size+=L)>b0){let F,Y=(bt[0]?bt[0].length*3+bt[1].length:0)+10;A+Y>Jt&&(T=Se(A+Y));let Z;bt.position?(Z=bt,T[A]=200,A+=3,T[A++]=98,F=A-t,A+=4,Vf(t,k,0),it.setUint16(F+t-3,A-t-F)):(T[A++]=214,T[A++]=98,F=A-t,A+=4),bt=["",""],bt.previous=Z,bt.size=0,bt.position=F}let P=w0.test(B);bt[P?0:1]+=B,T[A++]=193,k(P?-L:L);return}let te;L<32?te=1:L<256?te=2:L<65536?te=3:te=5;let he=L*3;if(A+he>Jt&&(T=Se(A+he)),L<64||!a){let P,F,Y,Z=A+te;for(P=0;P<L;P++)F=B.charCodeAt(P),F<128?T[Z++]=F:F<2048?(T[Z++]=F>>6|192,T[Z++]=F&63|128):(F&64512)===55296&&((Y=B.charCodeAt(P+1))&64512)===56320?(F=65536+((F&1023)<<10)+(Y&1023),P++,T[Z++]=F>>18|240,T[Z++]=F>>12&63|128,T[Z++]=F>>6&63|128,T[Z++]=F&63|128):(T[Z++]=F>>12|224,T[Z++]=F>>6&63|128,T[Z++]=F&63|128);z=Z-A-te}else z=a(B,A+te);z<32?T[A++]=160|z:z<256?(te<2&&T.copyWithin(A+2,A+1,A+1+z),T[A++]=217,T[A++]=z):z<65536?(te<3&&T.copyWithin(A+3,A+2,A+2+z),T[A++]=218,T[A++]=z>>8,T[A++]=z&255):(te<5&&T.copyWithin(A+5,A+3,A+3+z),T[A++]=219,it.setUint32(A,z),A+=4),A+=z}else if(Q==="number")if(B>>>0===B)B<32||B<128&&this.useRecords===!1||B<64&&!this.randomAccessStructure?T[A++]=B:B<256?(T[A++]=204,T[A++]=B):B<65536?(T[A++]=205,T[A++]=B>>8,T[A++]=B&255):(T[A++]=206,it.setUint32(A,B),A+=4);else if(B>>0===B)B>=-32?T[A++]=256+B:B>=-128?(T[A++]=208,T[A++]=B+256):B>=-32768?(T[A++]=209,it.setInt16(A,B),A+=2):(T[A++]=210,it.setInt32(A,B),A+=4);else{let L;if((L=this.useFloat32)>0&&B<4294967296&&B>=-2147483648){T[A++]=202,it.setFloat32(A,B);let te;if(L<4||(te=B*Dl[(T[A]&127)<<1|T[A+1]>>7])>>0===te){A+=4;return}else A--}T[A++]=203,it.setFloat64(A,B),A+=8}else if(Q==="object"||Q==="function")if(!B)T[A++]=192;else{if(i){let te=i.get(B);if(te){if(!te.id){let he=i.idsToInsert||(i.idsToInsert=[]);te.id=he.push(te)}T[A++]=214,T[A++]=112,it.setUint32(A,te.id),A+=4;return}else i.set(B,{offset:A-t})}let L=B.constructor;if(L===Object)Fe(B);else if(L===Array)x(B);else if(L===Map)if(this.mapAsEmptyObject)T[A++]=128;else{z=B.size,z<16?T[A++]=128|z:z<65536?(T[A++]=222,T[A++]=z>>8,T[A++]=z&255):(T[A++]=223,it.setUint32(A,z),A+=4);for(let[te,he]of B)k(te),k(he)}else{for(let te=0,he=al.length;te<he;te++){let P=Tm[te];if(B instanceof P){let F=al[te];if(F.write){F.type&&(T[A++]=212,T[A++]=F.type,T[A++]=0);let p=F.write.call(this,B);p===B?Array.isArray(B)?x(B):Fe(B):k(p);return}let Y=T,Z=it,y=A;T=null;let g;try{g=F.pack.call(this,B,p=>(T=Y,Y=null,A+=p,A>Jt&&Se(A),{target:T,targetView:it,position:A-p}),k)}finally{Y&&(T=Y,it=Z,A=y,Jt=T.length-10)}g&&(g.length+A>Jt&&Se(g.length+A),A=v0(g,T,A,F.type));return}}if(Array.isArray(B))x(B);else{if(B.toJSON){const te=B.toJSON();if(te!==B)return k(te)}if(Q==="function")return k(this.writeFunction&&this.writeFunction(B));Fe(B)}}}else if(Q==="boolean")T[A++]=B?195:194;else if(Q==="bigint"){if(B<9223372036854776e3&&B>=-9223372036854776e3)T[A++]=211,it.setBigInt64(A,B);else if(B<18446744073709552e3&&B>0)T[A++]=207,it.setBigUint64(A,B);else if(this.largeBigIntToFloat)T[A++]=203,it.setFloat64(A,Number(B));else{if(this.largeBigIntToString)return k(B.toString());if((this.useBigIntExtension||this.moreTypes)&&B<BigInt(2)**BigInt(1023)&&B>-(BigInt(2)**BigInt(1023))){T[A++]=199,A++,T[A++]=66;let L=[],te;do{let he=B&BigInt(255);te=(he&BigInt(128))===(B<BigInt(0)?BigInt(128):BigInt(0)),L.push(he),B>>=BigInt(8)}while(!((B===BigInt(0)||B===BigInt(-1))&&te));T[A-2]=L.length;for(let he=L.length;he>0;)T[A++]=Number(L[--he]);return}else throw new RangeError(B+" was too large to fit in MessagePack 64-bit integer format, use useBigIntExtension, or set largeBigIntToFloat to convert to float-64, or set largeBigIntToString to convert to string")}A+=8}else if(Q==="undefined")this.encodeUndefinedAsNil?T[A++]=192:(T[A++]=212,T[A++]=0,T[A++]=0);else throw new Error("Unknown type: "+Q)},re=this.variableMapSize||this.coercibleKeyAsNumber||this.skipValues?B=>{let Q;if(this.skipValues){Q=[];for(let te in B)(typeof B.hasOwnProperty!="function"||B.hasOwnProperty(te))&&!this.skipValues.includes(B[te])&&Q.push(te)}else Q=Object.keys(B);let z=Q.length;z<16?T[A++]=128|z:z<65536?(T[A++]=222,T[A++]=z>>8,T[A++]=z&255):(T[A++]=223,it.setUint32(A,z),A+=4);let L;if(this.coercibleKeyAsNumber)for(let te=0;te<z;te++){L=Q[te];let he=Number(L);k(isNaN(he)?L:he),k(B[L])}else for(let te=0;te<z;te++)k(L=Q[te]),k(B[L])}:B=>{T[A++]=222;let Q=A-t;A+=2;let z=0;for(let L in B)(typeof B.hasOwnProperty!="function"||B.hasOwnProperty(L))&&(k(L),k(B[L]),z++);if(z>65535)throw new Error('Object is too large to serialize with fast 16-bit map size, use the "variableMapSize" option to serialize this object');T[Q+++t]=z>>8,T[Q+t]=z&255},ye=this.useRecords===!1?re:e.progressiveRecords&&!v?B=>{let Q,z=s.transitions||(s.transitions=Object.create(null)),L=A++-t,te;for(let he in B)if(typeof B.hasOwnProperty!="function"||B.hasOwnProperty(he)){if(Q=z[he],Q)z=Q;else{let P=Object.keys(B),F=z;z=s.transitions;let Y=0;for(let Z=0,y=P.length;Z<y;Z++){let g=P[Z];Q=z[g],Q||(Q=z[g]=Object.create(null),Y++),z=Q}L+t+1==A?(A--,Ve(z,P,Y)):rt(z,P,L,Y),te=!0,z=F[he]}k(B[he])}if(!te){let he=z[ci];he?T[L+t]=he:rt(z,Object.keys(B),L,0)}}:B=>{let Q,z=s.transitions||(s.transitions=Object.create(null)),L=0;for(let he in B)(typeof B.hasOwnProperty!="function"||B.hasOwnProperty(he))&&(Q=z[he],Q||(Q=z[he]=Object.create(null),L++),z=Q);let te=z[ci];te?te>=96&&v?(T[A++]=((te-=96)&31)+96,T[A++]=te>>5):T[A++]=te:Ve(z,z.__keys__||Object.keys(B),L);for(let he in B)(typeof B.hasOwnProperty!="function"||B.hasOwnProperty(he))&&k(B[he])},fe=typeof this.useRecords=="function"&&this.useRecords,Fe=fe?B=>{fe(B)?ye(B):re(B)}:ye,Se=B=>{let Q;if(B>16777216){if(B-t>zf)throw new Error("Packed buffer would be larger than maximum buffer size");Q=Math.min(zf,Math.round(Math.max((B-t)*(B>67108864?1.25:2),4194304)/4096)*4096)}else Q=(Math.max(B-t<<2,T.length-1)>>12)+1<<12;let z=new ho(Q);return it=z.dataView||(z.dataView=new DataView(z.buffer,0,Q)),B=Math.min(B,T.length),T.copy?T.copy(z,0,t,B):z.set(T.slice(t,B)),A-=t,t=0,Jt=z.length-10,T=z},Ve=(B,Q,z)=>{let L=s.nextId;L||(L=64),L<b&&this.shouldShareStructure&&!this.shouldShareStructure(Q)?(L=s.nextOwnId,L<D||(L=b),s.nextOwnId=L+1):(L>=D&&(L=b),s.nextId=L+1);let te=Q.highByte=L>=96&&v?L-96>>5:-1;B[ci]=L,B.__keys__=Q,s[L-64]=Q,L<b?(Q.isShared=!0,s.sharedLength=L-63,n=!0,te>=0?(T[A++]=(L&31)+96,T[A++]=te):T[A++]=L):(te>=0?(T[A++]=213,T[A++]=114,T[A++]=(L&31)+96,T[A++]=te):(T[A++]=212,T[A++]=114,T[A++]=L),z&&(ie+=K*z),U.length>=d&&(U.shift()[ci]=0),U.push(B),k(Q))},rt=(B,Q,z,L)=>{let te=T,he=A,P=Jt,F=t;T=ia,A=0,t=0,T||(ia=T=new ho(8192)),Jt=T.length-10,Ve(B,Q,L),ia=T;let Y=A;if(T=te,A=he,Jt=P,t=F,Y>1){let Z=A+Y-1;Z>Jt&&Se(Z);let y=z+t;T.copyWithin(y+Y,y+1,A),T.set(ia.slice(0,Y),y),A=Z}else T[z+t]=ia[0]},Te=B=>{let Q=y0(B,T,t,A,s,Se,(z,L,te)=>{if(te)return n=!0;A=L;let he=T;return k(z),I(),he!==T?{position:A,targetView:it,target:T}:A},this);if(Q===0)return Fe(B);A=Q}}useBuffer(e){T=e,T.dataView||(T.dataView=new DataView(T.buffer,T.byteOffset,T.byteLength)),A=0}set position(e){A=e}get position(){return A}clearSharedData(){this.structures&&(this.structures=[]),this.typedStructs&&(this.typedStructs=[])}}Tm=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,DataView,ym];al=[{pack(r,e,t){let n=r.getTime()/1e3;if((this.useTimestamp32||r.getMilliseconds()===0)&&n>=0&&n<4294967296){let{target:s,targetView:i,position:a}=e(6);s[a++]=214,s[a++]=255,i.setUint32(a,n)}else if(n>0&&n<4294967296){let{target:s,targetView:i,position:a}=e(10);s[a++]=215,s[a++]=255,i.setUint32(a,r.getMilliseconds()*4e6+(n/1e3/4294967296>>0)),i.setUint32(a+4,n)}else if(isNaN(n)){if(this.onInvalidDate)return e(0),t(this.onInvalidDate());let{target:s,targetView:i,position:a}=e(3);s[a++]=212,s[a++]=255,s[a++]=255}else{let{target:s,targetView:i,position:a}=e(15);s[a++]=199,s[a++]=12,s[a++]=255,i.setUint32(a,r.getMilliseconds()*1e6),i.setBigInt64(a+4,BigInt(Math.floor(n)))}}},{pack(r,e,t){if(this.setAsEmptyObject)return e(0),t({});let n=Array.from(r),{target:s,position:i}=e(this.moreTypes?3:0);this.moreTypes&&(s[i++]=212,s[i++]=115,s[i++]=0),t(n)}},{pack(r,e,t){let{target:n,position:s}=e(this.moreTypes?3:0);this.moreTypes&&(n[s++]=212,n[s++]=101,n[s++]=0),t([r.name,r.message,r.cause])}},{pack(r,e,t){let{target:n,position:s}=e(this.moreTypes?3:0);this.moreTypes&&(n[s++]=212,n[s++]=120,n[s++]=0),t([r.source,r.flags])}},{pack(r,e){this.moreTypes?Yc(r,16,e):Xc(Oa?Buffer.from(r):new Uint8Array(r),e)}},{pack(r,e){let t=r.constructor;t!==xm&&this.moreTypes?Yc(r,_m.indexOf(t.name),e):Xc(r,e)}},{pack(r,e){this.moreTypes?Yc(r,17,e):Xc(Oa?Buffer.from(r):new Uint8Array(r),e)}},{pack(r,e){let{target:t,position:n}=e(1);t[n]=193}}];function Yc(r,e,t,n){let s=r.byteLength;if(s+1<256){var{target:i,position:a}=t(4+s);i[a++]=199,i[a++]=s+1}else if(s+1<65536){var{target:i,position:a}=t(5+s);i[a++]=200,i[a++]=s+1>>8,i[a++]=s+1&255}else{var{target:i,position:a,targetView:o}=t(7+s);i[a++]=201,o.setUint32(a,s+1),a+=4}i[a++]=116,i[a++]=e,r.buffer||(r=new Uint8Array(r)),i.set(new Uint8Array(r.buffer,r.byteOffset,r.byteLength),a)}function Xc(r,e){let t=r.byteLength;var n,s;if(t<256){var{target:n,position:s}=e(t+2);n[s++]=196,n[s++]=t}else if(t<65536){var{target:n,position:s}=e(t+3);n[s++]=197,n[s++]=t>>8,n[s++]=t&255}else{var{target:n,position:s,targetView:i}=e(t+5);n[s++]=198,i.setUint32(s,t),s+=4}n.set(r,s)}function v0(r,e,t,n){let s=r.length;switch(s){case 1:e[t++]=212;break;case 2:e[t++]=213;break;case 4:e[t++]=214;break;case 8:e[t++]=215;break;case 16:e[t++]=216;break;default:s<256?(e[t++]=199,e[t++]=s):s<65536?(e[t++]=200,e[t++]=s>>8,e[t++]=s&255):(e[t++]=201,e[t++]=s>>24,e[t++]=s>>16&255,e[t++]=s>>8&255,e[t++]=s&255)}return e[t++]=n,e.set(r,t),t+=s,t}function E0(r,e){let t,n=e.length*6,s=r.length-n;for(;t=e.pop();){let i=t.offset,a=t.id;r.copyWithin(i+n,i,s),n-=6;let o=i+n;r[o++]=214,r[o++]=105,r[o++]=a>>24,r[o++]=a>>16&255,r[o++]=a>>8&255,r[o++]=a&255,s=i}return r}function Vf(r,e,t){if(bt.length>0){it.setUint32(bt.position+r,A+t-bt.position-r),bt.stringsPosition=A-r;let n=bt;bt=null,e(n[0]),e(n[1])}}function S0(r,e){return r.isCompatible=t=>{let n=!t||(e.lastNamedStructuresLength||0)===t.length;return n||e._mergeStructures(t),n},r}let Om=new Im({useRecords:!1});Om.pack;Om.pack;const rx=Im,A0=512,_0=1024,B0=2048;class Rm extends Pb{constructor(e,t,n){super(t),this.worker=e,this.options=n}static async new(e={}){var a,o;const t=await n0(),n=mm(t),{module:s,threads:i}=await gm(e.threads,e.wasmPath,e.logger);return await n.init(s,i,am(e.logger??Di("bb_wasm_async")),(a=e.memory)==null?void 0:a.initial,(o=e.memory)==null?void 0:o.maximum),new Rm(t,n,e)}async getNumThreads(){return await this.wasm.getNumThreads()}async initSRSForCircuitSize(e){const t=await Ho.new(e+1,this.options.crsPath,this.options.logger);await this.srsInitSrs(new Ms(t.getG1Data()),t.numPoints,new Ms(t.getG2Data()))}async initSRSClientIVC(){const e=await Ho.new(1048577,this.options.crsPath,this.options.logger),t=await Fl.new(2**16+1,this.options.crsPath,this.options.logger);await this.srsInitSrs(new Ms(e.getG1Data()),e.numPoints,new Ms(e.getG2Data())),await this.srsInitGrumpkinSrs(new Ms(t.getG1Data()),t.numPoints)}async acirInitSRS(e,t,n){const[s,i]=await this.acirGetCircuitSizes(e,t,n);return this.initSRSForCircuitSize(i)}async destroy(){await this.wasm.destroy(),await this.worker.terminate()}getWasm(){return this.wasm}}let Jc,mo;class Ht extends Nb{constructor(e){super(e)}static async new(e,t=Di("bb_wasm_sync")){const n=new Ac,{module:s,threads:i}=await gm(1,e,t);return await n.init(s,i,t),new Ht(n)}static async initSingleton(e,t=Di("bb_wasm_sync")){return Jc||(Jc=Ht.new(e,t)),mo=await Jc,mo}static getSingleton(){if(!mo)throw new Error("First call BarretenbergSync.initSingleton() on @aztec/bb.js module.");return mo}getWasm(){return this.wasm}}var ue={},Fm={},Ml=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),n=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var s=42;e[t]=s;for(var i in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var a=Object.getOwnPropertySymbols(e);if(a.length!==1||a[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(e,t);if(o.value!==s||o.enumerable!==!0)return!1}return!0},T0=Ml,Bc=function(){return T0()&&!!Symbol.toStringTag},Ul=Object,x0=Error,I0=EvalError,O0=RangeError,R0=ReferenceError,Cm=SyntaxError,za=TypeError,F0=URIError,C0=Math.abs,P0=Math.floor,N0=Math.max,k0=Math.min,L0=Math.pow,$0=Math.round,H0=Number.isNaN||function(e){return e!==e},D0=H0,M0=function(e){return D0(e)||e===0?e:e<0?-1:1},U0=Object.getOwnPropertyDescriptor,Ao=U0;if(Ao)try{Ao([],"length")}catch{Ao=null}var Ki=Ao,_o=Object.defineProperty||!1;if(_o)try{_o({},"a",{value:1})}catch{_o=!1}var Tc=_o,Qc,qf;function j0(){if(qf)return Qc;qf=1;var r=typeof Symbol<"u"&&Symbol,e=Ml;return Qc=function(){return typeof r!="function"||typeof Symbol!="function"||typeof r("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},Qc}var eu,Wf;function Pm(){return Wf||(Wf=1,eu=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),eu}var tu,Gf;function Nm(){if(Gf)return tu;Gf=1;var r=Ul;return tu=r.getPrototypeOf||null,tu}var Z0="Function.prototype.bind called on incompatible ",z0=Object.prototype.toString,V0=Math.max,q0="[object Function]",Kf=function(e,t){for(var n=[],s=0;s<e.length;s+=1)n[s]=e[s];for(var i=0;i<t.length;i+=1)n[i+e.length]=t[i];return n},W0=function(e,t){for(var n=[],s=t,i=0;s<e.length;s+=1,i+=1)n[i]=e[s];return n},G0=function(r,e){for(var t="",n=0;n<r.length;n+=1)t+=r[n],n+1<r.length&&(t+=e);return t},K0=function(e){var t=this;if(typeof t!="function"||z0.apply(t)!==q0)throw new TypeError(Z0+t);for(var n=W0(arguments,1),s,i=function(){if(this instanceof s){var h=t.apply(this,Kf(n,arguments));return Object(h)===h?h:this}return t.apply(e,Kf(n,arguments))},a=V0(0,t.length-n.length),o=[],c=0;c<a;c++)o[c]="$"+c;if(s=Function("binder","return function ("+G0(o,",")+"){ return binder.apply(this,arguments); }")(i),t.prototype){var f=function(){};f.prototype=t.prototype,s.prototype=new f,f.prototype=null}return s},Y0=K0,Va=Function.prototype.bind||Y0,jl=Function.prototype.call,Zl=Function.prototype.apply,X0=typeof Reflect<"u"&&Reflect&&Reflect.apply,J0=Va,Q0=Zl,ew=jl,tw=X0,km=tw||J0.call(ew,Q0),rw=Va,nw=za,sw=jl,iw=km,zl=function(e){if(e.length<1||typeof e[0]!="function")throw new nw("a function is required");return iw(rw,sw,e)},ru,Yf;function aw(){if(Yf)return ru;Yf=1;var r=zl,e=Ki,t;try{t=[].__proto__===Array.prototype}catch(a){if(!a||typeof a!="object"||!("code"in a)||a.code!=="ERR_PROTO_ACCESS")throw a}var n=!!t&&e&&e(Object.prototype,"__proto__"),s=Object,i=s.getPrototypeOf;return ru=n&&typeof n.get=="function"?r([n.get]):typeof i=="function"?function(o){return i(o==null?o:s(o))}:!1,ru}var nu,Xf;function Vl(){if(Xf)return nu;Xf=1;var r=Pm(),e=Nm(),t=aw();return nu=r?function(s){return r(s)}:e?function(s){if(!s||typeof s!="object"&&typeof s!="function")throw new TypeError("getProto: not an object");return e(s)}:t?function(s){return t(s)}:null,nu}var su,Jf;function Lm(){if(Jf)return su;Jf=1;var r=Function.prototype.call,e=Object.prototype.hasOwnProperty,t=Va;return su=t.call(r,e),su}var Le,ow=Ul,cw=x0,uw=I0,lw=O0,fw=R0,Mi=Cm,Oi=za,dw=F0,hw=C0,mw=P0,pw=N0,gw=k0,yw=L0,bw=$0,ww=M0,$m=Function,iu=function(r){try{return $m('"use strict"; return ('+r+").constructor;")()}catch{}},Ra=Ki,vw=Tc,au=function(){throw new Oi},Ew=Ra?function(){try{return arguments.callee,au}catch{try{return Ra(arguments,"callee").get}catch{return au}}}():au,ui=j0()(),Pt=Vl(),Sw=Nm(),Aw=Pm(),Hm=Zl,qa=jl,hi={},_w=typeof Uint8Array>"u"||!Pt?Le:Pt(Uint8Array),Ws={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?Le:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?Le:ArrayBuffer,"%ArrayIteratorPrototype%":ui&&Pt?Pt([][Symbol.iterator]()):Le,"%AsyncFromSyncIteratorPrototype%":Le,"%AsyncFunction%":hi,"%AsyncGenerator%":hi,"%AsyncGeneratorFunction%":hi,"%AsyncIteratorPrototype%":hi,"%Atomics%":typeof Atomics>"u"?Le:Atomics,"%BigInt%":typeof BigInt>"u"?Le:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?Le:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?Le:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?Le:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":cw,"%eval%":eval,"%EvalError%":uw,"%Float16Array%":typeof Float16Array>"u"?Le:Float16Array,"%Float32Array%":typeof Float32Array>"u"?Le:Float32Array,"%Float64Array%":typeof Float64Array>"u"?Le:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?Le:FinalizationRegistry,"%Function%":$m,"%GeneratorFunction%":hi,"%Int8Array%":typeof Int8Array>"u"?Le:Int8Array,"%Int16Array%":typeof Int16Array>"u"?Le:Int16Array,"%Int32Array%":typeof Int32Array>"u"?Le:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":ui&&Pt?Pt(Pt([][Symbol.iterator]())):Le,"%JSON%":typeof JSON=="object"?JSON:Le,"%Map%":typeof Map>"u"?Le:Map,"%MapIteratorPrototype%":typeof Map>"u"||!ui||!Pt?Le:Pt(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":ow,"%Object.getOwnPropertyDescriptor%":Ra,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?Le:Promise,"%Proxy%":typeof Proxy>"u"?Le:Proxy,"%RangeError%":lw,"%ReferenceError%":fw,"%Reflect%":typeof Reflect>"u"?Le:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?Le:Set,"%SetIteratorPrototype%":typeof Set>"u"||!ui||!Pt?Le:Pt(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?Le:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":ui&&Pt?Pt(""[Symbol.iterator]()):Le,"%Symbol%":ui?Symbol:Le,"%SyntaxError%":Mi,"%ThrowTypeError%":Ew,"%TypedArray%":_w,"%TypeError%":Oi,"%Uint8Array%":typeof Uint8Array>"u"?Le:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?Le:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?Le:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?Le:Uint32Array,"%URIError%":dw,"%WeakMap%":typeof WeakMap>"u"?Le:WeakMap,"%WeakRef%":typeof WeakRef>"u"?Le:WeakRef,"%WeakSet%":typeof WeakSet>"u"?Le:WeakSet,"%Function.prototype.call%":qa,"%Function.prototype.apply%":Hm,"%Object.defineProperty%":vw,"%Object.getPrototypeOf%":Sw,"%Math.abs%":hw,"%Math.floor%":mw,"%Math.max%":pw,"%Math.min%":gw,"%Math.pow%":yw,"%Math.round%":bw,"%Math.sign%":ww,"%Reflect.getPrototypeOf%":Aw};if(Pt)try{null.error}catch(r){var Bw=Pt(Pt(r));Ws["%Error.prototype%"]=Bw}var Tw=function r(e){var t;if(e==="%AsyncFunction%")t=iu("async function () {}");else if(e==="%GeneratorFunction%")t=iu("function* () {}");else if(e==="%AsyncGeneratorFunction%")t=iu("async function* () {}");else if(e==="%AsyncGenerator%"){var n=r("%AsyncGeneratorFunction%");n&&(t=n.prototype)}else if(e==="%AsyncIteratorPrototype%"){var s=r("%AsyncGenerator%");s&&Pt&&(t=Pt(s.prototype))}return Ws[e]=t,t},Qf={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Wa=Va,Zo=Lm(),xw=Wa.call(qa,Array.prototype.concat),Iw=Wa.call(Hm,Array.prototype.splice),ed=Wa.call(qa,String.prototype.replace),zo=Wa.call(qa,String.prototype.slice),Ow=Wa.call(qa,RegExp.prototype.exec),Rw=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Fw=/\\(\\)?/g,Cw=function(e){var t=zo(e,0,1),n=zo(e,-1);if(t==="%"&&n!=="%")throw new Mi("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&t!=="%")throw new Mi("invalid intrinsic syntax, expected opening `%`");var s=[];return ed(e,Rw,function(i,a,o,c){s[s.length]=o?ed(c,Fw,"$1"):a||i}),s},Pw=function(e,t){var n=e,s;if(Zo(Qf,n)&&(s=Qf[n],n="%"+s[0]+"%"),Zo(Ws,n)){var i=Ws[n];if(i===hi&&(i=Tw(n)),typeof i>"u"&&!t)throw new Oi("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:s,name:n,value:i}}throw new Mi("intrinsic "+e+" does not exist!")},ql=function(e,t){if(typeof e!="string"||e.length===0)throw new Oi("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof t!="boolean")throw new Oi('"allowMissing" argument must be a boolean');if(Ow(/^%?[^%]*%?$/,e)===null)throw new Mi("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=Cw(e),s=n.length>0?n[0]:"",i=Pw("%"+s+"%",t),a=i.name,o=i.value,c=!1,f=i.alias;f&&(s=f[0],Iw(n,xw([0,1],f)));for(var h=1,d=!0;h<n.length;h+=1){var v=n[h],b=zo(v,0,1),D=zo(v,-1);if((b==='"'||b==="'"||b==="`"||D==='"'||D==="'"||D==="`")&&b!==D)throw new Mi("property names with quotes must have matching quotes");if((v==="constructor"||!d)&&(c=!0),s+="."+v,a="%"+s+"%",Zo(Ws,a))o=Ws[a];else if(o!=null){if(!(v in o)){if(!t)throw new Oi("base intrinsic for "+e+" exists, but the property is not available.");return}if(Ra&&h+1>=n.length){var U=Ra(o,v);d=!!U,d&&"get"in U&&!("originalValue"in U.get)?o=U.get:o=o[v]}else d=Zo(o,v),o=o[v];d&&!c&&(Ws[a]=o)}}return o},Dm=ql,Mm=zl,Nw=Mm([Dm("%String.prototype.indexOf%")]),Yi=function(e,t){var n=Dm(e,!!t);return typeof n=="function"&&Nw(e,".prototype.")>-1?Mm([n]):n},kw=Bc(),Lw=Yi,ol=Lw("Object.prototype.toString"),xc=function(e){return kw&&e&&typeof e=="object"&&Symbol.toStringTag in e?!1:ol(e)==="[object Arguments]"},Um=function(e){return xc(e)?!0:e!==null&&typeof e=="object"&&"length"in e&&typeof e.length=="number"&&e.length>=0&&ol(e)!=="[object Array]"&&"callee"in e&&ol(e.callee)==="[object Function]"},$w=function(){return xc(arguments)}();xc.isLegacyArguments=Um;var Hw=$w?xc:Um,td=Yi,Dw=Bc(),Mw=Lm(),Uw=Ki,cl;if(Dw){var jw=td("RegExp.prototype.exec"),rd={},ou=function(){throw rd},nd={toString:ou,valueOf:ou};typeof Symbol.toPrimitive=="symbol"&&(nd[Symbol.toPrimitive]=ou),cl=function(e){if(!e||typeof e!="object")return!1;var t=Uw(e,"lastIndex"),n=t&&Mw(t,"value");if(!n)return!1;try{jw(e,nd)}catch(s){return s===rd}}}else{var Zw=td("Object.prototype.toString"),zw="[object RegExp]";cl=function(e){return!e||typeof e!="object"&&typeof e!="function"?!1:Zw(e)===zw}}var Vw=cl,qw=Yi,Ww=Vw,Gw=qw("RegExp.prototype.exec"),Kw=za,Yw=function(e){if(!Ww(e))throw new Kw("`regex` must be a RegExp");return function(n){return Gw(e,n)!==null}},jm=Yi,Xw=Yw,Jw=Xw(/^\s*(?:function)?\*/),Zm=Bc(),cu=Vl(),Qw=jm("Object.prototype.toString"),ev=jm("Function.prototype.toString"),tv=function(){if(!Zm)return!1;try{return Function("return function*() {}")()}catch{}},uu,rv=function(e){if(typeof e!="function")return!1;if(Jw(ev(e)))return!0;if(!Zm){var t=Qw(e);return t==="[object GeneratorFunction]"}if(!cu)return!1;if(typeof uu>"u"){var n=tv();uu=n?cu(n):!1}return cu(e)===uu},zm=Function.prototype.toString,pi=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,ul,Bo;if(typeof pi=="function"&&typeof Object.defineProperty=="function")try{ul=Object.defineProperty({},"length",{get:function(){throw Bo}}),Bo={},pi(function(){throw 42},null,ul)}catch(r){r!==Bo&&(pi=null)}else pi=null;var nv=/^\s*class\b/,ll=function(e){try{var t=zm.call(e);return nv.test(t)}catch{return!1}},lu=function(e){try{return ll(e)?!1:(zm.call(e),!0)}catch{return!1}},To=Object.prototype.toString,sv="[object Object]",iv="[object Function]",av="[object GeneratorFunction]",ov="[object HTMLAllCollection]",cv="[object HTML document.all class]",uv="[object HTMLCollection]",lv=typeof Symbol=="function"&&!!Symbol.toStringTag,fv=!(0 in[,]),fl=function(){return!1};if(typeof document=="object"){var dv=document.all;To.call(dv)===To.call(document.all)&&(fl=function(e){if((fv||!e)&&(typeof e>"u"||typeof e=="object"))try{var t=To.call(e);return(t===ov||t===cv||t===uv||t===sv)&&e("")==null}catch{}return!1})}var hv=pi?function(e){if(fl(e))return!0;if(!e||typeof e!="function"&&typeof e!="object")return!1;try{pi(e,null,ul)}catch(t){if(t!==Bo)return!1}return!ll(e)&&lu(e)}:function(e){if(fl(e))return!0;if(!e||typeof e!="function"&&typeof e!="object")return!1;if(lv)return lu(e);if(ll(e))return!1;var t=To.call(e);return t!==iv&&t!==av&&!/^\[object HTML/.test(t)?!1:lu(e)},mv=hv,pv=Object.prototype.toString,Vm=Object.prototype.hasOwnProperty,gv=function(e,t,n){for(var s=0,i=e.length;s<i;s++)Vm.call(e,s)&&(n==null?t(e[s],s,e):t.call(n,e[s],s,e))},yv=function(e,t,n){for(var s=0,i=e.length;s<i;s++)n==null?t(e.charAt(s),s,e):t.call(n,e.charAt(s),s,e)},bv=function(e,t,n){for(var s in e)Vm.call(e,s)&&(n==null?t(e[s],s,e):t.call(n,e[s],s,e))};function wv(r){return pv.call(r)==="[object Array]"}var vv=function(e,t,n){if(!mv(t))throw new TypeError("iterator must be a function");var s;arguments.length>=3&&(s=n),wv(e)?gv(e,t,s):typeof e=="string"?yv(e,t,s):bv(e,t,s)},Ev=["Float16Array","Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"],fu=Ev,Sv=globalThis,Av=function(){for(var e=[],t=0;t<fu.length;t++)typeof Sv[fu[t]]=="function"&&(e[e.length]=fu[t]);return e},qm={exports:{}},sd=Tc,_v=Cm,li=za,id=Ki,Wm=function(e,t,n){if(!e||typeof e!="object"&&typeof e!="function")throw new li("`obj` must be an object or a function`");if(typeof t!="string"&&typeof t!="symbol")throw new li("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new li("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new li("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new li("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new li("`loose`, if provided, must be a boolean");var s=arguments.length>3?arguments[3]:null,i=arguments.length>4?arguments[4]:null,a=arguments.length>5?arguments[5]:null,o=arguments.length>6?arguments[6]:!1,c=!!id&&id(e,t);if(sd)sd(e,t,{configurable:a===null&&c?c.configurable:!a,enumerable:s===null&&c?c.enumerable:!s,value:n,writable:i===null&&c?c.writable:!i});else if(o||!s&&!i&&!a)e[t]=n;else throw new _v("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},dl=Tc,Gm=function(){return!!dl};Gm.hasArrayLengthDefineBug=function(){if(!dl)return null;try{return dl([],"length",{value:1}).length!==1}catch{return!0}};var Km=Gm,Bv=ql,ad=Wm,Tv=Km(),od=Ki,cd=za,xv=Bv("%Math.floor%"),Iv=function(e,t){if(typeof e!="function")throw new cd("`fn` is not a function");if(typeof t!="number"||t<0||t>4294967295||xv(t)!==t)throw new cd("`length` must be a positive 32-bit integer");var n=arguments.length>2&&!!arguments[2],s=!0,i=!0;if("length"in e&&od){var a=od(e,"length");a&&!a.configurable&&(s=!1),a&&!a.writable&&(i=!1)}return(s||i||!n)&&(Tv?ad(e,"length",t,!0,!0):ad(e,"length",t)),e},Ov=Va,Rv=Zl,Fv=km,Cv=function(){return Fv(Ov,Rv,arguments)};(function(r){var e=Iv,t=Tc,n=zl,s=Cv;r.exports=function(a){var o=n(arguments),c=a.length-(arguments.length-1);return e(o,1+(c>0?c:0),!0)},t?t(r.exports,"apply",{value:s}):r.exports.apply=s})(qm);var Ic=qm.exports,Vo=vv,Pv=Av,ud=Ic,Wl=Yi,xo=Ki,po=Vl(),Nv=Wl("Object.prototype.toString"),Ym=Bc(),ld=globalThis,hl=Pv(),Gl=Wl("String.prototype.slice"),kv=Wl("Array.prototype.indexOf",!0)||function(e,t){for(var n=0;n<e.length;n+=1)if(e[n]===t)return n;return-1},qo={__proto__:null};Ym&&xo&&po?Vo(hl,function(r){var e=new ld[r];if(Symbol.toStringTag in e&&po){var t=po(e),n=xo(t,Symbol.toStringTag);if(!n&&t){var s=po(t);n=xo(s,Symbol.toStringTag)}qo["$"+r]=ud(n.get)}}):Vo(hl,function(r){var e=new ld[r],t=e.slice||e.set;t&&(qo["$"+r]=ud(t))});var Lv=function(e){var t=!1;return Vo(qo,function(n,s){if(!t)try{"$"+n(e)===s&&(t=Gl(s,1))}catch{}}),t},$v=function(e){var t=!1;return Vo(qo,function(n,s){if(!t)try{n(e),t=Gl(s,1)}catch{}}),t},Xm=function(e){if(!e||typeof e!="object")return!1;if(!Ym){var t=Gl(Nv(e),8,-1);return kv(hl,t)>-1?t:t!=="Object"?!1:$v(e)}return xo?Lv(e):null},Hv=Xm,Dv=function(e){return!!Hv(e)};(function(r){var e=Hw,t=rv,n=Xm,s=Dv;function i(H){return H.call.bind(H)}var a=typeof BigInt<"u",o=typeof Symbol<"u",c=i(Object.prototype.toString),f=i(Number.prototype.valueOf),h=i(String.prototype.valueOf),d=i(Boolean.prototype.valueOf);if(a)var v=i(BigInt.prototype.valueOf);if(o)var b=i(Symbol.prototype.valueOf);function D(H,cs){if(typeof H!="object")return!1;try{return cs(H),!0}catch{return!1}}r.isArgumentsObject=e,r.isGeneratorFunction=t,r.isTypedArray=s;function U(H){return typeof Promise<"u"&&H instanceof Promise||H!==null&&typeof H=="object"&&typeof H.then=="function"&&typeof H.catch=="function"}r.isPromise=U;function ie(H){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(H):s(H)||y(H)}r.isArrayBufferView=ie;function K(H){return n(H)==="Uint8Array"}r.isUint8Array=K;function I(H){return n(H)==="Uint8ClampedArray"}r.isUint8ClampedArray=I;function x(H){return n(H)==="Uint16Array"}r.isUint16Array=x;function k(H){return n(H)==="Uint32Array"}r.isUint32Array=k;function re(H){return n(H)==="Int8Array"}r.isInt8Array=re;function ye(H){return n(H)==="Int16Array"}r.isInt16Array=ye;function fe(H){return n(H)==="Int32Array"}r.isInt32Array=fe;function Fe(H){return n(H)==="Float32Array"}r.isFloat32Array=Fe;function Se(H){return n(H)==="Float64Array"}r.isFloat64Array=Se;function Ve(H){return n(H)==="BigInt64Array"}r.isBigInt64Array=Ve;function rt(H){return n(H)==="BigUint64Array"}r.isBigUint64Array=rt;function Te(H){return c(H)==="[object Map]"}Te.working=typeof Map<"u"&&Te(new Map);function B(H){return typeof Map>"u"?!1:Te.working?Te(H):H instanceof Map}r.isMap=B;function Q(H){return c(H)==="[object Set]"}Q.working=typeof Set<"u"&&Q(new Set);function z(H){return typeof Set>"u"?!1:Q.working?Q(H):H instanceof Set}r.isSet=z;function L(H){return c(H)==="[object WeakMap]"}L.working=typeof WeakMap<"u"&&L(new WeakMap);function te(H){return typeof WeakMap>"u"?!1:L.working?L(H):H instanceof WeakMap}r.isWeakMap=te;function he(H){return c(H)==="[object WeakSet]"}he.working=typeof WeakSet<"u"&&he(new WeakSet);function P(H){return he(H)}r.isWeakSet=P;function F(H){return c(H)==="[object ArrayBuffer]"}F.working=typeof ArrayBuffer<"u"&&F(new ArrayBuffer);function Y(H){return typeof ArrayBuffer>"u"?!1:F.working?F(H):H instanceof ArrayBuffer}r.isArrayBuffer=Y;function Z(H){return c(H)==="[object DataView]"}Z.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&Z(new DataView(new ArrayBuffer(1),0,1));function y(H){return typeof DataView>"u"?!1:Z.working?Z(H):H instanceof DataView}r.isDataView=y;var g=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function p(H){return c(H)==="[object SharedArrayBuffer]"}function E(H){return typeof g>"u"?!1:(typeof p.working>"u"&&(p.working=p(new g)),p.working?p(H):H instanceof g)}r.isSharedArrayBuffer=E;function M(H){return c(H)==="[object AsyncFunction]"}r.isAsyncFunction=M;function N(H){return c(H)==="[object Map Iterator]"}r.isMapIterator=N;function $(H){return c(H)==="[object Set Iterator]"}r.isSetIterator=$;function X(H){return c(H)==="[object Generator]"}r.isGeneratorObject=X;function ge(H){return c(H)==="[object WebAssembly.Module]"}r.isWebAssemblyCompiledModule=ge;function Oe(H){return D(H,f)}r.isNumberObject=Oe;function Ue(H){return D(H,h)}r.isStringObject=Ue;function pt(H){return D(H,d)}r.isBooleanObject=pt;function jt(H){return a&&D(H,v)}r.isBigIntObject=jt;function Ir(H){return o&&D(H,b)}r.isSymbolObject=Ir;function Kr(H){return Oe(H)||Ue(H)||pt(H)||jt(H)||Ir(H)}r.isBoxedPrimitive=Kr;function Dt(H){return typeof Uint8Array<"u"&&(Y(H)||E(H))}r.isAnyArrayBuffer=Dt,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(H){Object.defineProperty(r,H,{enumerable:!1,value:function(){throw new Error(H+" is not supported in userland")}})})})(Fm);var Mv=function(e){return e&&typeof e=="object"&&typeof e.copy=="function"&&typeof e.fill=="function"&&typeof e.readUInt8=="function"},ml={exports:{}};typeof Object.create=="function"?ml.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:ml.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}};var Jm=ml.exports;(function(r){var e={},t=Object.getOwnPropertyDescriptors||function(g){for(var p=Object.keys(g),E={},M=0;M<p.length;M++)E[p[M]]=Object.getOwnPropertyDescriptor(g,p[M]);return E},n=/%[sdj%]/g;r.format=function(y){if(!ye(y)){for(var g=[],p=0;p<arguments.length;p++)g.push(o(arguments[p]));return g.join(" ")}for(var p=1,E=arguments,M=E.length,N=String(y).replace(n,function(X){if(X==="%%")return"%";if(p>=M)return X;switch(X){case"%s":return String(E[p++]);case"%d":return Number(E[p++]);case"%j":try{return JSON.stringify(E[p++])}catch{return"[Circular]"}default:return X}}),$=E[p];p<M;$=E[++p])x($)||!Ve($)?N+=" "+$:N+=" "+o($);return N},r.deprecate=function(y,g){if(typeof process<"u"&&process.noDeprecation===!0)return y;if(typeof process>"u")return function(){return r.deprecate(y,g).apply(this,arguments)};var p=!1;function E(){if(!p){if(process.throwDeprecation)throw new Error(g);process.traceDeprecation?console.trace(g):console.error(g),p=!0}return y.apply(this,arguments)}return E};var s={},i=/^$/;if(e.NODE_DEBUG){var a=e.NODE_DEBUG;a=a.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),i=new RegExp("^"+a+"$","i")}r.debuglog=function(y){if(y=y.toUpperCase(),!s[y])if(i.test(y)){var g=process.pid;s[y]=function(){var p=r.format.apply(r,arguments);console.error("%s %d: %s",y,g,p)}}else s[y]=function(){};return s[y]};function o(y,g){var p={seen:[],stylize:f};return arguments.length>=3&&(p.depth=arguments[2]),arguments.length>=4&&(p.colors=arguments[3]),I(g)?p.showHidden=g:g&&r._extend(p,g),Fe(p.showHidden)&&(p.showHidden=!1),Fe(p.depth)&&(p.depth=2),Fe(p.colors)&&(p.colors=!1),Fe(p.customInspect)&&(p.customInspect=!0),p.colors&&(p.stylize=c),d(p,y,p.depth)}r.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function c(y,g){var p=o.styles[g];return p?"\x1B["+o.colors[p][0]+"m"+y+"\x1B["+o.colors[p][1]+"m":y}function f(y,g){return y}function h(y){var g={};return y.forEach(function(p,E){g[p]=!0}),g}function d(y,g,p){if(y.customInspect&&g&&B(g.inspect)&&g.inspect!==r.inspect&&!(g.constructor&&g.constructor.prototype===g)){var E=g.inspect(p,y);return ye(E)||(E=d(y,E,p)),E}var M=v(y,g);if(M)return M;var N=Object.keys(g),$=h(N);if(y.showHidden&&(N=Object.getOwnPropertyNames(g)),Te(g)&&(N.indexOf("message")>=0||N.indexOf("description")>=0))return b(g);if(N.length===0){if(B(g)){var X=g.name?": "+g.name:"";return y.stylize("[Function"+X+"]","special")}if(Se(g))return y.stylize(RegExp.prototype.toString.call(g),"regexp");if(rt(g))return y.stylize(Date.prototype.toString.call(g),"date");if(Te(g))return b(g)}var ge="",Oe=!1,Ue=["{","}"];if(K(g)&&(Oe=!0,Ue=["[","]"]),B(g)){var pt=g.name?": "+g.name:"";ge=" [Function"+pt+"]"}if(Se(g)&&(ge=" "+RegExp.prototype.toString.call(g)),rt(g)&&(ge=" "+Date.prototype.toUTCString.call(g)),Te(g)&&(ge=" "+b(g)),N.length===0&&(!Oe||g.length==0))return Ue[0]+ge+Ue[1];if(p<0)return Se(g)?y.stylize(RegExp.prototype.toString.call(g),"regexp"):y.stylize("[Object]","special");y.seen.push(g);var jt;return Oe?jt=D(y,g,p,$,N):jt=N.map(function(Ir){return U(y,g,p,$,Ir,Oe)}),y.seen.pop(),ie(jt,ge,Ue)}function v(y,g){if(Fe(g))return y.stylize("undefined","undefined");if(ye(g)){var p="'"+JSON.stringify(g).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return y.stylize(p,"string")}if(re(g))return y.stylize(""+g,"number");if(I(g))return y.stylize(""+g,"boolean");if(x(g))return y.stylize("null","null")}function b(y){return"["+Error.prototype.toString.call(y)+"]"}function D(y,g,p,E,M){for(var N=[],$=0,X=g.length;$<X;++$)P(g,String($))?N.push(U(y,g,p,E,String($),!0)):N.push("");return M.forEach(function(ge){ge.match(/^\d+$/)||N.push(U(y,g,p,E,ge,!0))}),N}function U(y,g,p,E,M,N){var $,X,ge;if(ge=Object.getOwnPropertyDescriptor(g,M)||{value:g[M]},ge.get?ge.set?X=y.stylize("[Getter/Setter]","special"):X=y.stylize("[Getter]","special"):ge.set&&(X=y.stylize("[Setter]","special")),P(E,M)||($="["+M+"]"),X||(y.seen.indexOf(ge.value)<0?(x(p)?X=d(y,ge.value,null):X=d(y,ge.value,p-1),X.indexOf(`
`)>-1&&(N?X=X.split(`
`).map(function(Oe){return"  "+Oe}).join(`
`).slice(2):X=`
`+X.split(`
`).map(function(Oe){return"   "+Oe}).join(`
`))):X=y.stylize("[Circular]","special")),Fe($)){if(N&&M.match(/^\d+$/))return X;$=JSON.stringify(""+M),$.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?($=$.slice(1,-1),$=y.stylize($,"name")):($=$.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),$=y.stylize($,"string"))}return $+": "+X}function ie(y,g,p){var E=y.reduce(function(M,N){return N.indexOf(`
`)>=0,M+N.replace(/\u001b\[\d\d?m/g,"").length+1},0);return E>60?p[0]+(g===""?"":g+`
 `)+" "+y.join(`,
  `)+" "+p[1]:p[0]+g+" "+y.join(", ")+" "+p[1]}r.types=Fm;function K(y){return Array.isArray(y)}r.isArray=K;function I(y){return typeof y=="boolean"}r.isBoolean=I;function x(y){return y===null}r.isNull=x;function k(y){return y==null}r.isNullOrUndefined=k;function re(y){return typeof y=="number"}r.isNumber=re;function ye(y){return typeof y=="string"}r.isString=ye;function fe(y){return typeof y=="symbol"}r.isSymbol=fe;function Fe(y){return y===void 0}r.isUndefined=Fe;function Se(y){return Ve(y)&&z(y)==="[object RegExp]"}r.isRegExp=Se,r.types.isRegExp=Se;function Ve(y){return typeof y=="object"&&y!==null}r.isObject=Ve;function rt(y){return Ve(y)&&z(y)==="[object Date]"}r.isDate=rt,r.types.isDate=rt;function Te(y){return Ve(y)&&(z(y)==="[object Error]"||y instanceof Error)}r.isError=Te,r.types.isNativeError=Te;function B(y){return typeof y=="function"}r.isFunction=B;function Q(y){return y===null||typeof y=="boolean"||typeof y=="number"||typeof y=="string"||typeof y=="symbol"||typeof y>"u"}r.isPrimitive=Q,r.isBuffer=Mv;function z(y){return Object.prototype.toString.call(y)}function L(y){return y<10?"0"+y.toString(10):y.toString(10)}var te=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function he(){var y=new Date,g=[L(y.getHours()),L(y.getMinutes()),L(y.getSeconds())].join(":");return[y.getDate(),te[y.getMonth()],g].join(" ")}r.log=function(){console.log("%s - %s",he(),r.format.apply(r,arguments))},r.inherits=Jm,r._extend=function(y,g){if(!g||!Ve(g))return y;for(var p=Object.keys(g),E=p.length;E--;)y[p[E]]=g[p[E]];return y};function P(y,g){return Object.prototype.hasOwnProperty.call(y,g)}var F=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;r.promisify=function(g){if(typeof g!="function")throw new TypeError('The "original" argument must be of type Function');if(F&&g[F]){var p=g[F];if(typeof p!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(p,F,{value:p,enumerable:!1,writable:!1,configurable:!0}),p}function p(){for(var E,M,N=new Promise(function(ge,Oe){E=ge,M=Oe}),$=[],X=0;X<arguments.length;X++)$.push(arguments[X]);$.push(function(ge,Oe){ge?M(ge):E(Oe)});try{g.apply(this,$)}catch(ge){M(ge)}return N}return Object.setPrototypeOf(p,Object.getPrototypeOf(g)),F&&Object.defineProperty(p,F,{value:p,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(p,t(g))},r.promisify.custom=F;function Y(y,g){if(!y){var p=new Error("Promise was rejected with a falsy value");p.reason=y,y=p}return g(y)}function Z(y){if(typeof y!="function")throw new TypeError('The "original" argument must be of type Function');function g(){for(var p=[],E=0;E<arguments.length;E++)p.push(arguments[E]);var M=p.pop();if(typeof M!="function")throw new TypeError("The last argument must be of type Function");var N=this,$=function(){return M.apply(N,arguments)};y.apply(this,p).then(function(X){process.nextTick($.bind(null,null,X))},function(X){process.nextTick(Y.bind(null,X,$))})}return Object.setPrototypeOf(g,Object.getPrototypeOf(y)),Object.defineProperties(g,t(y)),g}r.callbackify=Z})(ue);function un(r){const e=r.toString("hex");return e.length===0?BigInt(0):BigInt(`0x${e}`)}function pr(r,e){if(r<BigInt(0))throw new Error(`Cannot convert negative bigint ${r.toString()} to buffer with toBufferBE.`);const t=r.toString(16),n=Buffer.from(t.padStart(e*2,"0").slice(0,e*2),"hex");if(n.length>e)throw new Error(`Number ${r.toString(16)} does not fit in ${e}`);return n}function Qm(r){if(!/^(0x)?[0-9a-fA-F]*$/.test(r)||r.length%2!==0)throw new Error(`Invalid hex string: ${r}`);return Buffer.from(r.replace(/^0x/i,""),"hex")}const Uv={},jv=Object.freeze(Object.defineProperty({__proto__:null,default:Uv},Symbol.toStringTag,{value:"Module"})),{env:Vs={},argv:ep=[],platform:Zv=""}=typeof process>"u"?{}:process,zv="NO_COLOR"in Vs||ep.includes("--no-color"),Vv="FORCE_COLOR"in Vs||ep.includes("--color"),qv=Zv==="win32",Wv=Vs.TERM==="dumb",Gv=jv&&void 0,Kv="CI"in Vs&&("GITHUB_ACTIONS"in Vs||"GITLAB_CI"in Vs||"CIRCLECI"in Vs),tp=!zv&&(Vv||qv&&!Wv||Gv||Kv),rp=(r,e,t,n,s=e.substring(0,r)+n,i=e.substring(r+t.length),a=i.indexOf(t))=>s+(a<0?i:rp(a,i,t,n)),Yv=(r,e,t,n,s)=>r<0?t+e+n:t+rp(r,e,n,s)+n,Xv=(r,e,t=r,n=r.length+1)=>s=>s||!(s===""||s===void 0)?Yv((""+s).indexOf(e,n),s,r,e,t):"",Pe=(r,e,t)=>Xv(`\x1B[${r}m`,`\x1B[${e}m`,t),fd={reset:Pe(0,0),bold:Pe(1,22,"\x1B[22m\x1B[1m"),dim:Pe(2,22,"\x1B[22m\x1B[2m"),italic:Pe(3,23),underline:Pe(4,24),inverse:Pe(7,27),hidden:Pe(8,28),strikethrough:Pe(9,29),black:Pe(30,39),red:Pe(31,39),green:Pe(32,39),yellow:Pe(33,39),blue:Pe(34,39),magenta:Pe(35,39),cyan:Pe(36,39),white:Pe(37,39),gray:Pe(90,39),bgBlack:Pe(40,49),bgRed:Pe(41,49),bgGreen:Pe(42,49),bgYellow:Pe(43,49),bgBlue:Pe(44,49),bgMagenta:Pe(45,49),bgCyan:Pe(46,49),bgWhite:Pe(47,49),blackBright:Pe(90,39),redBright:Pe(91,39),greenBright:Pe(92,39),yellowBright:Pe(93,39),blueBright:Pe(94,39),magentaBright:Pe(95,39),cyanBright:Pe(96,39),whiteBright:Pe(97,39),bgBlackBright:Pe(100,49),bgRedBright:Pe(101,49),bgGreenBright:Pe(102,49),bgYellowBright:Pe(103,49),bgBlueBright:Pe(104,49),bgMagentaBright:Pe(105,49),bgCyanBright:Pe(106,49),bgWhiteBright:Pe(107,49)},np=({useColor:r=tp}={})=>r?fd:Object.keys(fd).reduce((e,t)=>({...e,[t]:String}),{}),{reset:nx,bold:sx,dim:ix,italic:ax,underline:ox,inverse:cx,hidden:ux,strikethrough:lx,black:fx,red:dx,green:hx,yellow:mx,blue:px,magenta:gx,cyan:yx,white:bx,gray:wx,bgBlack:vx,bgRed:Ex,bgGreen:Sx,bgYellow:Ax,bgBlue:_x,bgMagenta:Bx,bgCyan:Tx,bgWhite:xx,blackBright:Ix,redBright:Ox,greenBright:Rx,yellowBright:Fx,blueBright:Cx,magentaBright:Px,cyanBright:Nx,whiteBright:kx,bgBlackBright:Lx,bgRedBright:$x,bgGreenBright:Hx,bgYellowBright:Dx,bgBlueBright:Mx,bgMagentaBright:Ux,bgCyanBright:jx,bgWhiteBright:Zx}=np(),sp=Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]";function Kl(r,e,t,n="Array size exceeds target length"){if(r.length>t)throw new Error(n);return[...r,...Array(t-r.length).fill(e)]}function zx(r,e){return[...Array(r).keys()].map(t=>e(t))}async function ip(r,e){return await Promise.all(Array(r).fill(0).map((n,s)=>e(s)))}function $r(r){return r.filter(e=>e&&("isZero"in e?!e.isZero():!e.isEmpty())).map(e=>e.toBuffer().length).reduce((e,t)=>e+t,0)}function Jv(r){return r.filter(e=>e!==void 0)}var dd={};function Qv(r,e,t,n){let s;if(r&&(s=dd[r]),s===void 0&&n&&n.length>0)for(const i of n){const a=dd[i];if(a!==void 0){s=a;break}}return s!==void 0?e?e(s):s:t}function eE(r){const e={};for(const t in r){const{env:n,parseEnv:s,defaultValue:i,nested:a,fallback:o}=r[t];a?e[t]=eE(a):e[t]=Qv(n,s,i,o)}return e}function Vx(r){return{parseEnv:e=>tE(e,r),defaultValue:r}}function qx(r=!1){const e=t=>typeof t=="boolean"?t:Ga(t);return{parseEnv:e,parseVal:e,defaultValue:r,isBoolean:!0}}function Ga(r){return r!==void 0&&["1","true","TRUE"].includes(r)}function tE(r,e){const t=parseInt(r,10);return Number.isSafeInteger(t)?t:e}const rE="logging.googleapis.com/trace",nE="logging.googleapis.com/spanId",sE="logging.googleapis.com/trace_sampled",iE={messageKey:"message",timestamp(){return`,"timestamp":"${new Date(Date.now()).toISOString()}"`},formatters:{log(r){const{trace_id:e,span_id:t,trace_flags:n,...s}=r;return e&&t?{[rE]:e,[nE]:t,[sE]:n?n==="01":void 0,trace_flags:n,...s}:r},level(r,e){let t;switch(r){case"trace":case"debug":t="DEBUG";break;case"verbose":case"info":t="INFO";break;case"warn":t="WARNING";break;case"error":t="ERROR";break;case"fatal":t="CRITICAL";break;default:t="DEFAULT";break}return{severity:t,level:e}}}},aE=["silent","fatal","error","warn","info","verbose","debug","trace"];function oE(r,e){for(const[t,n]of r)try{if(new RegExp(t).test(e))return n}catch{if(e.startsWith(t))return n}}function ap(r){if(!aE.includes(r))throw new Error(`Invalid log level: ${r}`)}function cE(r,e){if(!r)return[e,[]];const[t]=r.split(";",1);return ap(t),[t,uE(r.slice(t.length+1))]}function uE(r){if(!r)return[];const e=r.split(";"),t=[];for(const n of e){const[s]=n.split(":",1),i=n.slice(s.length+1);if(!i||!s)throw new Error(`Invalid log filter statement: ${n}`);const a=s.trim().toLowerCase();ap(a);for(const o of i.split(","))t.push([o.trim().toLowerCase().replace(/^aztec:/,""),a])}return t.reverse()}var Js={};function Fs(r){r=dE.reduce((n,s)=>s(n),r.replace(/^aztec:/,""));const e=hp.child({module:r},{level:oE(op,r)}),t=(n,s,i)=>hd(e,n)&&e[n](fE(i??{}),s);return{silent:()=>{},fatal:(n,s,i)=>t("fatal",pd(n,s),i),error:(n,s,i)=>t("error",pd(n,s),i),warn:(n,s)=>t("warn",n,s),info:(n,s)=>t("info",n,s),verbose:(n,s)=>t("verbose",n,s),debug:(n,s)=>t("debug",n,s),trace:(n,s)=>t("trace",n,s),level:e.level,isLevelEnabled:n=>hd(e,n),module:r}}const lE=[];function fE(r){return lE.reduce((e,t)=>t(e),r)}const dE=[];function hd(r,e){return typeof r.isLevelEnabled=="function"?r.isLevelEnabled(e):r.levels.values[e]>=r.levels.values[r.level]}const hE="info",[pl,op]=cE(Js.LOG_LEVEL,hE),gl={verbose:25},cp=Ga(Js.USE_GCLOUD_LOGGING),aa=["validatorPrivateKey","publisherPrivateKey","peerIdPrivateKey","l1PrivateKey","senderPrivateKey","l1ConsensusHostApiKeys","privateKey","mnemonic","l1Mnemonic","l1PrivateKey"],du={customLevels:gl,messageKey:"msg",useOnlyCustomLevels:!1,level:pl,redact:{paths:[...aa,...aa.map(r=>`config.${r}`),...aa.map(r=>`cfg.${r}`),...aa.map(r=>`options.${r}`),...aa.map(r=>`opts.${r}`)]},...cp?iE:{}},up={labels:{...bs.levels.labels,...Object.fromEntries(Object.entries(gl).map(r=>r.reverse()))},values:{...bs.levels.values,...gl}},md=Js.FORCE_COLOR,lp=md===void 0?tp:Ga(md),{bold:mE,reset:pE}=np({useColor:lp}),gE={destination:2,sync:!0,colorize:lp,ignore:"module,pid,hostname,trace_id,span_id,trace_flags,severity",messageFormat:`${mE("{module}")} ${pE("{msg}")}`,customLevels:"fatal:60,error:50,warn:40,info:30,verbose:25,debug:20,trace:10",customColors:"fatal:bgRed,error:red,warn:yellow,info:green,verbose:magenta,debug:blue,trace:gray",minimumLevel:"trace",singleLine:!Ga(Js.LOG_MULTILINE)},yE={target:"pino-pretty",options:gE,level:"trace"},bE={target:"pino/file",options:{destination:2},level:"trace"},fp=Js.OTEL_EXPORTER_OTLP_LOGS_ENDPOINT,dp=!!fp&&!cp,wE={levels:up},vE={target:"@aztec/telemetry-client/otel-pino-stream",options:wE,level:"trace"};function EE(){if(sp){if(Js.JEST_WORKER_ID)return bs(du,bs.destination(2));{const r=Jv([Ga(Js.LOG_JSON)?bE:yE,dp?vE:void 0]);return bs(du,bs.transport({targets:r,levels:up.values}))}}else return bs({...du,browser:{asObject:!1}})}const hp=EE();hp.verbose({module:"logger",...op.reduce((r,[e,t])=>({...r,[`log.${e}`]:t}),{})},sp?`Logger initialized with level ${pl}`+(dp?` with OTLP exporter to ${fp}`:""):`Browser console logger initialized with level ${pl}`);function pd(r,e){return e?`${r}: ${ue.inspect(e)}`:r}var gd={};const zs=class zs{constructor(e,t=Fs("foundation:randomness_singleton")){u(this,"seed");u(this,"log");u(this,"counter");this.seed=e,this.log=t,this.counter=0,e!==void 0?(this.log.debug(`Using pseudo-randomness with seed: ${e}`),this.counter=e):this.log.debug("Using true randomness")}static getInstance(){if(!zs.instance){const e=gd.SEED?Number(gd.SEED):void 0;zs.instance=new zs(e)}return zs.instance}isDeterministic(){return this.seed!==void 0}getBytes(e){if(this.seed===void 0)throw new Error("RandomnessSingleton is not implemented for non-deterministic mode");const t=Buffer.alloc(e);for(let n=0;n<e;n++)t[n]=this.counter>>n*8&255;return this.counter++,t}};u(zs,"instance");let yl=zs;const Wr=r=>{const e=yl.getInstance();return e.isDeterministic()?e.getBytes(r):Buffer.from(ja(r))},Yl=r=>{const e=Wr(6);return parseInt(e.toString("hex"),16)%r},SE=()=>Wr(1)[0]%2===0;var We;(function(r){r.assertEqual=s=>{};function e(s){}r.assertIs=e;function t(s){throw new Error}r.assertNever=t,r.arrayToEnum=s=>{const i={};for(const a of s)i[a]=a;return i},r.getValidEnumValues=s=>{const i=r.objectKeys(s).filter(o=>typeof s[s[o]]!="number"),a={};for(const o of i)a[o]=s[o];return r.objectValues(a)},r.objectValues=s=>r.objectKeys(s).map(function(i){return s[i]}),r.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const a in s)Object.prototype.hasOwnProperty.call(s,a)&&i.push(a);return i},r.find=(s,i)=>{for(const a of s)if(i(a))return a},r.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&Number.isFinite(s)&&Math.floor(s)===s;function n(s,i=" | "){return s.map(a=>typeof a=="string"?`'${a}'`:a).join(i)}r.joinValues=n,r.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(We||(We={}));var yd;(function(r){r.mergeShapes=(e,t)=>({...e,...t})})(yd||(yd={}));const de=We.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ps=r=>{switch(typeof r){case"undefined":return de.undefined;case"string":return de.string;case"number":return Number.isNaN(r)?de.nan:de.number;case"boolean":return de.boolean;case"function":return de.function;case"bigint":return de.bigint;case"symbol":return de.symbol;case"object":return Array.isArray(r)?de.array:r===null?de.null:r.then&&typeof r.then=="function"&&r.catch&&typeof r.catch=="function"?de.promise:typeof Map<"u"&&r instanceof Map?de.map:typeof Set<"u"&&r instanceof Set?de.set:typeof Date<"u"&&r instanceof Date?de.date:de.object;default:return de.unknown}},G=We.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class qr extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(i){return i.message},n={_errors:[]},s=i=>{for(const a of i.issues)if(a.code==="invalid_union")a.unionErrors.map(s);else if(a.code==="invalid_return_type")s(a.returnTypeError);else if(a.code==="invalid_arguments")s(a.argumentsError);else if(a.path.length===0)n._errors.push(t(a));else{let o=n,c=0;for(;c<a.path.length;){const f=a.path[c];c===a.path.length-1?(o[f]=o[f]||{_errors:[]},o[f]._errors.push(t(a))):o[f]=o[f]||{_errors:[]},o=o[f],c++}}};return s(this),n}static assert(e){if(!(e instanceof qr))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,We.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},n=[];for(const s of this.issues)s.path.length>0?(t[s.path[0]]=t[s.path[0]]||[],t[s.path[0]].push(e(s))):n.push(e(s));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}qr.create=r=>new qr(r);const Fa=(r,e)=>{let t;switch(r.code){case G.invalid_type:r.received===de.undefined?t="Required":t=`Expected ${r.expected}, received ${r.received}`;break;case G.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(r.expected,We.jsonStringifyReplacer)}`;break;case G.unrecognized_keys:t=`Unrecognized key(s) in object: ${We.joinValues(r.keys,", ")}`;break;case G.invalid_union:t="Invalid input";break;case G.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${We.joinValues(r.options)}`;break;case G.invalid_enum_value:t=`Invalid enum value. Expected ${We.joinValues(r.options)}, received '${r.received}'`;break;case G.invalid_arguments:t="Invalid function arguments";break;case G.invalid_return_type:t="Invalid function return type";break;case G.invalid_date:t="Invalid date";break;case G.invalid_string:typeof r.validation=="object"?"includes"in r.validation?(t=`Invalid input: must include "${r.validation.includes}"`,typeof r.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${r.validation.position}`)):"startsWith"in r.validation?t=`Invalid input: must start with "${r.validation.startsWith}"`:"endsWith"in r.validation?t=`Invalid input: must end with "${r.validation.endsWith}"`:We.assertNever(r.validation):r.validation!=="regex"?t=`Invalid ${r.validation}`:t="Invalid";break;case G.too_small:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at least":"more than"} ${r.minimum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at least":"over"} ${r.minimum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${r.minimum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(r.minimum))}`:t="Invalid input";break;case G.too_big:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at most":"less than"} ${r.maximum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at most":"under"} ${r.maximum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="bigint"?t=`BigInt must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly":r.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(r.maximum))}`:t="Invalid input";break;case G.custom:t="Invalid input";break;case G.invalid_intersection_types:t="Intersection results could not be merged";break;case G.not_multiple_of:t=`Number must be a multiple of ${r.multipleOf}`;break;case G.not_finite:t="Number must be finite";break;default:t=e.defaultError,We.assertNever(r)}return{message:t}};let AE=Fa;function bl(){return AE}const wl=r=>{const{data:e,path:t,errorMaps:n,issueData:s}=r,i=[...t,...s.path||[]],a={...s,path:i};if(s.message!==void 0)return{...s,path:i,message:s.message};let o="";const c=n.filter(f=>!!f).slice().reverse();for(const f of c)o=f(a,{data:e,defaultError:o}).message;return{...s,path:i,message:o}};function ce(r,e){const t=bl(),n=wl({issueData:e,data:r.data,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,t,t===Fa?void 0:Fa].filter(s=>!!s)});r.common.issues.push(n)}class rr{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const s of t){if(s.status==="aborted")return Be;s.status==="dirty"&&e.dirty(),n.push(s.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const s of t){const i=await s.key,a=await s.value;n.push({key:i,value:a})}return rr.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const s of t){const{key:i,value:a}=s;if(i.status==="aborted"||a.status==="aborted")return Be;i.status==="dirty"&&e.dirty(),a.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof a.value<"u"||s.alwaysSet)&&(n[i.value]=a.value)}return{status:e.value,value:n}}}const Be=Object.freeze({status:"aborted"}),fa=r=>({status:"dirty",value:r}),nr=r=>({status:"valid",value:r}),bd=r=>r.status==="aborted",wd=r=>r.status==="dirty",Ui=r=>r.status==="valid",Wo=r=>typeof Promise<"u"&&r instanceof Promise;var be;(function(r){r.errToObj=e=>typeof e=="string"?{message:e}:e||{},r.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(be||(be={}));class Nn{constructor(e,t,n,s){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const vd=(r,e)=>{if(Ui(e))return{success:!0,data:e.value};if(!r.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new qr(r.common.issues);return this._error=t,this._error}}};function Re(r){if(!r)return{};const{errorMap:e,invalid_type_error:t,required_error:n,description:s}=r;if(e&&(t||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(a,o)=>{const{message:c}=r;return a.code==="invalid_enum_value"?{message:c??o.defaultError}:typeof o.data>"u"?{message:c??n??o.defaultError}:a.code!=="invalid_type"?{message:o.defaultError}:{message:c??t??o.defaultError}},description:s}}class $e{get description(){return this._def.description}_getType(e){return ps(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:ps(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new rr,ctx:{common:e.parent.common,data:e.data,parsedType:ps(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(Wo(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){const n={common:{issues:[],async:(t==null?void 0:t.async)??!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ps(e)},s=this._parseSync({data:e,path:n.path,parent:n});return vd(n,s)}"~validate"(e){var n,s;const t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ps(e)};if(!this["~standard"].async)try{const i=this._parseSync({data:e,path:[],parent:t});return Ui(i)?{value:i.value}:{issues:t.common.issues}}catch(i){(s=(n=i==null?void 0:i.message)==null?void 0:n.toLowerCase())!=null&&s.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(i=>Ui(i)?{value:i.value}:{issues:t.common.issues})}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ps(e)},s=this._parse({data:e,path:n.path,parent:n}),i=await(Wo(s)?s:Promise.resolve(s));return vd(n,i)}refine(e,t){const n=s=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(s):t;return this._refinement((s,i)=>{const a=e(s),o=()=>i.addIssue({code:G.custom,...n(s)});return typeof Promise<"u"&&a instanceof Promise?a.then(c=>c?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(e,t){return this._refinement((n,s)=>e(n)?!0:(s.addIssue(typeof t=="function"?t(n,s):t),!1))}_refinement(e){return new ri({schema:this,typeName:_e.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return _n.create(this,this._def)}nullable(){return ni.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return An.create(this)}promise(){return Pa.create(this,this._def)}or(e){return Yo.create([this,e],this._def)}and(e){return Xo.create(this,e,this._def)}transform(e){return new ri({...Re(this._def),schema:this,typeName:_e.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new rc({...Re(this._def),innerType:this,defaultValue:t,typeName:_e.ZodDefault})}brand(){return new yp({typeName:_e.ZodBranded,type:this,...Re(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new nc({...Re(this._def),innerType:this,catchValue:t,typeName:_e.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return Jl.create(this,e)}readonly(){return sc.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const _E=/^c[^\s-]{8,}$/i,BE=/^[0-9a-z]+$/,TE=/^[0-9A-HJKMNP-TV-Z]{26}$/i,xE=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,IE=/^[a-z0-9_-]{21}$/i,OE=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,RE=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,FE=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,CE="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let hu;const PE=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,NE=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,kE=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,LE=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,$E=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,HE=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,mp="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",DE=new RegExp(`^${mp}$`);function pp(r){let e="[0-5]\\d";r.precision?e=`${e}\\.\\d{${r.precision}}`:r.precision==null&&(e=`${e}(\\.\\d+)?`);const t=r.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${t}`}function ME(r){return new RegExp(`^${pp(r)}$`)}function UE(r){let e=`${mp}T${pp(r)}`;const t=[];return t.push(r.local?"Z?":"Z"),r.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function jE(r,e){return!!((e==="v4"||!e)&&PE.test(r)||(e==="v6"||!e)&&kE.test(r))}function ZE(r,e){if(!OE.test(r))return!1;try{const[t]=r.split("."),n=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),s=JSON.parse(atob(n));return!(typeof s!="object"||s===null||"typ"in s&&(s==null?void 0:s.typ)!=="JWT"||!s.alg||e&&s.alg!==e)}catch{return!1}}function zE(r,e){return!!((e==="v4"||!e)&&NE.test(r)||(e==="v6"||!e)&&LE.test(r))}class wn extends $e{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==de.string){const i=this._getOrReturnCtx(e);return ce(i,{code:G.invalid_type,expected:de.string,received:i.parsedType}),Be}const n=new rr;let s;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(s=this._getOrReturnCtx(e,s),ce(s,{code:G.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")e.data.length>i.value&&(s=this._getOrReturnCtx(e,s),ce(s,{code:G.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){const a=e.data.length>i.value,o=e.data.length<i.value;(a||o)&&(s=this._getOrReturnCtx(e,s),a?ce(s,{code:G.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&ce(s,{code:G.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")FE.test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"email",code:G.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")hu||(hu=new RegExp(CE,"u")),hu.test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"emoji",code:G.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")xE.test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"uuid",code:G.invalid_string,message:i.message}),n.dirty());else if(i.kind==="nanoid")IE.test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"nanoid",code:G.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")_E.test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"cuid",code:G.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")BE.test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"cuid2",code:G.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")TE.test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"ulid",code:G.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),ce(s,{validation:"url",code:G.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"regex",code:G.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(e,s),ce(s,{code:G.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(s=this._getOrReturnCtx(e,s),ce(s,{code:G.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(s=this._getOrReturnCtx(e,s),ce(s,{code:G.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?UE(i).test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{code:G.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="date"?DE.test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{code:G.invalid_string,validation:"date",message:i.message}),n.dirty()):i.kind==="time"?ME(i).test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{code:G.invalid_string,validation:"time",message:i.message}),n.dirty()):i.kind==="duration"?RE.test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"duration",code:G.invalid_string,message:i.message}),n.dirty()):i.kind==="ip"?jE(e.data,i.version)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"ip",code:G.invalid_string,message:i.message}),n.dirty()):i.kind==="jwt"?ZE(e.data,i.alg)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"jwt",code:G.invalid_string,message:i.message}),n.dirty()):i.kind==="cidr"?zE(e.data,i.version)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"cidr",code:G.invalid_string,message:i.message}),n.dirty()):i.kind==="base64"?$E.test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"base64",code:G.invalid_string,message:i.message}),n.dirty()):i.kind==="base64url"?HE.test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"base64url",code:G.invalid_string,message:i.message}),n.dirty()):We.assertNever(i);return{status:n.value,value:e.data}}_regex(e,t,n){return this.refinement(s=>e.test(s),{validation:t,code:G.invalid_string,...be.errToObj(n)})}_addCheck(e){return new wn({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...be.errToObj(e)})}url(e){return this._addCheck({kind:"url",...be.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...be.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...be.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...be.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...be.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...be.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...be.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...be.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...be.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...be.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...be.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...be.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(e==null?void 0:e.offset)??!1,local:(e==null?void 0:e.local)??!1,...be.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...be.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...be.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...be.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t==null?void 0:t.position,...be.errToObj(t==null?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...be.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...be.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...be.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...be.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...be.errToObj(t)})}nonempty(e){return this.min(1,be.errToObj(e))}trim(){return new wn({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new wn({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new wn({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}wn.create=r=>new wn({checks:[],typeName:_e.ZodString,coerce:(r==null?void 0:r.coerce)??!1,...Re(r)});function VE(r,e){const t=(r.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,s=t>n?t:n,i=Number.parseInt(r.toFixed(s).replace(".","")),a=Number.parseInt(e.toFixed(s).replace(".",""));return i%a/10**s}class Qs extends $e{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==de.number){const i=this._getOrReturnCtx(e);return ce(i,{code:G.invalid_type,expected:de.number,received:i.parsedType}),Be}let n;const s=new rr;for(const i of this._def.checks)i.kind==="int"?We.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),ce(n,{code:G.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),ce(n,{code:G.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),ce(n,{code:G.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?VE(e.data,i.value)!==0&&(n=this._getOrReturnCtx(e,n),ce(n,{code:G.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),ce(n,{code:G.not_finite,message:i.message}),s.dirty()):We.assertNever(i);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,be.toString(t))}gt(e,t){return this.setLimit("min",e,!1,be.toString(t))}lte(e,t){return this.setLimit("max",e,!0,be.toString(t))}lt(e,t){return this.setLimit("max",e,!1,be.toString(t))}setLimit(e,t,n,s){return new Qs({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:be.toString(s)}]})}_addCheck(e){return new Qs({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:be.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:be.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:be.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:be.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:be.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:be.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:be.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:be.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:be.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&We.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(t===null||n.value>t)&&(t=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}Qs.create=r=>new Qs({checks:[],typeName:_e.ZodNumber,coerce:(r==null?void 0:r.coerce)||!1,...Re(r)});class ei extends $e{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==de.bigint)return this._getInvalidInput(e);let n;const s=new rr;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),ce(n,{code:G.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),ce(n,{code:G.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),ce(n,{code:G.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):We.assertNever(i);return{status:s.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return ce(t,{code:G.invalid_type,expected:de.bigint,received:t.parsedType}),Be}gte(e,t){return this.setLimit("min",e,!0,be.toString(t))}gt(e,t){return this.setLimit("min",e,!1,be.toString(t))}lte(e,t){return this.setLimit("max",e,!0,be.toString(t))}lt(e,t){return this.setLimit("max",e,!1,be.toString(t))}setLimit(e,t,n,s){return new ei({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:be.toString(s)}]})}_addCheck(e){return new ei({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:be.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:be.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:be.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:be.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:be.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}ei.create=r=>new ei({checks:[],typeName:_e.ZodBigInt,coerce:(r==null?void 0:r.coerce)??!1,...Re(r)});class Go extends $e{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==de.boolean){const n=this._getOrReturnCtx(e);return ce(n,{code:G.invalid_type,expected:de.boolean,received:n.parsedType}),Be}return nr(e.data)}}Go.create=r=>new Go({typeName:_e.ZodBoolean,coerce:(r==null?void 0:r.coerce)||!1,...Re(r)});class ji extends $e{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==de.date){const i=this._getOrReturnCtx(e);return ce(i,{code:G.invalid_type,expected:de.date,received:i.parsedType}),Be}if(Number.isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return ce(i,{code:G.invalid_date}),Be}const n=new rr;let s;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(s=this._getOrReturnCtx(e,s),ce(s,{code:G.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(s=this._getOrReturnCtx(e,s),ce(s,{code:G.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):We.assertNever(i);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new ji({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:be.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:be.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}ji.create=r=>new ji({checks:[],coerce:(r==null?void 0:r.coerce)||!1,typeName:_e.ZodDate,...Re(r)});class Ed extends $e{_parse(e){if(this._getType(e)!==de.symbol){const n=this._getOrReturnCtx(e);return ce(n,{code:G.invalid_type,expected:de.symbol,received:n.parsedType}),Be}return nr(e.data)}}Ed.create=r=>new Ed({typeName:_e.ZodSymbol,...Re(r)});class Ko extends $e{_parse(e){if(this._getType(e)!==de.undefined){const n=this._getOrReturnCtx(e);return ce(n,{code:G.invalid_type,expected:de.undefined,received:n.parsedType}),Be}return nr(e.data)}}Ko.create=r=>new Ko({typeName:_e.ZodUndefined,...Re(r)});class vl extends $e{_parse(e){if(this._getType(e)!==de.null){const n=this._getOrReturnCtx(e);return ce(n,{code:G.invalid_type,expected:de.null,received:n.parsedType}),Be}return nr(e.data)}}vl.create=r=>new vl({typeName:_e.ZodNull,...Re(r)});class El extends $e{constructor(){super(...arguments),this._any=!0}_parse(e){return nr(e.data)}}El.create=r=>new El({typeName:_e.ZodAny,...Re(r)});class Ri extends $e{constructor(){super(...arguments),this._unknown=!0}_parse(e){return nr(e.data)}}Ri.create=r=>new Ri({typeName:_e.ZodUnknown,...Re(r)});class Rs extends $e{_parse(e){const t=this._getOrReturnCtx(e);return ce(t,{code:G.invalid_type,expected:de.never,received:t.parsedType}),Be}}Rs.create=r=>new Rs({typeName:_e.ZodNever,...Re(r)});class Sl extends $e{_parse(e){if(this._getType(e)!==de.undefined){const n=this._getOrReturnCtx(e);return ce(n,{code:G.invalid_type,expected:de.void,received:n.parsedType}),Be}return nr(e.data)}}Sl.create=r=>new Sl({typeName:_e.ZodVoid,...Re(r)});class An extends $e{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),s=this._def;if(t.parsedType!==de.array)return ce(t,{code:G.invalid_type,expected:de.array,received:t.parsedType}),Be;if(s.exactLength!==null){const a=t.data.length>s.exactLength.value,o=t.data.length<s.exactLength.value;(a||o)&&(ce(t,{code:a?G.too_big:G.too_small,minimum:o?s.exactLength.value:void 0,maximum:a?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),n.dirty())}if(s.minLength!==null&&t.data.length<s.minLength.value&&(ce(t,{code:G.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),n.dirty()),s.maxLength!==null&&t.data.length>s.maxLength.value&&(ce(t,{code:G.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map((a,o)=>s.type._parseAsync(new Nn(t,a,t.path,o)))).then(a=>rr.mergeArray(n,a));const i=[...t.data].map((a,o)=>s.type._parseSync(new Nn(t,a,t.path,o)));return rr.mergeArray(n,i)}get element(){return this._def.type}min(e,t){return new An({...this._def,minLength:{value:e,message:be.toString(t)}})}max(e,t){return new An({...this._def,maxLength:{value:e,message:be.toString(t)}})}length(e,t){return new An({...this._def,exactLength:{value:e,message:be.toString(t)}})}nonempty(e){return this.min(1,e)}}An.create=(r,e)=>new An({type:r,minLength:null,maxLength:null,exactLength:null,typeName:_e.ZodArray,...Re(e)});function mi(r){if(r instanceof _t){const e={};for(const t in r.shape){const n=r.shape[t];e[t]=_n.create(mi(n))}return new _t({...r._def,shape:()=>e})}else return r instanceof An?new An({...r._def,type:mi(r.element)}):r instanceof _n?_n.create(mi(r.unwrap())):r instanceof ni?ni.create(mi(r.unwrap())):r instanceof ss?ss.create(r.items.map(e=>mi(e))):r}class _t extends $e{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=We.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==de.object){const f=this._getOrReturnCtx(e);return ce(f,{code:G.invalid_type,expected:de.object,received:f.parsedType}),Be}const{status:n,ctx:s}=this._processInputParams(e),{shape:i,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof Rs&&this._def.unknownKeys==="strip"))for(const f in s.data)a.includes(f)||o.push(f);const c=[];for(const f of a){const h=i[f],d=s.data[f];c.push({key:{status:"valid",value:f},value:h._parse(new Nn(s,d,s.path,f)),alwaysSet:f in s.data})}if(this._def.catchall instanceof Rs){const f=this._def.unknownKeys;if(f==="passthrough")for(const h of o)c.push({key:{status:"valid",value:h},value:{status:"valid",value:s.data[h]}});else if(f==="strict")o.length>0&&(ce(s,{code:G.unrecognized_keys,keys:o}),n.dirty());else if(f!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const f=this._def.catchall;for(const h of o){const d=s.data[h];c.push({key:{status:"valid",value:h},value:f._parse(new Nn(s,d,s.path,h)),alwaysSet:h in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const f=[];for(const h of c){const d=await h.key,v=await h.value;f.push({key:d,value:v,alwaysSet:h.alwaysSet})}return f}).then(f=>rr.mergeObjectSync(n,f)):rr.mergeObjectSync(n,c)}get shape(){return this._def.shape()}strict(e){return be.errToObj,new _t({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,n)=>{var i,a;const s=((a=(i=this._def).errorMap)==null?void 0:a.call(i,t,n).message)??n.defaultError;return t.code==="unrecognized_keys"?{message:be.errToObj(e).message??s}:{message:s}}}:{}})}strip(){return new _t({...this._def,unknownKeys:"strip"})}passthrough(){return new _t({...this._def,unknownKeys:"passthrough"})}extend(e){return new _t({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new _t({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:_e.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new _t({...this._def,catchall:e})}pick(e){const t={};for(const n of We.objectKeys(e))e[n]&&this.shape[n]&&(t[n]=this.shape[n]);return new _t({...this._def,shape:()=>t})}omit(e){const t={};for(const n of We.objectKeys(this.shape))e[n]||(t[n]=this.shape[n]);return new _t({...this._def,shape:()=>t})}deepPartial(){return mi(this)}partial(e){const t={};for(const n of We.objectKeys(this.shape)){const s=this.shape[n];e&&!e[n]?t[n]=s:t[n]=s.optional()}return new _t({...this._def,shape:()=>t})}required(e){const t={};for(const n of We.objectKeys(this.shape))if(e&&!e[n])t[n]=this.shape[n];else{let i=this.shape[n];for(;i instanceof _n;)i=i._def.innerType;t[n]=i}return new _t({...this._def,shape:()=>t})}keyof(){return gp(We.objectKeys(this.shape))}}_t.create=(r,e)=>new _t({shape:()=>r,unknownKeys:"strip",catchall:Rs.create(),typeName:_e.ZodObject,...Re(e)});_t.strictCreate=(r,e)=>new _t({shape:()=>r,unknownKeys:"strict",catchall:Rs.create(),typeName:_e.ZodObject,...Re(e)});_t.lazycreate=(r,e)=>new _t({shape:r,unknownKeys:"strip",catchall:Rs.create(),typeName:_e.ZodObject,...Re(e)});class Yo extends $e{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;function s(i){for(const o of i)if(o.result.status==="valid")return o.result;for(const o of i)if(o.result.status==="dirty")return t.common.issues.push(...o.ctx.common.issues),o.result;const a=i.map(o=>new qr(o.ctx.common.issues));return ce(t,{code:G.invalid_union,unionErrors:a}),Be}if(t.common.async)return Promise.all(n.map(async i=>{const a={...t,common:{...t.common,issues:[]},parent:null};return{result:await i._parseAsync({data:t.data,path:t.path,parent:a}),ctx:a}})).then(s);{let i;const a=[];for(const c of n){const f={...t,common:{...t.common,issues:[]},parent:null},h=c._parseSync({data:t.data,path:t.path,parent:f});if(h.status==="valid")return h;h.status==="dirty"&&!i&&(i={result:h,ctx:f}),f.common.issues.length&&a.push(f.common.issues)}if(i)return t.common.issues.push(...i.ctx.common.issues),i.result;const o=a.map(c=>new qr(c));return ce(t,{code:G.invalid_union,unionErrors:o}),Be}}get options(){return this._def.options}}Yo.create=(r,e)=>new Yo({options:r,typeName:_e.ZodUnion,...Re(e)});const Zn=r=>r instanceof Qo?Zn(r.schema):r instanceof ri?Zn(r.innerType()):r instanceof ec?[r.value]:r instanceof ti?r.options:r instanceof tc?We.objectValues(r.enum):r instanceof rc?Zn(r._def.innerType):r instanceof Ko?[void 0]:r instanceof vl?[null]:r instanceof _n?[void 0,...Zn(r.unwrap())]:r instanceof ni?[null,...Zn(r.unwrap())]:r instanceof yp||r instanceof sc?Zn(r.unwrap()):r instanceof nc?Zn(r._def.innerType):[];class Xl extends $e{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==de.object)return ce(t,{code:G.invalid_type,expected:de.object,received:t.parsedType}),Be;const n=this.discriminator,s=t.data[n],i=this.optionsMap.get(s);return i?t.common.async?i._parseAsync({data:t.data,path:t.path,parent:t}):i._parseSync({data:t.data,path:t.path,parent:t}):(ce(t,{code:G.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),Be)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){const s=new Map;for(const i of t){const a=Zn(i.shape[e]);if(!a.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const o of a){if(s.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);s.set(o,i)}}return new Xl({typeName:_e.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:s,...Re(n)})}}function Al(r,e){const t=ps(r),n=ps(e);if(r===e)return{valid:!0,data:r};if(t===de.object&&n===de.object){const s=We.objectKeys(e),i=We.objectKeys(r).filter(o=>s.indexOf(o)!==-1),a={...r,...e};for(const o of i){const c=Al(r[o],e[o]);if(!c.valid)return{valid:!1};a[o]=c.data}return{valid:!0,data:a}}else if(t===de.array&&n===de.array){if(r.length!==e.length)return{valid:!1};const s=[];for(let i=0;i<r.length;i++){const a=r[i],o=e[i],c=Al(a,o);if(!c.valid)return{valid:!1};s.push(c.data)}return{valid:!0,data:s}}else return t===de.date&&n===de.date&&+r==+e?{valid:!0,data:r}:{valid:!1}}class Xo extends $e{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),s=(i,a)=>{if(bd(i)||bd(a))return Be;const o=Al(i.value,a.value);return o.valid?((wd(i)||wd(a))&&t.dirty(),{status:t.value,value:o.data}):(ce(n,{code:G.invalid_intersection_types}),Be)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([i,a])=>s(i,a)):s(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}Xo.create=(r,e,t)=>new Xo({left:r,right:e,typeName:_e.ZodIntersection,...Re(t)});class ss extends $e{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==de.array)return ce(n,{code:G.invalid_type,expected:de.array,received:n.parsedType}),Be;if(n.data.length<this._def.items.length)return ce(n,{code:G.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Be;!this._def.rest&&n.data.length>this._def.items.length&&(ce(n,{code:G.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const i=[...n.data].map((a,o)=>{const c=this._def.items[o]||this._def.rest;return c?c._parse(new Nn(n,a,n.path,o)):null}).filter(a=>!!a);return n.common.async?Promise.all(i).then(a=>rr.mergeArray(t,a)):rr.mergeArray(t,i)}get items(){return this._def.items}rest(e){return new ss({...this._def,rest:e})}}ss.create=(r,e)=>{if(!Array.isArray(r))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ss({items:r,typeName:_e.ZodTuple,rest:null,...Re(e)})};class Jo extends $e{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==de.object)return ce(n,{code:G.invalid_type,expected:de.object,received:n.parsedType}),Be;const s=[],i=this._def.keyType,a=this._def.valueType;for(const o in n.data)s.push({key:i._parse(new Nn(n,o,n.path,o)),value:a._parse(new Nn(n,n.data[o],n.path,o)),alwaysSet:o in n.data});return n.common.async?rr.mergeObjectAsync(t,s):rr.mergeObjectSync(t,s)}get element(){return this._def.valueType}static create(e,t,n){return t instanceof $e?new Jo({keyType:e,valueType:t,typeName:_e.ZodRecord,...Re(n)}):new Jo({keyType:wn.create(),valueType:e,typeName:_e.ZodRecord,...Re(t)})}}class Sd extends $e{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==de.map)return ce(n,{code:G.invalid_type,expected:de.map,received:n.parsedType}),Be;const s=this._def.keyType,i=this._def.valueType,a=[...n.data.entries()].map(([o,c],f)=>({key:s._parse(new Nn(n,o,n.path,[f,"key"])),value:i._parse(new Nn(n,c,n.path,[f,"value"]))}));if(n.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const c of a){const f=await c.key,h=await c.value;if(f.status==="aborted"||h.status==="aborted")return Be;(f.status==="dirty"||h.status==="dirty")&&t.dirty(),o.set(f.value,h.value)}return{status:t.value,value:o}})}else{const o=new Map;for(const c of a){const f=c.key,h=c.value;if(f.status==="aborted"||h.status==="aborted")return Be;(f.status==="dirty"||h.status==="dirty")&&t.dirty(),o.set(f.value,h.value)}return{status:t.value,value:o}}}}Sd.create=(r,e,t)=>new Sd({valueType:e,keyType:r,typeName:_e.ZodMap,...Re(t)});class Ca extends $e{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==de.set)return ce(n,{code:G.invalid_type,expected:de.set,received:n.parsedType}),Be;const s=this._def;s.minSize!==null&&n.data.size<s.minSize.value&&(ce(n,{code:G.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),t.dirty()),s.maxSize!==null&&n.data.size>s.maxSize.value&&(ce(n,{code:G.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),t.dirty());const i=this._def.valueType;function a(c){const f=new Set;for(const h of c){if(h.status==="aborted")return Be;h.status==="dirty"&&t.dirty(),f.add(h.value)}return{status:t.value,value:f}}const o=[...n.data.values()].map((c,f)=>i._parse(new Nn(n,c,n.path,f)));return n.common.async?Promise.all(o).then(c=>a(c)):a(o)}min(e,t){return new Ca({...this._def,minSize:{value:e,message:be.toString(t)}})}max(e,t){return new Ca({...this._def,maxSize:{value:e,message:be.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}Ca.create=(r,e)=>new Ca({valueType:r,minSize:null,maxSize:null,typeName:_e.ZodSet,...Re(e)});class ga extends $e{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==de.function)return ce(t,{code:G.invalid_type,expected:de.function,received:t.parsedType}),Be;function n(o,c){return wl({data:o,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,bl(),Fa].filter(f=>!!f),issueData:{code:G.invalid_arguments,argumentsError:c}})}function s(o,c){return wl({data:o,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,bl(),Fa].filter(f=>!!f),issueData:{code:G.invalid_return_type,returnTypeError:c}})}const i={errorMap:t.common.contextualErrorMap},a=t.data;if(this._def.returns instanceof Pa){const o=this;return nr(async function(...c){const f=new qr([]),h=await o._def.args.parseAsync(c,i).catch(b=>{throw f.addIssue(n(c,b)),f}),d=await Reflect.apply(a,this,h);return await o._def.returns._def.type.parseAsync(d,i).catch(b=>{throw f.addIssue(s(d,b)),f})})}else{const o=this;return nr(function(...c){const f=o._def.args.safeParse(c,i);if(!f.success)throw new qr([n(c,f.error)]);const h=Reflect.apply(a,this,f.data),d=o._def.returns.safeParse(h,i);if(!d.success)throw new qr([s(h,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new ga({...this._def,args:ss.create(e).rest(Ri.create())})}returns(e){return new ga({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new ga({args:e||ss.create([]).rest(Ri.create()),returns:t||Ri.create(),typeName:_e.ZodFunction,...Re(n)})}}class Qo extends $e{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}Qo.create=(r,e)=>new Qo({getter:r,typeName:_e.ZodLazy,...Re(e)});class ec extends $e{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return ce(t,{received:t.data,code:G.invalid_literal,expected:this._def.value}),Be}return{status:"valid",value:e.data}}get value(){return this._def.value}}ec.create=(r,e)=>new ec({value:r,typeName:_e.ZodLiteral,...Re(e)});function gp(r,e){return new ti({values:r,typeName:_e.ZodEnum,...Re(e)})}class ti extends $e{_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),n=this._def.values;return ce(t,{expected:We.joinValues(n),received:t.parsedType,code:G.invalid_type}),Be}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const t=this._getOrReturnCtx(e),n=this._def.values;return ce(t,{received:t.data,code:G.invalid_enum_value,options:n}),Be}return nr(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return ti.create(e,{...this._def,...t})}exclude(e,t=this._def){return ti.create(this.options.filter(n=>!e.includes(n)),{...this._def,...t})}}ti.create=gp;class tc extends $e{_parse(e){const t=We.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==de.string&&n.parsedType!==de.number){const s=We.objectValues(t);return ce(n,{expected:We.joinValues(s),received:n.parsedType,code:G.invalid_type}),Be}if(this._cache||(this._cache=new Set(We.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const s=We.objectValues(t);return ce(n,{received:n.data,code:G.invalid_enum_value,options:s}),Be}return nr(e.data)}get enum(){return this._def.values}}tc.create=(r,e)=>new tc({values:r,typeName:_e.ZodNativeEnum,...Re(e)});class Pa extends $e{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==de.promise&&t.common.async===!1)return ce(t,{code:G.invalid_type,expected:de.promise,received:t.parsedType}),Be;const n=t.parsedType===de.promise?t.data:Promise.resolve(t.data);return nr(n.then(s=>this._def.type.parseAsync(s,{path:t.path,errorMap:t.common.contextualErrorMap})))}}Pa.create=(r,e)=>new Pa({type:r,typeName:_e.ZodPromise,...Re(e)});class ri extends $e{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===_e.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),s=this._def.effect||null,i={addIssue:a=>{ce(n,a),a.fatal?t.abort():t.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const a=s.transform(n.data,i);if(n.common.async)return Promise.resolve(a).then(async o=>{if(t.value==="aborted")return Be;const c=await this._def.schema._parseAsync({data:o,path:n.path,parent:n});return c.status==="aborted"?Be:c.status==="dirty"||t.value==="dirty"?fa(c.value):c});{if(t.value==="aborted")return Be;const o=this._def.schema._parseSync({data:a,path:n.path,parent:n});return o.status==="aborted"?Be:o.status==="dirty"||t.value==="dirty"?fa(o.value):o}}if(s.type==="refinement"){const a=o=>{const c=s.refinement(o,i);if(n.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?Be:(o.status==="dirty"&&t.dirty(),a(o.value),{status:t.value,value:o.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>o.status==="aborted"?Be:(o.status==="dirty"&&t.dirty(),a(o.value).then(()=>({status:t.value,value:o.value}))))}if(s.type==="transform")if(n.common.async===!1){const a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Ui(a))return Be;const o=s.transform(a.value,i);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:o}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>Ui(a)?Promise.resolve(s.transform(a.value,i)).then(o=>({status:t.value,value:o})):Be);We.assertNever(s)}}ri.create=(r,e,t)=>new ri({schema:r,typeName:_e.ZodEffects,effect:e,...Re(t)});ri.createWithPreprocess=(r,e,t)=>new ri({schema:e,effect:{type:"preprocess",transform:r},typeName:_e.ZodEffects,...Re(t)});class _n extends $e{_parse(e){return this._getType(e)===de.undefined?nr(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}_n.create=(r,e)=>new _n({innerType:r,typeName:_e.ZodOptional,...Re(e)});class ni extends $e{_parse(e){return this._getType(e)===de.null?nr(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ni.create=(r,e)=>new ni({innerType:r,typeName:_e.ZodNullable,...Re(e)});class rc extends $e{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===de.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}rc.create=(r,e)=>new rc({innerType:r,typeName:_e.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Re(e)});class nc extends $e{_parse(e){const{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},s=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Wo(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new qr(n.common.issues)},input:n.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new qr(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}nc.create=(r,e)=>new nc({innerType:r,typeName:_e.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Re(e)});class Ad extends $e{_parse(e){if(this._getType(e)!==de.nan){const n=this._getOrReturnCtx(e);return ce(n,{code:G.invalid_type,expected:de.nan,received:n.parsedType}),Be}return{status:"valid",value:e.data}}}Ad.create=r=>new Ad({typeName:_e.ZodNaN,...Re(r)});class yp extends $e{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class Jl extends $e{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?Be:i.status==="dirty"?(t.dirty(),fa(i.value)):this._def.out._parseAsync({data:i.value,path:n.path,parent:n})})();{const s=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?Be:s.status==="dirty"?(t.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:n.path,parent:n})}}static create(e,t){return new Jl({in:e,out:t,typeName:_e.ZodPipeline})}}class sc extends $e{_parse(e){const t=this._def.innerType._parse(e),n=s=>(Ui(s)&&(s.value=Object.freeze(s.value)),s);return Wo(t)?t.then(s=>n(s)):n(t)}unwrap(){return this._def.innerType}}sc.create=(r,e)=>new sc({innerType:r,typeName:_e.ZodReadonly,...Re(e)});var _e;(function(r){r.ZodString="ZodString",r.ZodNumber="ZodNumber",r.ZodNaN="ZodNaN",r.ZodBigInt="ZodBigInt",r.ZodBoolean="ZodBoolean",r.ZodDate="ZodDate",r.ZodSymbol="ZodSymbol",r.ZodUndefined="ZodUndefined",r.ZodNull="ZodNull",r.ZodAny="ZodAny",r.ZodUnknown="ZodUnknown",r.ZodNever="ZodNever",r.ZodVoid="ZodVoid",r.ZodArray="ZodArray",r.ZodObject="ZodObject",r.ZodUnion="ZodUnion",r.ZodDiscriminatedUnion="ZodDiscriminatedUnion",r.ZodIntersection="ZodIntersection",r.ZodTuple="ZodTuple",r.ZodRecord="ZodRecord",r.ZodMap="ZodMap",r.ZodSet="ZodSet",r.ZodFunction="ZodFunction",r.ZodLazy="ZodLazy",r.ZodLiteral="ZodLiteral",r.ZodEnum="ZodEnum",r.ZodEffects="ZodEffects",r.ZodNativeEnum="ZodNativeEnum",r.ZodOptional="ZodOptional",r.ZodNullable="ZodNullable",r.ZodDefault="ZodDefault",r.ZodCatch="ZodCatch",r.ZodPromise="ZodPromise",r.ZodBranded="ZodBranded",r.ZodPipeline="ZodPipeline",r.ZodReadonly="ZodReadonly"})(_e||(_e={}));const we=wn.create,se=Qs.create,mu=ei.create,et=Go.create;ji.create;const Na=Ko.create,qE=El.create;Ri.create;Rs.create;const Hr=Sl.create,ee=An.create,R=_t.create,Yt=Yo.create,Ql=Xl.create;Xo.create;const ka=ss.create,fr=Jo.create,ne=ga.create,Bn=Qo.create,st=ec.create,Ka=ti.create,Ya=tc.create;Pa.create;const WE=_n.create;ni.create;const Fi={string:r=>wn.create({...r,coerce:!0}),number:r=>Qs.create({...r,coerce:!0}),boolean:r=>Go.create({...r,coerce:!0}),bigint:r=>ei.create({...r,coerce:!0}),date:r=>ji.create({...r,coerce:!0})};function bp(r){return r.startsWith("0x")}function Xa(r){return bp(r)?r.slice(2):r}function ic(r){return/^(0x)?[0-9a-fA-F]*$/.test(r)}function dt(r){return Buffer.from(Xa(r),"hex")}function tt(r){return`0x${r.toString("hex")}`}we().refine(ic,"Not a valid hex string").transform(Xa);const GE=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,ac=we().refine(r=>r.length>1024||GE.test(r),"Not a valid base64 string").transform(r=>Buffer.from(r,"base64"));class ef extends _n{constructor(){super(...arguments);u(this,"_isNullableOptional",!0)}_parse(t){const n=this._getType(t);return n===de.undefined||n===de.null?nr(void 0):this._def.innerType._parse(t)}static create(t){return new ef({innerType:t,typeName:_e.ZodOptional})}}function at(r){return ef.create(r)}function Gr(r,e){const n=(e?we().refine(e,"Not a valid instance"):we()).refine(ic,"Not a valid hex string");return"fromString"in r?n.transform(r.fromString.bind(r)):n.transform(s=>Buffer.from(Xa(s),"hex")).transform(r.fromBuffer.bind(r))}function Ja(r){return ac.transform(r.fromBuffer.bind(r))}function Io(r,e){return ee(ka([r,e])).transform(t=>new Map(t))}var ar,Fr;const wc=class wc{constructor(e,t=0){Vc(this,ar);u(this,"buffer");u(this,"index");this.buffer=e,this.index=t}static asReader(e){if(e instanceof wc)return e;const t=Buffer.isBuffer(e)?e:Buffer.from(e.buffer,e.byteOffset,e.byteLength);return new wc(t)}isEmpty(){return this.index===this.buffer.length}readNumber(){return zt(this,ar,Fr).call(this,4),this.index+=4,this.buffer.readUint32BE(this.index-4)}readNumbers(e){return Array.from({length:e},()=>this.readNumber())}readUInt64(){zt(this,ar,Fr).call(this,8);const e=this.buffer.readBigUInt64BE(this.index);return this.index+=8,e}readUInt256(){zt(this,ar,Fr).call(this,32);let e=BigInt(0);for(let t=0;t<4;t++)e=e<<BigInt(64)|this.buffer.readBigUInt64BE(this.index+t*8);return this.index+=32,e}readUInt16(){return zt(this,ar,Fr).call(this,2),this.index+=2,this.buffer.readUInt16BE(this.index-2)}readUInt8(){return zt(this,ar,Fr).call(this,1),this.index+=1,this.buffer.readUInt8(this.index-1)}readBoolean(){return zt(this,ar,Fr).call(this,1),this.index+=1,!!this.buffer.at(this.index-1)}readBytes(e){return zt(this,ar,Fr).call(this,e),this.index+=e,Buffer.from(this.buffer.subarray(this.index-e,this.index))}readToEnd(){const e=this.buffer.subarray(this.index);return this.index=this.buffer.length,e}readNumberVector(){return this.readVector({fromBuffer:e=>e.readNumber()})}readVector(e){const t=this.readNumber(),n=new Array(t);for(let s=0;s<t;s++)n[s]=e.fromBuffer(this);return n}readVectorUint8Prefix(e){const t=this.readUInt8(),n=new Array(t);for(let s=0;s<t;s++)n[s]=e.fromBuffer(this);return n}readArray(e,t){return Array.from({length:e},()=>t.fromBuffer(this))}readBufferArray(e=-1){const t=[],n=e>=0?this.index+e:this.buffer.length;for(zt(this,ar,Fr).call(this,n-this.index);this.index<n;){const s=this.readBuffer();t.push(s)}if(this.index!==n)throw new Error(`Reader buffer was not fully consumed. Consumed up to ${this.index} bytes. End of data: ${n} bytes.`);return t}readObject(e){return e.fromBuffer(this)}peekBytes(e){return zt(this,ar,Fr).call(this,e||0),this.buffer.subarray(this.index,e?this.index+e:void 0)}readString(){return this.readBuffer().toString()}readBuffer(){const e=this.readNumber();return zt(this,ar,Fr).call(this,e),this.readBytes(e)}readUint8Array(){const e=this.readNumber();return zt(this,ar,Fr).call(this,e),this.readBytes(e)}readMap(e){const t=this.readNumber(),n={};for(let s=0;s<t;s++){const i=this.readString(),a=this.readObject(e);n[i]=a}return n}getLength(){return this.buffer.length}remainingBytes(){return this.buffer.length-this.index}};ar=new WeakSet,Fr=function(e){if(this.index+e>this.buffer.length)throw new Error(`Attempted to read beyond buffer length. Start index: ${this.index}, Num bytes to read: ${e}, Buffer length: ${this.buffer.length}`)};let J=wc;class ii{static register(e,t){this.registry.set(e,t)}static getConstructor(e){return this.registry.get(e)}}u(ii,"registry",new Map);var KE={};const YE=Buffer.alloc(32),qn=class qn{constructor(e){u(this,"asBuffer");u(this,"asBigInt");if(Buffer.isBuffer(e)){if(e.length>qn.SIZE_IN_BYTES)throw new Error(`Value length ${e.length} exceeds ${qn.SIZE_IN_BYTES}`);this.asBuffer=e.length===qn.SIZE_IN_BYTES?e:Buffer.concat([Buffer.alloc(qn.SIZE_IN_BYTES-e.length),e])}else if(typeof e=="bigint"||typeof e=="number"||typeof e=="boolean"){if(this.asBigInt=BigInt(e),this.asBigInt>=this.modulus())throw new Error(`Value 0x${this.asBigInt.toString(16)} is greater or equal to field modulus.`)}else if(e instanceof qn)this.asBuffer=e.asBuffer,this.asBigInt=e.asBigInt;else throw new Error(`Type '${typeof e}' with value '${e}' passed to BaseField ctor.`)}get value(){return this.toBigInt()}get size(){return qn.SIZE_IN_BYTES}toBuffer(){return this.asBuffer||(this.asBuffer=pr(this.asBigInt,32)),Buffer.from(this.asBuffer)}toString(){return`0x${this.toBuffer().toString("hex")}`}toBigInt(){if(this.asBigInt===void 0&&(this.asBigInt=un(this.asBuffer),this.asBigInt>=this.modulus()))throw new Error(`Value 0x${this.asBigInt.toString(16)} is greater or equal to field modulus.`);return this.asBigInt}toBool(){return!!this.toBigInt()}toNumber(){const e=this.toBigInt();if(e>Number.MAX_SAFE_INTEGER)throw new Error(`Value ${e.toString(16)} greater than than max safe integer`);return Number(e)}toNumberUnsafe(){const e=this.toBigInt();return Number(e)}toShortString(){const e=this.toString();return`${e.slice(0,10)}...${e.slice(-4)}`}equals(e){return this.toBuffer().equals(e.toBuffer())}lt(e){return this.toBigInt()<e.toBigInt()}cmp(e){const t=this.toBigInt(),n=e.toBigInt();return t===n?0:t<n?-1:1}isZero(){return this.toBuffer().equals(YE)}isEmpty(){return this.isZero()}toFriendlyJSON(){return this.toString()}toField(){return this}};u(qn,"SIZE_IN_BYTES",32);let Zi=qn;function tf(r,e){const t=J.asReader(r);return new e(t.readBytes(Zi.SIZE_IN_BYTES))}function Oc(r,e){return new e(un(r)%e.MODULUS)}function wp(r){return Oc(Wr(64),r)}function oc(r,e){var i;const n=(i=r.replace(/^0x/i,"").match(/^[0-9A-F]+$/i))==null?void 0:i[0];if(n===void 0)throw new Error(`Invalid hex-encoded string: "${r}"`);const s=Buffer.from(n.length%2===1?"0"+n:n,"hex");return new e(s)}const Ke=class Ke extends Zi{constructor(e){super(e)}[ue.inspect.custom](){return`Fr<${this.toString()}>`}modulus(){return Ke.MODULUS}static random(){return wp(Ke)}static zero(){return Ke.ZERO}static isZero(e){return e.isZero()}static fromBuffer(e){return tf(e,Ke)}static fromBufferReduce(e){return Oc(e,Ke)}static fromString(e){if(e.match(/^\d+$/)!==null)return new Ke(pr(BigInt(e),32));if(e.match(/^0x/i)!==null)return oc(e,Ke);throw new Error(`Tried to create a Fr from an invalid string: ${e}`)}static fromHexString(e){return oc(e,Ke)}add(e){return new Ke((this.toBigInt()+e.toBigInt())%Ke.MODULUS)}square(){return new Ke(this.toBigInt()*this.toBigInt()%Ke.MODULUS)}negate(){return new Ke(Ke.MODULUS-this.toBigInt())}sub(e){const t=this.toBigInt()-e.toBigInt();return new Ke(t<0?t+Ke.MODULUS:t)}mul(e){return new Ke(this.toBigInt()*e.toBigInt()%Ke.MODULUS)}div(e){if(e.isZero())throw new Error("Division by zero");const t=XE(e.toBigInt());return this.mul(t)}ediv(e){if(e.isZero())throw new Error("Division by zero");return new Ke(this.toBigInt()/e.toBigInt())}async sqrt(){const t=(await Ht.initSingleton(KE.BB_WASM_PATH)).getWasm(),[n]=t.callWasmExport("bn254_fr_sqrt",[this.toBuffer()],[Ke.SIZE_IN_BYTES+1]);return n[0]===1?new Ke(Buffer.from(n.slice(1))):null}toJSON(){return this.toString()}static get schema(){return Gr(Ke)}};u(Ke,"ZERO",new Ke(0n)),u(Ke,"ONE",new Ke(1n)),u(Ke,"MODULUS",0x30644e72e131a029b85045b68181585d2833e84879b9709143e1f593f0000001n),u(Ke,"MAX_FIELD_VALUE",new Ke(Ke.MODULUS-1n));let l=Ke;ii.register("Fr",l);const yt=class yt extends Zi{[ue.inspect.custom](){return`Fq<${this.toString()}>`}get lo(){return new l(this.toBigInt()&yt.LOW_MASK)}get hi(){return new l(this.toBigInt()>>yt.HIGH_SHIFT)}constructor(e){super(e)}modulus(){return yt.MODULUS}static random(){return wp(yt)}static zero(){return yt.ZERO}static fromBuffer(e){return tf(e,yt)}static fromBufferReduce(e){return Oc(e,yt)}static fromString(e){if(e.match(/^\d+$/)!==null)return new yt(pr(BigInt(e),32));if(e.match(/^0x/i)!==null)return oc(e,yt);throw new Error(`Tried to create a Fq from an invalid string: ${e}`)}static fromHexString(e){return oc(e,yt)}static fromHighLow(e,t){return new yt((e.toBigInt()<<yt.HIGH_SHIFT)+t.toBigInt())}add(e){return new yt((this.toBigInt()+e.toBigInt())%yt.MODULUS)}toJSON(){return this.toString()}toFields(){return[this.lo,this.hi]}static get schema(){return Gr(yt)}};u(yt,"ZERO",new yt(0n)),u(yt,"MODULUS",0x30644e72e131a029b85045b68181585d97816a916871ca8d3c208c16d87cfd47n),u(yt,"HIGH_SHIFT",BigInt(Zi.SIZE_IN_BYTES/2*8)),u(yt,"LOW_MASK",(1n<<yt.HIGH_SHIFT)-1n);let Tn=yt;ii.register("Fq",Tn);function XE(r){const[e,t,n]=vp(r,l.MODULUS);if(e!=1n)throw Error("Inverse does not exist");return new l(t>0?t:t+l.MODULUS)}function vp(r,e){if(r==0n)return[e,0n,1n];{const[t,n,s]=vp(e%r,r);return[t,s-e/r*n,n]}}const Ep=Tn;function JE(r,e){return t=>Oc(r(t),e)}function ya(r,e=4){const t=Buffer.alloc(e);return t.writeUInt32BE(r,e-4),t}function QE(r,e=8){const t=Buffer.alloc(e);return t.writeBigUInt64BE(r,e-8),t}function Wx(r,e=4){const t=Buffer.alloc(e);return t.writeInt32BE(r,e-4),t}function rf(r){const t=Buffer.alloc(1);return t.writeUInt8(r,0),t}function eS(r){const e=r.toString("hex");return e.length===0?BigInt(0):BigInt(`0x${e}`)}function Gx(r){if(r.length!==32)throw new Error("Buffer must be 32 bytes");const e=Buffer.concat([Buffer.alloc(16),r.subarray(0,16)]),t=Buffer.concat([Buffer.alloc(16),r.subarray(16,32)]);return[l.fromBuffer(e),l.fromBuffer(t)]}function tS(r){if(r.length!==32)throw new Error("Buffer to truncate must be 32 bytes");return Buffer.concat([Buffer.alloc(1),r.subarray(0,31)])}function Kx(r){if(r.length!==32&&r.length!==31)throw new Error("Buffer must be 31 or 32 bytes");if(r.length==32&&r[0]==0||r.length==31)return l.fromBuffer(r);throw new Error(`Number ${eS(r)} does not fit in 31 byte truncated buffer`)}function mn(r,e=4){const t=nf(r);let n;if(e===1)n=Buffer.alloc(1),n.writeUInt8(t.length,0);else if(e===4)n=Buffer.alloc(4),n.writeUInt32BE(t.length,0);else throw new Error(`Unsupported prefix length. Got ${e}, expected 1 or 4`);return Buffer.concat([n,...t])}function rS(r,e,t=0){let n=t;const s=e.readUInt32BE(n);n+=4;const i=new Array(s);for(let a=0;a<s;++a){const{elem:o,adv:c}=r(e,n);n+=c,i[a]=o}return{elem:i,adv:n-t}}function Sp(r,e=1){const t=Buffer.alloc(e);return t.writeUInt8(r?1:0,e-1),t}function nf(...r){var t;const e=[];for(const n of r)if(Array.isArray(n))e.push(...nf(...n));else if(Buffer.isBuffer(n))e.push(n);else if(typeof n=="boolean")e.push(Sp(n));else if(typeof n=="bigint"){if(n>BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"))throw new Error(`BigInt ${n} does not fit into 32 bytes`);e.push(Gs(n))}else if(typeof n=="number")e.push(ya(n));else if(typeof n=="string")e.push(ya(n.length)),e.push(Buffer.from(n));else if("toBuffer"in n)e.push(n.toBuffer());else throw new Error(`Cannot serialize input to buffer: ${typeof n} ${(t=n.constructor)==null?void 0:t.name}`);return e}function Je(...r){var t;const e=[];for(const n of r)if(Array.isArray(n))e.push(...Je(...n));else if(n instanceof l)e.push(n);else if(typeof n=="boolean"||typeof n=="number"||typeof n=="bigint")e.push(new l(n));else if("toFields"in n)e.push(...n.toFields());else if("toFr"in n)e.push(n.toFr());else if("toField"in n)e.push(n.toField());else if(Buffer.isBuffer(n))e.push(l.fromBuffer(n));else throw new Error(`Cannot serialize input to field: ${typeof n} ${(t=n.constructor)==null?void 0:t.name}`);return e}function le(...r){return Buffer.concat(nf(...r))}function Gs(r,e=32){return pr(r,e)}function Ap(r,e=0,t=32){return{elem:un(r.subarray(e,e+t)),adv:t}}var Rc={};async function Xi(r){const e=Je(r),n=(await Ht.initSingleton(Rc.BB_WASM_PATH)).poseidon2Hash(e.map(s=>new Ie(s.toBuffer())));return l.fromBuffer(Buffer.from(n.toBuffer()))}async function wt(r,e){const t=Je(r);t.unshift(new l(e));const s=(await Ht.initSingleton(Rc.BB_WASM_PATH)).poseidon2Hash(t.map(i=>new Ie(i.toBuffer())));return l.fromBuffer(Buffer.from(s.toBuffer()))}async function nS(r){const e=Je(r),n=(await Ht.initSingleton(Rc.BB_WASM_PATH)).poseidon2HashAccumulate(e.map(s=>new Ie(s.toBuffer())));return l.fromBuffer(Buffer.from(n.toBuffer()))}async function _p(r){const e=[];for(let s=0;s<r.length;s+=31){const i=Buffer.alloc(32,0);r.slice(s,s+31).copy(i),i.reverse(),e.push(l.fromBuffer(i))}const n=(await Ht.initSingleton(Rc.BB_WASM_PATH)).poseidon2Hash(e.map(s=>new Ie(s.toBuffer())));return l.fromBuffer(Buffer.from(n.toBuffer()))}class Ee{constructor(e,t=0){u(this,"fields");u(this,"index");u(this,"length");if(this.fields=e,this.index=t,this.length=e.length,t>this.length)throw new Error("Offset out of bounds.")}static asReader(e){return e instanceof Ee?e:new Ee(e)}get cursor(){return this.index}remainingFields(){return this.length-this.index}skip(e){if(this.index+e>this.length)throw new Error("Not enough fields to be consumed.");this.index+=e}readField(){if(this.index===this.length)throw new Error("Not enough fields to be consumed.");return this.fields[this.index++]}peekField(){if(this.index===this.length)throw new Error("Not enough fields to be consumed.");return this.fields[this.index]}readFq(){return Tn.fromHighLow(this.readField(),this.readField())}readBoolean(){const t=this.readField().toBigInt();if(t>1n)throw new Error("Field is not a boolean.");return t==1n}readU32(){const t=this.readField().toBigInt();if(t>=1n<<32n)throw new Error("Field is not a u32.");return Number(t)}readFieldArray(e){const t=[];for(let n=0;n<e;++n)t.push(this.readField());return t}readArray(e,t){return Array.from({length:e},()=>t.fromFields(this))}readObject(e){return e.fromFields(this)}isFinished(){return this.index>=this.length}}function sS(r,e){if(r.length!==e)throw new Error(`Wrong 'fixed array' size. Expected ${e}, got ${r.length}.`);return r}function iS(r,e){return r.map(e)}const Cr=class Cr{constructor(e,t,n){u(this,"x");u(this,"y");u(this,"isInfinite");u(this,"kind");this.x=e,this.y=t,this.isInfinite=n,this.kind="point"}toJSON(){return this.toString()}static get schema(){return Gr(Cr)}static async random(){for(;;)try{return await Cr.fromXAndSign(l.random(),SE())}catch(e){if(!(e instanceof _d))throw e;continue}}static fromBuffer(e){const t=J.asReader(e);return new this(l.fromBuffer(t),l.fromBuffer(t),!1)}static fromCompressedBuffer(e){const t=J.asReader(e),n=un(t.readBytes(Cr.COMPRESSED_SIZE_IN_BYTES)),s=new l(n&(1n<<255n)-1n),i=(n&1n<<255n)!==0n;return this.fromXAndSign(s,i)}static fromString(e){return this.fromBuffer(dt(e))}toFields(){return[this.x,this.y,new l(this.isInfinite)]}static fromFields(e){const t=Ee.asReader(e);return new this(t.readField(),t.readField(),t.readBoolean())}static async fromXAndSign(e,t){const n=await Cr.YFromX(e);if(n==null)throw new _d(e);const s=n.toBigInt()<=(l.MODULUS-1n)/2n?n.toBigInt():l.MODULUS-n.toBigInt(),i=l.MODULUS-s,a=t?new l(s):new l(i);return new this(e,a,!1)}static YFromX(e){return e.square().mul(e).sub(new l(17)).sqrt()}toXAndSign(){return[this.x,this.y.toBigInt()<=(l.MODULUS-1n)/2n]}toBigInts(){return{x:this.x.toBigInt(),y:this.y.toBigInt(),isInfinite:this.isInfinite?1n:0n}}toBuffer(){if(this.isInfinite)throw new Error("Cannot serialize infinite point without isInfinite flag");const e=le([this.x,this.y]);if(e.length!==Cr.SIZE_IN_BYTES)throw new Error(`Invalid buffer length for Point: ${e.length}`);return e}toCompressedBuffer(){const[e,t]=this.toXAndSign(),n=e.toBigInt()+(t?2n**255n:0n),s=le(n);if(s.length!==Cr.COMPRESSED_SIZE_IN_BYTES)throw new Error(`Invalid buffer length for compressed Point: ${s.length}`);return s}toString(){return tt(this.toBuffer())}toShortString(){const e=this.toString();return`${e.slice(0,10)}...${e.slice(-4)}`}toNoirStruct(){return{x:this.x,y:this.y,is_infinite:this.isInfinite}}toWrappedNoirStruct(){return{inner:this.toNoirStruct()}}equals(e){return this.x.equals(e.x)&&this.y.equals(e.y)}isZero(){return this.x.isZero()&&this.y.isZero()}hash(){return Xi(this.toFields())}get inf(){return this.isInfinite}isOnGrumpkin(){if(this.inf)return!0;const e=this.y.square(),t=this.x.mul(this.x).mul(this.x).sub(new l(17));return e.equals(t)}};u(Cr,"ZERO",new Cr(l.ZERO,l.ZERO,!1)),u(Cr,"SIZE_IN_BYTES",l.SIZE_IN_BYTES*2),u(Cr,"COMPRESSED_SIZE_IN_BYTES",l.SIZE_IN_BYTES);let Qe=Cr;class _d extends Error{constructor(e){super("The given x-coordinate is not on the Grumpkin curve: "+e.toString()),this.name="NotOnCurveError"}}const Ai=class Ai{constructor(e){u(this,"fields");this.fields=e}toFields(){return this.fields}static random(){return this.fromField(l.random())}toFieldsBuffer(){return Buffer.concat([this.fields[0].toBuffer(),this.fields[1].toBuffer()])}toBuffer(){const e=this.fields[0].toBuffer(),t=this.fields[1].toBuffer();return e[0]=t[31],e}equals(e){return this.toBigInt()===e.toBigInt()}toBigInt(){return un(this.toBuffer())}static fromBuffer(e){if(e.length!=32)throw new Error("Invalid size of coordinate buffer");const t=Buffer.alloc(32);e.copy(t,0,0,32);const n=Buffer.alloc(32);return n[31]=t[0],t[0]=0,new Ai([l.fromBuffer(t),l.fromBuffer(n)])}static fromField(e){const t=e.toBuffer(),n=Buffer.alloc(32);return n[31]=t[0],t[0]=0,new Ai([l.fromBuffer(t),l.fromBuffer(n)])}};u(Ai,"ZERO",new Ai([l.ZERO,l.ZERO]));let Bd=Ai;var Bp={},De={},Qa=Tp;function Tp(r,e){if(!r)throw new Error(e||"Assertion failed")}Tp.equal=function(e,t,n){if(e!=t)throw new Error(n||"Assertion failed: "+e+" != "+t)};var aS=Qa,oS=Jm;De.inherits=oS;function cS(r,e){return(r.charCodeAt(e)&64512)!==55296||e<0||e+1>=r.length?!1:(r.charCodeAt(e+1)&64512)===56320}function uS(r,e){if(Array.isArray(r))return r.slice();if(!r)return[];var t=[];if(typeof r=="string")if(e){if(e==="hex")for(r=r.replace(/[^a-z0-9]+/ig,""),r.length%2!==0&&(r="0"+r),s=0;s<r.length;s+=2)t.push(parseInt(r[s]+r[s+1],16))}else for(var n=0,s=0;s<r.length;s++){var i=r.charCodeAt(s);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=i&63|128):cS(r,s)?(i=65536+((i&1023)<<10)+(r.charCodeAt(++s)&1023),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=i&63|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=i&63|128)}else for(s=0;s<r.length;s++)t[s]=r[s]|0;return t}De.toArray=uS;function lS(r){for(var e="",t=0;t<r.length;t++)e+=Ip(r[t].toString(16));return e}De.toHex=lS;function xp(r){var e=r>>>24|r>>>8&65280|r<<8&16711680|(r&255)<<24;return e>>>0}De.htonl=xp;function fS(r,e){for(var t="",n=0;n<r.length;n++){var s=r[n];e==="little"&&(s=xp(s)),t+=Op(s.toString(16))}return t}De.toHex32=fS;function Ip(r){return r.length===1?"0"+r:r}De.zero2=Ip;function Op(r){return r.length===7?"0"+r:r.length===6?"00"+r:r.length===5?"000"+r:r.length===4?"0000"+r:r.length===3?"00000"+r:r.length===2?"000000"+r:r.length===1?"0000000"+r:r}De.zero8=Op;function dS(r,e,t,n){var s=t-e;aS(s%4===0);for(var i=new Array(s/4),a=0,o=e;a<i.length;a++,o+=4){var c;n==="big"?c=r[o]<<24|r[o+1]<<16|r[o+2]<<8|r[o+3]:c=r[o+3]<<24|r[o+2]<<16|r[o+1]<<8|r[o],i[a]=c>>>0}return i}De.join32=dS;function hS(r,e){for(var t=new Array(r.length*4),n=0,s=0;n<r.length;n++,s+=4){var i=r[n];e==="big"?(t[s]=i>>>24,t[s+1]=i>>>16&255,t[s+2]=i>>>8&255,t[s+3]=i&255):(t[s+3]=i>>>24,t[s+2]=i>>>16&255,t[s+1]=i>>>8&255,t[s]=i&255)}return t}De.split32=hS;function mS(r,e){return r>>>e|r<<32-e}De.rotr32=mS;function pS(r,e){return r<<e|r>>>32-e}De.rotl32=pS;function gS(r,e){return r+e>>>0}De.sum32=gS;function yS(r,e,t){return r+e+t>>>0}De.sum32_3=yS;function bS(r,e,t,n){return r+e+t+n>>>0}De.sum32_4=bS;function wS(r,e,t,n,s){return r+e+t+n+s>>>0}De.sum32_5=wS;function vS(r,e,t,n){var s=r[e],i=r[e+1],a=n+i>>>0,o=(a<n?1:0)+t+s;r[e]=o>>>0,r[e+1]=a}De.sum64=vS;function ES(r,e,t,n){var s=e+n>>>0,i=(s<e?1:0)+r+t;return i>>>0}De.sum64_hi=ES;function SS(r,e,t,n){var s=e+n;return s>>>0}De.sum64_lo=SS;function AS(r,e,t,n,s,i,a,o){var c=0,f=e;f=f+n>>>0,c+=f<e?1:0,f=f+i>>>0,c+=f<i?1:0,f=f+o>>>0,c+=f<o?1:0;var h=r+t+s+a+c;return h>>>0}De.sum64_4_hi=AS;function _S(r,e,t,n,s,i,a,o){var c=e+n+i+o;return c>>>0}De.sum64_4_lo=_S;function BS(r,e,t,n,s,i,a,o,c,f){var h=0,d=e;d=d+n>>>0,h+=d<e?1:0,d=d+i>>>0,h+=d<i?1:0,d=d+o>>>0,h+=d<o?1:0,d=d+f>>>0,h+=d<f?1:0;var v=r+t+s+a+c+h;return v>>>0}De.sum64_5_hi=BS;function TS(r,e,t,n,s,i,a,o,c,f){var h=e+n+i+o+f;return h>>>0}De.sum64_5_lo=TS;function xS(r,e,t){var n=e<<32-t|r>>>t;return n>>>0}De.rotr64_hi=xS;function IS(r,e,t){var n=r<<32-t|e>>>t;return n>>>0}De.rotr64_lo=IS;function OS(r,e,t){return r>>>t}De.shr64_hi=OS;function RS(r,e,t){var n=r<<32-t|e>>>t;return n>>>0}De.shr64_lo=RS;var Ji={},Td=De,FS=Qa;function Fc(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}Ji.BlockHash=Fc;Fc.prototype.update=function(e,t){if(e=Td.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){e=this.pending;var n=e.length%this._delta8;this.pending=e.slice(e.length-n,e.length),this.pending.length===0&&(this.pending=null),e=Td.join32(e,0,e.length-n,this.endian);for(var s=0;s<e.length;s+=this._delta32)this._update(e,s,s+this._delta32)}return this};Fc.prototype.digest=function(e){return this.update(this._pad()),FS(this.pending===null),this._digest(e)};Fc.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,n=t-(e+this.padLength)%t,s=new Array(n+this.padLength);s[0]=128;for(var i=1;i<n;i++)s[i]=0;if(e<<=3,this.endian==="big"){for(var a=8;a<this.padLength;a++)s[i++]=0;s[i++]=0,s[i++]=0,s[i++]=0,s[i++]=0,s[i++]=e>>>24&255,s[i++]=e>>>16&255,s[i++]=e>>>8&255,s[i++]=e&255}else for(s[i++]=e&255,s[i++]=e>>>8&255,s[i++]=e>>>16&255,s[i++]=e>>>24&255,s[i++]=0,s[i++]=0,s[i++]=0,s[i++]=0,a=8;a<this.padLength;a++)s[i++]=0;return s};var Qi={},Hn={},CS=De,xn=CS.rotr32;function PS(r,e,t,n){if(r===0)return Rp(e,t,n);if(r===1||r===3)return Cp(e,t,n);if(r===2)return Fp(e,t,n)}Hn.ft_1=PS;function Rp(r,e,t){return r&e^~r&t}Hn.ch32=Rp;function Fp(r,e,t){return r&e^r&t^e&t}Hn.maj32=Fp;function Cp(r,e,t){return r^e^t}Hn.p32=Cp;function NS(r){return xn(r,2)^xn(r,13)^xn(r,22)}Hn.s0_256=NS;function kS(r){return xn(r,6)^xn(r,11)^xn(r,25)}Hn.s1_256=kS;function LS(r){return xn(r,7)^xn(r,18)^r>>>3}Hn.g0_256=LS;function $S(r){return xn(r,17)^xn(r,19)^r>>>10}Hn.g1_256=$S;var zi=De,HS=Ji,DS=Hn,pu=zi.rotl32,oa=zi.sum32,MS=zi.sum32_5,US=DS.ft_1,Pp=HS.BlockHash,jS=[1518500249,1859775393,2400959708,3395469782];function kn(){if(!(this instanceof kn))return new kn;Pp.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}zi.inherits(kn,Pp);var ZS=kn;kn.blockSize=512;kn.outSize=160;kn.hmacStrength=80;kn.padLength=64;kn.prototype._update=function(e,t){for(var n=this.W,s=0;s<16;s++)n[s]=e[t+s];for(;s<n.length;s++)n[s]=pu(n[s-3]^n[s-8]^n[s-14]^n[s-16],1);var i=this.h[0],a=this.h[1],o=this.h[2],c=this.h[3],f=this.h[4];for(s=0;s<n.length;s++){var h=~~(s/20),d=MS(pu(i,5),US(h,a,o,c),f,n[s],jS[h]);f=c,c=o,o=pu(a,30),a=i,i=d}this.h[0]=oa(this.h[0],i),this.h[1]=oa(this.h[1],a),this.h[2]=oa(this.h[2],o),this.h[3]=oa(this.h[3],c),this.h[4]=oa(this.h[4],f)};kn.prototype._digest=function(e){return e==="hex"?zi.toHex32(this.h,"big"):zi.split32(this.h,"big")};var Vi=De,zS=Ji,ea=Hn,VS=Qa,Qr=Vi.sum32,qS=Vi.sum32_4,WS=Vi.sum32_5,GS=ea.ch32,KS=ea.maj32,YS=ea.s0_256,XS=ea.s1_256,JS=ea.g0_256,QS=ea.g1_256,Np=zS.BlockHash,e1=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Ln(){if(!(this instanceof Ln))return new Ln;Np.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=e1,this.W=new Array(64)}Vi.inherits(Ln,Np);var kp=Ln;Ln.blockSize=512;Ln.outSize=256;Ln.hmacStrength=192;Ln.padLength=64;Ln.prototype._update=function(e,t){for(var n=this.W,s=0;s<16;s++)n[s]=e[t+s];for(;s<n.length;s++)n[s]=qS(QS(n[s-2]),n[s-7],JS(n[s-15]),n[s-16]);var i=this.h[0],a=this.h[1],o=this.h[2],c=this.h[3],f=this.h[4],h=this.h[5],d=this.h[6],v=this.h[7];for(VS(this.k.length===n.length),s=0;s<n.length;s++){var b=WS(v,XS(f),GS(f,h,d),this.k[s],n[s]),D=Qr(YS(i),KS(i,a,o));v=d,d=h,h=f,f=Qr(c,b),c=o,o=a,a=i,i=Qr(b,D)}this.h[0]=Qr(this.h[0],i),this.h[1]=Qr(this.h[1],a),this.h[2]=Qr(this.h[2],o),this.h[3]=Qr(this.h[3],c),this.h[4]=Qr(this.h[4],f),this.h[5]=Qr(this.h[5],h),this.h[6]=Qr(this.h[6],d),this.h[7]=Qr(this.h[7],v)};Ln.prototype._digest=function(e){return e==="hex"?Vi.toHex32(this.h,"big"):Vi.split32(this.h,"big")};var _l=De,Lp=kp;function is(){if(!(this instanceof is))return new is;Lp.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}_l.inherits(is,Lp);var t1=is;is.blockSize=512;is.outSize=224;is.hmacStrength=192;is.padLength=64;is.prototype._digest=function(e){return e==="hex"?_l.toHex32(this.h.slice(0,7),"big"):_l.split32(this.h.slice(0,7),"big")};var br=De,r1=Ji,n1=Qa,In=br.rotr64_hi,On=br.rotr64_lo,$p=br.shr64_hi,Hp=br.shr64_lo,hs=br.sum64,gu=br.sum64_hi,yu=br.sum64_lo,s1=br.sum64_4_hi,i1=br.sum64_4_lo,a1=br.sum64_5_hi,o1=br.sum64_5_lo,Dp=r1.BlockHash,c1=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function cn(){if(!(this instanceof cn))return new cn;Dp.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=c1,this.W=new Array(160)}br.inherits(cn,Dp);var Mp=cn;cn.blockSize=1024;cn.outSize=512;cn.hmacStrength=192;cn.padLength=128;cn.prototype._prepareBlock=function(e,t){for(var n=this.W,s=0;s<32;s++)n[s]=e[t+s];for(;s<n.length;s+=2){var i=w1(n[s-4],n[s-3]),a=v1(n[s-4],n[s-3]),o=n[s-14],c=n[s-13],f=y1(n[s-30],n[s-29]),h=b1(n[s-30],n[s-29]),d=n[s-32],v=n[s-31];n[s]=s1(i,a,o,c,f,h,d,v),n[s+1]=i1(i,a,o,c,f,h,d,v)}};cn.prototype._update=function(e,t){this._prepareBlock(e,t);var n=this.W,s=this.h[0],i=this.h[1],a=this.h[2],o=this.h[3],c=this.h[4],f=this.h[5],h=this.h[6],d=this.h[7],v=this.h[8],b=this.h[9],D=this.h[10],U=this.h[11],ie=this.h[12],K=this.h[13],I=this.h[14],x=this.h[15];n1(this.k.length===n.length);for(var k=0;k<n.length;k+=2){var re=I,ye=x,fe=p1(v,b),Fe=g1(v,b),Se=u1(v,b,D,U,ie),Ve=l1(v,b,D,U,ie,K),rt=this.k[k],Te=this.k[k+1],B=n[k],Q=n[k+1],z=a1(re,ye,fe,Fe,Se,Ve,rt,Te,B,Q),L=o1(re,ye,fe,Fe,Se,Ve,rt,Te,B,Q);re=h1(s,i),ye=m1(s,i),fe=f1(s,i,a,o,c),Fe=d1(s,i,a,o,c,f);var te=gu(re,ye,fe,Fe),he=yu(re,ye,fe,Fe);I=ie,x=K,ie=D,K=U,D=v,U=b,v=gu(h,d,z,L),b=yu(d,d,z,L),h=c,d=f,c=a,f=o,a=s,o=i,s=gu(z,L,te,he),i=yu(z,L,te,he)}hs(this.h,0,s,i),hs(this.h,2,a,o),hs(this.h,4,c,f),hs(this.h,6,h,d),hs(this.h,8,v,b),hs(this.h,10,D,U),hs(this.h,12,ie,K),hs(this.h,14,I,x)};cn.prototype._digest=function(e){return e==="hex"?br.toHex32(this.h,"big"):br.split32(this.h,"big")};function u1(r,e,t,n,s){var i=r&t^~r&s;return i<0&&(i+=4294967296),i}function l1(r,e,t,n,s,i){var a=e&n^~e&i;return a<0&&(a+=4294967296),a}function f1(r,e,t,n,s){var i=r&t^r&s^t&s;return i<0&&(i+=4294967296),i}function d1(r,e,t,n,s,i){var a=e&n^e&i^n&i;return a<0&&(a+=4294967296),a}function h1(r,e){var t=In(r,e,28),n=In(e,r,2),s=In(e,r,7),i=t^n^s;return i<0&&(i+=4294967296),i}function m1(r,e){var t=On(r,e,28),n=On(e,r,2),s=On(e,r,7),i=t^n^s;return i<0&&(i+=4294967296),i}function p1(r,e){var t=In(r,e,14),n=In(r,e,18),s=In(e,r,9),i=t^n^s;return i<0&&(i+=4294967296),i}function g1(r,e){var t=On(r,e,14),n=On(r,e,18),s=On(e,r,9),i=t^n^s;return i<0&&(i+=4294967296),i}function y1(r,e){var t=In(r,e,1),n=In(r,e,8),s=$p(r,e,7),i=t^n^s;return i<0&&(i+=4294967296),i}function b1(r,e){var t=On(r,e,1),n=On(r,e,8),s=Hp(r,e,7),i=t^n^s;return i<0&&(i+=4294967296),i}function w1(r,e){var t=In(r,e,19),n=In(e,r,29),s=$p(r,e,6),i=t^n^s;return i<0&&(i+=4294967296),i}function v1(r,e){var t=On(r,e,19),n=On(e,r,29),s=Hp(r,e,6),i=t^n^s;return i<0&&(i+=4294967296),i}var Bl=De,Up=Mp;function as(){if(!(this instanceof as))return new as;Up.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}Bl.inherits(as,Up);var E1=as;as.blockSize=1024;as.outSize=384;as.hmacStrength=192;as.padLength=128;as.prototype._digest=function(e){return e==="hex"?Bl.toHex32(this.h.slice(0,12),"big"):Bl.split32(this.h.slice(0,12),"big")};Qi.sha1=ZS;Qi.sha224=t1;Qi.sha256=kp;Qi.sha384=E1;Qi.sha512=Mp;var jp={},si=De,S1=Ji,go=si.rotl32,xd=si.sum32,ca=si.sum32_3,Id=si.sum32_4,Zp=S1.BlockHash;function $n(){if(!(this instanceof $n))return new $n;Zp.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}si.inherits($n,Zp);jp.ripemd160=$n;$n.blockSize=512;$n.outSize=160;$n.hmacStrength=192;$n.padLength=64;$n.prototype._update=function(e,t){for(var n=this.h[0],s=this.h[1],i=this.h[2],a=this.h[3],o=this.h[4],c=n,f=s,h=i,d=a,v=o,b=0;b<80;b++){var D=xd(go(Id(n,Od(b,s,i,a),e[B1[b]+t],A1(b)),x1[b]),o);n=o,o=a,a=go(i,10),i=s,s=D,D=xd(go(Id(c,Od(79-b,f,h,d),e[T1[b]+t],_1(b)),I1[b]),v),c=v,v=d,d=go(h,10),h=f,f=D}D=ca(this.h[1],i,d),this.h[1]=ca(this.h[2],a,v),this.h[2]=ca(this.h[3],o,c),this.h[3]=ca(this.h[4],n,f),this.h[4]=ca(this.h[0],s,h),this.h[0]=D};$n.prototype._digest=function(e){return e==="hex"?si.toHex32(this.h,"little"):si.split32(this.h,"little")};function Od(r,e,t,n){return r<=15?e^t^n:r<=31?e&t|~e&n:r<=47?(e|~t)^n:r<=63?e&n|t&~n:e^(t|~n)}function A1(r){return r<=15?0:r<=31?1518500249:r<=47?1859775393:r<=63?2400959708:2840853838}function _1(r){return r<=15?1352829926:r<=31?1548603684:r<=47?1836072691:r<=63?2053994217:0}var B1=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],T1=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],x1=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],I1=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],O1=De,R1=Qa;function qi(r,e,t){if(!(this instanceof qi))return new qi(r,e,t);this.Hash=r,this.blockSize=r.blockSize/8,this.outSize=r.outSize/8,this.inner=null,this.outer=null,this._init(O1.toArray(e,t))}var F1=qi;qi.prototype._init=function(e){e.length>this.blockSize&&(e=new this.Hash().update(e).digest()),R1(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(t=0;t<e.length;t++)e[t]^=54;for(this.inner=new this.Hash().update(e),t=0;t<e.length;t++)e[t]^=106;this.outer=new this.Hash().update(e)};qi.prototype.update=function(e,t){return this.inner.update(e,t),this};qi.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)};(function(r){var e=r;e.utils=De,e.common=Ji,e.sha=Qi,e.ripemd=jp,e.hmac=F1,e.sha1=e.sha.sha1,e.sha256=e.sha.sha256,e.sha224=e.sha.sha224,e.sha384=e.sha.sha384,e.sha512=e.sha.sha512,e.ripemd160=e.ripemd.ripemd160})(Bp);const zp=Ua(Bp);function Vp(r){return Buffer.from(zp.sha256().update(r).digest())}function qp(r){return tS(Vp(r))}function C1(r){const e=le(r);return l.fromBuffer(qp(e))}var Wp={},Gp={},Kp={},Yp={},P1=function(e,t){return function(n,s){var i=s*2,a=t*2;n[i]=e[a],n[i+1]=e[a+1]}},sf=P1;(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var e=t(sf);function t(i){return i&&i.__esModule?i:{default:i}}var n=function(a){for(var o=a.A,c=a.C,f=0;f<25;f+=5){for(var h=0;h<5;h++)(0,e.default)(o,f+h)(c,h);for(var d=0;d<5;d++){var v=(f+d)*2,b=(d+1)%5*2,D=(d+2)%5*2;o[v]^=~c[b]&c[D],o[v+1]^=~c[b+1]&c[D+1]}}},s=n;r.default=s})(Yp);var Xp={},Jp={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var e=new Uint32Array([0,1,0,32898,2147483648,32906,2147483648,2147516416,0,32907,0,2147483649,2147483648,2147516545,2147483648,32777,0,138,0,136,0,2147516425,0,2147483658,0,2147516555,2147483648,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,0,32778,2147483648,2147483658,2147483648,2147516545,2147483648,32896,0,2147483649,2147483648,2147516424]),t=e;r.default=t})(Jp);(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var e=t(Jp);function t(i){return i&&i.__esModule?i:{default:i}}var n=function(a){var o=a.A,c=a.roundIndex,f=c*2;o[0]^=e.default[f],o[1]^=e.default[f+1]},s=n;r.default=s})(Xp);var Qp={},eg={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var e=[10,7,11,17,18,3,5,16,8,21,24,4,15,23,19,13,12,2,20,14,22,9,6,1],t=e;r.default=t})(eg);var tg={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var e=[1,3,6,10,15,21,28,36,45,55,2,14,27,41,56,8,25,43,62,18,39,61,20,44],t=e;r.default=t})(tg);(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var e=s(eg),t=s(tg),n=s(sf);function s(o){return o&&o.__esModule?o:{default:o}}var i=function(c){var f=c.A,h=c.C,d=c.W;(0,n.default)(f,1)(d,0);for(var v=0,b=0,D=0,U=32,ie=0;ie<24;ie++){var K=e.default[ie],I=t.default[ie];(0,n.default)(f,K)(h,0),v=d[0],b=d[1],U=32-I,D=I<32?0:1,d[D]=v<<I|b>>>U,d[(D+1)%2]=b<<I|v>>>U,(0,n.default)(d,0)(f,K),(0,n.default)(h,0)(d,0)}},a=i;r.default=a})(Qp);var rg={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var e=t(sf);function t(i){return i&&i.__esModule?i:{default:i}}var n=function(a){for(var o=a.A,c=a.C,f=a.D,h=a.W,d=0,v=0,b=0;b<5;b++){var D=b*2,U=(b+5)*2,ie=(b+10)*2,K=(b+15)*2,I=(b+20)*2;c[D]=o[D]^o[U]^o[ie]^o[K]^o[I],c[D+1]=o[D+1]^o[U+1]^o[ie+1]^o[K+1]^o[I+1]}for(var x=0;x<5;x++){(0,e.default)(c,(x+1)%5)(h,0),d=h[0],v=h[1],h[0]=d<<1|v>>>31,h[1]=v<<1|d>>>31,f[x*2]=c[(x+4)%5*2]^h[0],f[x*2+1]=c[(x+4)%5*2+1]^h[1];for(var k=0;k<25;k+=5)o[(k+x)*2]^=f[x*2],o[(k+x)*2+1]^=f[x*2+1]}},s=n;r.default=s})(rg);(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var e=i(Yp),t=i(Xp),n=i(Qp),s=i(rg);function i(c){return c&&c.__esModule?c:{default:c}}var a=function(){var f=new Uint32Array(10),h=new Uint32Array(10),d=new Uint32Array(2);return function(v){for(var b=0;b<24;b++)(0,s.default)({A:v,C:f,D:h,W:d}),(0,n.default)({A:v,C:f,W:d}),(0,e.default)({A:v,C:f}),(0,t.default)({A:v,roundIndex:b});f.fill(0),h.fill(0),d.fill(0)}},o=a;r.default=o})(Kp);(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var e=$o,t=n(Kp);function n(c){return c&&c.__esModule?c:{default:c}}var s=function(f,h){for(var d=0;d<f.length;d+=8){var v=d/4;h[v]^=f[d+7]<<24|f[d+6]<<16|f[d+5]<<8|f[d+4],h[v+1]^=f[d+3]<<24|f[d+2]<<16|f[d+1]<<8|f[d]}return h},i=function(f,h){for(var d=0;d<h.length;d+=8){var v=d/4;h[d]=f[v+1],h[d+1]=f[v+1]>>>8,h[d+2]=f[v+1]>>>16,h[d+3]=f[v+1]>>>24,h[d+4]=f[v],h[d+5]=f[v]>>>8,h[d+6]=f[v]>>>16,h[d+7]=f[v]>>>24}return h},a=function(f){var h=this,d=f.capacity,v=f.padding,b=(0,t.default)(),D=200,U=d/8,ie=D-d/4,K=0,I=new Uint32Array(D/4),x=e.Buffer.allocUnsafe(ie);return this.absorb=function(k){for(var re=0;re<k.length;re++)x[K]=k[re],K+=1,K>=ie&&(s(x,I),b(I),K=0);return h},this.squeeze=function(){var k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},re={buffer:k.buffer||e.Buffer.allocUnsafe(U),padding:k.padding||v,queue:e.Buffer.allocUnsafe(x.length),state:new Uint32Array(I.length)};x.copy(re.queue);for(var ye=0;ye<I.length;ye++)re.state[ye]=I[ye];re.queue.fill(0,K),re.queue[K]|=re.padding,re.queue[ie-1]|=128,s(re.queue,re.state);for(var fe=0;fe<re.buffer.length;fe+=ie)b(re.state),i(re.state,re.buffer.slice(fe,fe+ie));return re.buffer},this.reset=function(){return x.fill(0),I.fill(0),K=0,h},this},o=a;r.default=o})(Gp);(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.SHAKE=r.SHA3Hash=r.SHA3=r.Keccak=void 0;var e=$o,t=n(Gp);function n(h){return h&&h.__esModule?h:{default:h}}var s=function(d){var v=d.allowedSizes,b=d.defaultSize,D=d.padding;return function U(){var ie=this,K=arguments.length>0&&arguments[0]!==void 0?arguments[0]:b;if(!this||this.constructor!==U)return new U(K);if(v&&!v.includes(K))throw new Error("Unsupported hash length");var I=new t.default({capacity:K});return this.update=function(x){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"utf8";if(e.Buffer.isBuffer(x))return I.absorb(x),ie;if(typeof x=="string")return ie.update(e.Buffer.from(x,k));throw new TypeError("Not a string or buffer")},this.digest=function(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"binary",k=typeof x=="string"?{format:x}:x,re=I.squeeze({buffer:k.buffer,padding:k.padding||D});return k.format&&k.format!=="binary"?re.toString(k.format):re},this.reset=function(){return I.reset(),ie},this}},i=s({allowedSizes:[224,256,384,512],defaultSize:512,padding:1});r.Keccak=i;var a=s({allowedSizes:[224,256,384,512],defaultSize:512,padding:6});r.SHA3=a;var o=s({allowedSizes:[128,256],defaultSize:256,padding:31});r.SHAKE=o;var c=i;r.SHA3Hash=c,a.SHA3Hash=c;var f=a;r.default=f})(Wp);const At=class At{constructor(e){u(this,"buffer");if(this.buffer=e,e.length!==At.SIZE)throw new Error(`Expected buffer to have length ${At.SIZE} but was ${e.length}`)}toBuffer(){return this.buffer}static fromBuffer(e){const t=J.asReader(e);return new At(t.readBytes(At.SIZE))}equals(e){return this.buffer.equals(e.buffer)}isZero(){return this.buffer.equals(Buffer.alloc(32,0))}toString(){return tt(this.buffer)}[ue.inspect.custom](){return`Buffer32<${this.toString()}>`}toJSON(){return this.toString()}toBigInt(){return Ap(this.buffer,0,At.SIZE).elem}static fromBigInt(e){return new At(Gs(e,At.SIZE))}static fromField(e){return new At(Gs(e.toBigInt()))}static fromBuffer28(e){if(e.length!=28)throw new Error("Expected Buffer32 input buffer to be 28 bytes");const t=Buffer.concat([Buffer.alloc(this.SIZE-28),e]);return new At(t)}static fromString(e){if(e.startsWith("0x")&&(e=e.slice(2)),e.length!==this.SIZE*2)throw new Error(`Expected string to be ${this.SIZE*2} characters long, but was ${e.length}`);return new At(Buffer.from(e,"hex"))}static fromNumber(e){return new At(Gs(BigInt(e),At.SIZE))}static random(){return new At(Buffer.from(Wr(At.SIZE)))}};u(At,"SIZE",32),u(At,"ZERO",new At(Buffer.alloc(At.SIZE)));let Vt=At;function Rd(r){const e=new Wp.Keccak(256);return e.reset(),e.update(r),e.digest("hex")}const N1=r=>Buffer.from(zp.sha512().update(r).digest()),eo=r=>{const e=le(r);return Ep.fromBufferReduce(N1(e))};var k1={};async function ng(r,e=0){const t=Je(r),s=(await Ht.initSingleton(k1.BB_WASM_PATH)).pedersenHash(t.map(i=>new Ie(i.toBuffer())),e);return l.fromBuffer(Buffer.from(s.toBuffer()))}const xt=class xt{constructor(e){u(this,"buffer");if(this.buffer=e,e.length!==xt.SIZE)throw new Error(`Expected buffer to have length ${xt.SIZE} but was ${e.length}`)}toBuffer(){return this.buffer}static fromBuffer(e){const t=J.asReader(e);return new xt(t.readBytes(xt.SIZE))}equals(e){return this.buffer.equals(e.buffer)}isZero(){return this.buffer.equals(Buffer.alloc(16,0))}toString(){return tt(this.buffer)}[ue.inspect.custom](){return`Buffer16<${this.toString()}>`}toJSON(){return this.toString()}toBigInt(){return Ap(this.buffer,0,xt.SIZE).elem}static fromBigInt(e){return new xt(Gs(e,xt.SIZE))}static fromField(e){return new xt(Gs(e.toBigInt()))}static fromString(e){if(e.startsWith("0x")&&(e=e.slice(2)),e.length!==this.SIZE*2)throw new Error(`Expected string to be ${this.SIZE*2} characters long, but was ${e.length}`);return new xt(Buffer.from(e,"hex"))}static fromNumber(e){return new xt(Gs(BigInt(e),xt.SIZE))}static random(){return new xt(Buffer.from(Wr(xt.SIZE)))}};u(xt,"SIZE",16),u(xt,"ZERO",new xt(Buffer.alloc(xt.SIZE)));let Fd=xt;const ht=class ht{constructor(e){u(this,"buffer");if(this.buffer=e,e.length!==ht.SIZE_IN_BYTES)throw new Error(`Expect buffer size to be ${ht.SIZE_IN_BYTES}. Got ${e.length}.`)}static fromString(e){if(!ht.isAddress(e))throw new Error(`Invalid address string: ${e}`);return new ht(Buffer.from(e.replace(/^0x/i,""),"hex"))}static random(){return new ht(Wr(20))}static isAddress(e){return/^(0x)?[0-9a-f]{40}$/i.test(e)?/^(0x|0X)?[0-9a-f]{40}$/.test(e)||/^(0x|0X)?[0-9A-F]{40}$/.test(e)?!0:ht.checkAddressChecksum(e):!1}isZero(){return this.equals(ht.ZERO)}static checkAddressChecksum(e){e=e.replace(/^0x/i,"");const t=Rd(e.toLowerCase());for(let n=0;n<40;n++)if(parseInt(t[n],16)>7&&e[n].toUpperCase()!==e[n]||parseInt(t[n],16)<=7&&e[n].toLowerCase()!==e[n])return!1;return!0}static toChecksumAddress(e){if(!ht.isAddress(e))throw new Error("Invalid address string.");e=e.toLowerCase().replace(/^0x/i,"");const t=Rd(e);let n="0x";for(let s=0;s<e.length;s++)parseInt(t[s],16)>7?n+=e[s].toUpperCase():n+=e[s];return n}equals(e){return this.buffer.equals(e.buffer)}toString(){return tt(this.buffer)}[ue.inspect.custom](){return`EthAddress<${this.toString()}>`}toChecksumString(){return ht.toChecksumAddress(this.buffer.toString("hex"))}toBuffer(){return this.buffer}toBuffer32(){const e=Buffer.alloc(32);return this.buffer.copy(e,12),e}toField(){return l.fromBuffer(this.toBuffer32())}static fromField(e){return new ht(e.toBuffer().slice(-ht.SIZE_IN_BYTES))}static fromFields(e){const t=Ee.asReader(e);return ht.fromField(t.readField())}static fromBuffer(e){const t=J.asReader(e);return new ht(t.readBytes(ht.SIZE_IN_BYTES))}static fromNumber(e){const t=Buffer.alloc(ht.SIZE_IN_BYTES);return t.writeBigUInt64BE(BigInt(e),0),new ht(t)}toJSON(){return this.toString()}static get schema(){return Gr(ht,ht.isAddress)}};u(ht,"SIZE_IN_BYTES",20),u(ht,"ZERO",new ht(Buffer.alloc(ht.SIZE_IN_BYTES)));let gr=ht;ii.register("EthAddress",gr);class zn{constructor(e,t,n,s=!1){u(this,"r");u(this,"s");u(this,"v");u(this,"isEmpty");u(this,"size");this.r=e,this.s=t,this.v=n,this.isEmpty=s}static fromBuffer(e){const t=J.asReader(e),n=t.readObject(Vt),s=t.readObject(Vt),i=t.readNumber(),a=n.isZero()&&s.isZero();return new zn(n,s,i,a)}static isValidString(e){return/^0x[0-9a-f]{129,}$/i.test(e)}static fromString(e){const t=dt(e),n=J.asReader(t),s=n.readObject(Vt),i=n.readObject(Vt),a=parseInt(e.slice(2+64*2),16),o=s.isZero()&&i.isZero();return new zn(s,i,a,o)}static fromViemSignature(e){return new zn(Vt.fromBuffer(dt(e.r)),Vt.fromBuffer(dt(e.s)),e.v,e.isEmpty)}static random(){return new zn(Vt.random(),Vt.random(),Math.floor(Math.random()*2),!1)}static empty(){return new zn(Vt.ZERO,Vt.ZERO,0,!0)}equals(e){return this.r.equals(e.r)&&this.s.equals(e.s)&&this.v===e.v&&this.isEmpty===e.isEmpty}toBuffer(){const e=le([this.r,this.s,this.v]);return this.size=e.length,e}getSize(){return this.size?this.size:(this.size=this.toBuffer().length,this.size)}toString(){return`0x${this.r.buffer.toString("hex")}${this.s.buffer.toString("hex")}${this.v.toString(16)}`}toViemSignature(){return{r:this.r.toString(),s:this.s.toString(),v:this.v,isEmpty:this.isEmpty}}toJSON(){return this.toString()}static get schema(){return we().refine(bp,"No hex prefix").refine(zn.isValidString,"Not a valid Ethereum signature").transform(zn.fromString)}}var L1={};async function $1(r){return(await Ht.initSingleton(L1.BB_WASM_PATH)).acirVkAsFieldsMegaHonk(new Ms(r)).map(n=>l.fromBuffer(Buffer.from(n.toBuffer())))}var ua={};const vc=class vc{generator(){return vc.generator}async mul(e,t){const n=await Ht.initSingleton(ua.BB_WASM_PATH),[s]=n.getWasm().callWasmExport("ecc_grumpkin__mul",[e.toBuffer(),t.toBuffer()],[64]);return Qe.fromBuffer(Buffer.from(s))}async add(e,t){const n=await Ht.initSingleton(ua.BB_WASM_PATH),[s]=n.getWasm().callWasmExport("ecc_grumpkin__add",[e.toBuffer(),t.toBuffer()],[64]);return Qe.fromBuffer(Buffer.from(s))}async batchMul(e,t){const n=Buffer.concat(e.map(c=>c.toBuffer())),s=e.length*Qe.SIZE_IN_BYTES,i=await Ht.initSingleton(ua.BB_WASM_PATH),[a]=i.getWasm().callWasmExport("ecc_grumpkin__batch_mul",[n,t.toBuffer(),e.length],[s]),o=[];for(let c=0;c<s;c+=64)o.push(Qe.fromBuffer(Buffer.from(a.subarray(c,c+64))));return o}async getRandomFr(){const e=await Ht.initSingleton(ua.BB_WASM_PATH),[t]=e.getWasm().callWasmExport("ecc_grumpkin__get_random_scalar_mod_circuit_modulus",[],[32]);return l.fromBuffer(Buffer.from(t))}async reduce512BufferToFr(e){const t=await Ht.initSingleton(ua.BB_WASM_PATH),[n]=t.getWasm().callWasmExport("ecc_grumpkin__reduce512_buffer_mod_circuit_modulus",[e],[32]);return l.fromBuffer(Buffer.from(n))}};u(vc,"generator",Qe.fromBuffer(Buffer.from([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,2,207,19,94,117,6,164,93,99,45,39,13,69,241,24,18,148,131,63,196,141,130,63,39,44])));let La=vc;var bu={};const Ec=class Ec{generator(){return Ec.generator}async mul(e,t){const n=await Ht.initSingleton(bu.BB_WASM_PATH),[s]=n.getWasm().callWasmExport("ecc_secp256k1__mul",[e,t],[64]);return Buffer.from(s)}async getRandomFr(){const e=await Ht.initSingleton(bu.BB_WASM_PATH),[t]=e.getWasm().callWasmExport("ecc_secp256k1__get_random_scalar_mod_circuit_modulus",[],[32]);return Buffer.from(t)}async reduce512BufferToFr(e){const t=await Ht.initSingleton(bu.BB_WASM_PATH),[n]=t.getWasm().callWasmExport("ecc_secp256k1__reduce512_buffer_mod_circuit_modulus",[e],[32]);return Buffer.from(n)}};u(Ec,"generator",Buffer.from([121,190,102,126,249,220,187,172,85,160,98,149,206,135,11,7,2,155,252,219,45,206,40,217,89,242,129,91,22,248,23,152,72,58,218,119,38,163,196,101,93,164,251,252,14,17,8,168,253,23,180,72,166,133,84,25,156,71,208,143,251,16,212,184]));let Cd=Ec;const en=class en{constructor(e){u(this,"buffer");if(this.buffer=e,e.length!==en.SIZE)throw new Error(`Invalid signature buffer of length ${e.length}.`)}static isSignature(e){return/^(0x)?[0-9a-f]{128}$/i.test(e)}static fromString(e){if(!en.isSignature(e))throw new Error(`Invalid signature string: ${e}`);return new en(Buffer.from(e.replace(/^0x/i,""),"hex"))}static random(){return new en(Wr(64))}get s(){return this.buffer.subarray(0,32)}get e(){return this.buffer.subarray(32)}toBuffer(){return this.buffer}static fromBuffer(e){const t=J.asReader(e);return new en(t.readBytes(en.SIZE))}toString(){return`0x${this.buffer.toString("hex")}`}toFields(){const e=this.toBuffer(),t=Buffer.alloc(32),n=Buffer.alloc(32),s=Buffer.alloc(32);return e.copy(t,1,0,31),e.copy(n,1,31,62),e.copy(s,1,62,64),iS([t,n,s],l.fromBuffer)}};u(en,"SIZE",64),u(en,"EMPTY",new en(Buffer.alloc(64)));let Pd=en;class H1{constructor(e,t){u(this,"height");u(this,"nodes");this.height=e,this.nodes=t;const n=2**(e+1)-1;if(t.length!==n)throw new Error(`Invalid node count for Merkle tree: got ${t.length} but expected ${n}`)}get root(){return this.nodes[this.nodes.length-1]}get leaves(){return this.nodes.slice(0,2**this.height)}getSiblingPath(e){if(Buffer.isBuffer(e))return this.getSiblingPath(this.getIndex(e));const t=e;if(t<0||t>=2**this.height)throw new Error(`Invalid leaf index: got ${t} but leaves count is ${2**this.height}`);const n=this.nodes;let s=Math.ceil(n.length/2),i=0,a=t;const o=[];for(;s>1;){const c=a&1;o.push(n[i+a+(c?-1:1)]),i+=s,s>>=1,a>>=1}return o}getIndex(e){return this.leaves.findIndex(t=>t.equals(e))}drawTree(e=8){const t=[],n=this.nodes,s=Math.ceil(n.length/2);let i=1,a=s,o=0;for(;a>0;)t.push(n.slice(o,o+a).map(c=>c.toString("hex").slice(0,e)+" ".repeat((i-1)*(e+1)))),o+=a,i<<=1,a>>=1;return t.reverse().map(c=>c.join(" ")).join(`
`)}}class Cc{constructor(e,t,n){u(this,"height");u(this,"zeroHashes");u(this,"hasher");this.height=e,this.zeroHashes=t,this.hasher=n,this.hasher=n}static async create(e,t=Buffer.alloc(32),n=async(s,i)=>(await ng([s,i])).toBuffer()){const s=[t];for(let i=0;i<e;i++)s.push(await n(s[i],s[i]));return new Cc(e,s,n)}async computeTree(e=[]){e.length===0&&(e=new Array(2**this.height).fill(this.zeroHashes[0]));let t=e.slice();for(let n=0;n<this.height;++n){const s=2**(this.height-n),i=[];for(let a=0;a<e.length/2;++a){const o=e[a*2],c=e[a*2+1]||this.zeroHashes[n];i[a]=await this.hasher(o,c)}t=t.concat(new Array(s-e.length).fill(this.zeroHashes[n]),i),e=i}return new H1(this.height,t)}async computeTreeRoot(e=[]){if(e.length===0)return this.zeroHashes[this.zeroHashes.length-1];e=e.slice();for(let t=0;t<this.height;++t){let n=0;for(;n<e.length/2;++n){const s=e[n*2],i=e[n*2+1]||this.zeroHashes[t];e[n]=await this.hasher(s,i)}e=e.slice(0,n)}return e[0]}}function Xe(r,e,t=0){return Array.from({length:r},(n,s)=>e(s+t))}async function Nd(r,e,t=0){return await Promise.all(Array(r).fill(0).map(async(n,s)=>await e(s+t)))}function Yx(r,e,t){if(r[e].length!==t)throw new Error(`Expected ${e} to have length ${t} but was ${r[e].length}`)}function D1(r,e){return typeof e=="string"&&Object.hasOwn(r,e)&&typeof r[e].parameters=="function"&&typeof r[e].returnType=="function"}const q={EthAddress:gr.schema,Fr:l.schema,Fq:Tn.schema,Point:Qe.schema,BigInt:Yt([mu(),se(),we()]).pipe(Fi.bigint()),Integer:Yt([mu(),se(),we()]).pipe(Fi.number().int()),UInt32:Yt([mu(),se(),we()]).pipe(Fi.number().int().min(0).max(2**32-1)),Buffer32:we().refine(ic,"Not a valid hex string").transform(Vt.fromString),Buffer:Yt([ac,R({type:st("Buffer"),data:ee(se().int().min(0).max(255))}).transform(({data:r})=>Buffer.from(r))]),BufferHex:we().refine(ic,"Not a valid hex string").transform(Xa).transform(r=>Buffer.from(r,"hex"))};class Et{constructor(e,t){u(this,"pathSize");u(this,"data");this.pathSize=e,this.data=sS(t,e)}static get schema(){return q.Buffer.transform(e=>Et.fromBuffer(e))}static schemaFor(e){return q.Buffer.transform(t=>Et.fromBuffer(t)).refine(t=>t.pathSize===e,t=>({message:`Expected sibling path size ${e} but got ${t.pathSize}`}))}toJSON(){return this.toBuffer()}static ZERO(e,t,n){const s=[];let i=t;for(let a=0;a<e;++a)s.push(i),i=n.hash(i,i);return new Et(e,s)}static random(e){const t=Array.from({length:e},()=>l.random().toBuffer());return new Et(e,t)}toBuffer(){return mn(this.data)}toBufferArray(){return this.data}toFields(){return this.data.map(e=>l.fromBuffer(e))}toTuple(){const e=this.toFields();return Xe(e.length,t=>e[t],0)}static fromBuffer(e,t=0){const{elem:n}=Et.deserialize(e,t);return n}static deserialize(e,t=0){const n=(o,c)=>({elem:o.slice(c,c+32),adv:32}),{elem:s,adv:i}=rS(n,e,t),a=s.length;return{elem:new Et(a,s),adv:i}}toString(){return tt(this.toBuffer())}static fromString(e){return Et.fromBuffer(dt(e))}getSubtreeSiblingPath(e){const t=this.data.slice(e),n=this.pathSize-e;return new Et(n,t)}}const Xx=16e3,wu=16,vu=16,Eu=5,Su=16,Au=2,_u=16,Bu=16,Tu=16,xu=16,Iu=1,sg=29,Jx=6,Qx=3,M1=5,ig=40,ba=40,cc=40,af=39,eI=5,U1=0,j1=1,Z1=2,z1=3,V1=4,Bs=64,Ts=64,tI=8,Ou=32,Ru=64,xs=8,rI=64,nI=64,sI=64,Is=32,Ci=1,q1=1,kd=4096,Ld=3,Tl=3e3,iI=3e3,aI=7,W1=79025834455612,oI=1,G1=582240093077765400562621227108555700500271598878376310175765873770292988861n,K1=10422444662424639723529825114205836958711284159673861467999592572974769103684n,Y1=339708709767762472786445938838804872781183545349360029270386718856175781484n,X1=12719619215050539905199178334954929730355853796706924300730604757520758976849n,J1=12212787719617305570587928860288475454328008955283046946846066128763901043335n,Q1=3646747884782549389807830220601404629716007431341772952958971658285958854707n,eA=728059161893070741164607238299536939695876538801885465230641192969135857403n,tA=14575718736702206050102425029229426215631664471161015518982549597389390371695n,$d=8,Hd=4,Dd=4,Md=2,Ud=9,jd=3,Zd=4,zd=2,Vd=4,qd=5,cI=6,Wd=6,fi=18,rA=19,Gd=21,Hs=13,nA=15,hn=3019,sA=3021,Kd=2,Yd=4,Xd=5,Jd=2,Qd=8,eh=8,th=10,rh=15,nh=25,sh=740,uI=40,ih=771,ah=37,oh=899,lI=160,ch=1844,uh=813,fI=112,dI=113,hI=127,lh=1e9,fh=6e6,Fu=1,iA=2,dh=3,hh=4,mh=5,ph=6,gh=7,yh=8,bh=9,mI=1,pI=3;var nt=function(r){return r[r.NOTE_HASH=1]="NOTE_HASH",r[r.NOTE_HASH_NONCE=2]="NOTE_HASH_NONCE",r[r.UNIQUE_NOTE_HASH=3]="UNIQUE_NOTE_HASH",r[r.SILOED_NOTE_HASH=4]="SILOED_NOTE_HASH",r[r.MESSAGE_NULLIFIER=5]="MESSAGE_NULLIFIER",r[r.INITIALIZATION_NULLIFIER=6]="INITIALIZATION_NULLIFIER",r[r.OUTER_NULLIFIER=7]="OUTER_NULLIFIER",r[r.PUBLIC_DATA_READ=8]="PUBLIC_DATA_READ",r[r.PUBLIC_DATA_UPDATE_REQUEST=9]="PUBLIC_DATA_UPDATE_REQUEST",r[r.FUNCTION_DATA=10]="FUNCTION_DATA",r[r.FUNCTION_LEAF=11]="FUNCTION_LEAF",r[r.CONTRACT_DEPLOYMENT_DATA=12]="CONTRACT_DEPLOYMENT_DATA",r[r.CONSTRUCTOR=13]="CONSTRUCTOR",r[r.CONSTRUCTOR_ARGS=14]="CONSTRUCTOR_ARGS",r[r.CONTRACT_ADDRESS_V1=15]="CONTRACT_ADDRESS_V1",r[r.CONTRACT_LEAF=16]="CONTRACT_LEAF",r[r.CALL_CONTEXT=17]="CALL_CONTEXT",r[r.CALL_STACK_ITEM=18]="CALL_STACK_ITEM",r[r.CALL_STACK_ITEM_2=19]="CALL_STACK_ITEM_2",r[r.SECRET_HASH=20]="SECRET_HASH",r[r.L2_TO_L1_MSG=21]="L2_TO_L1_MSG",r[r.TX_CONTEXT=22]="TX_CONTEXT",r[r.PUBLIC_LEAF_INDEX=23]="PUBLIC_LEAF_INDEX",r[r.PUBLIC_DATA_LEAF=24]="PUBLIC_DATA_LEAF",r[r.SIGNED_TX_REQUEST=25]="SIGNED_TX_REQUEST",r[r.GLOBAL_VARIABLES=26]="GLOBAL_VARIABLES",r[r.PARTIAL_ADDRESS=27]="PARTIAL_ADDRESS",r[r.BLOCK_HASH=28]="BLOCK_HASH",r[r.SIDE_EFFECT=29]="SIDE_EFFECT",r[r.FEE_PAYLOAD=30]="FEE_PAYLOAD",r[r.COMBINED_PAYLOAD=31]="COMBINED_PAYLOAD",r[r.TX_NULLIFIER=32]="TX_NULLIFIER",r[r.TX_REQUEST=33]="TX_REQUEST",r[r.SIGNATURE_PAYLOAD=34]="SIGNATURE_PAYLOAD",r[r.VK=41]="VK",r[r.PUBLIC_CALLDATA=43]="PUBLIC_CALLDATA",r[r.FUNCTION_ARGS=44]="FUNCTION_ARGS",r[r.AUTHWIT_INNER=45]="AUTHWIT_INNER",r[r.AUTHWIT_OUTER=46]="AUTHWIT_OUTER",r[r.AUTHWIT_NULLIFIER=47]="AUTHWIT_NULLIFIER",r[r.NSK_M=48]="NSK_M",r[r.IVSK_M=49]="IVSK_M",r[r.OVSK_M=50]="OVSK_M",r[r.TSK_M=51]="TSK_M",r[r.PUBLIC_KEYS_HASH=52]="PUBLIC_KEYS_HASH",r[r.NOTE_NULLIFIER=53]="NOTE_NULLIFIER",r[r.SYMMETRIC_KEY=54]="SYMMETRIC_KEY",r[r.SYMMETRIC_KEY_2=55]="SYMMETRIC_KEY_2",r[r.PUBLIC_TX_HASH=56]="PUBLIC_TX_HASH",r[r.PRIVATE_TX_HASH=57]="PRIVATE_TX_HASH",r[r.PARTIAL_NOTE_VALIDITY_COMMITMENT=58]="PARTIAL_NOTE_VALIDITY_COMMITMENT",r}({});BigInt(1e21);const gI=BigInt(0);class Kn{constructor(e,t,n){u(this,"leaf");u(this,"nextKey");u(this,"nextIndex");this.leaf=e,this.nextKey=t,this.nextIndex=n}static get schema(){return R({leaf:Dr.schema,nextKey:q.Fr,nextIndex:q.BigInt}).transform(({leaf:e,nextKey:t,nextIndex:n})=>new Kn(e,t,n))}static get leafSchema(){return Dr.schema}getKey(){return this.leaf.getKey()}getNextKey(){return this.nextKey.toBigInt()}getNextIndex(){return this.nextIndex}asLeaf(){return this.leaf}toBuffer(){return Buffer.concat(this.toHashInputs())}toHashInputs(){return[...this.leaf.toHashInputs(),Buffer.from(this.nextKey.toBuffer()),Buffer.from(pr(this.nextIndex,32))]}toFields(){return this.toHashInputs().map(e=>l.fromBuffer(e))}clone(){return new Kn(this.leaf.clone(),this.nextKey,this.nextIndex)}static random(){return new Kn(Dr.random(),l.random(),BigInt(Math.floor(Math.random()*1e3)))}static empty(){return new Kn(Dr.empty(),l.zero(),0n)}static fromBuffer(e){const t=J.asReader(e);return new Kn(Dr.fromBuffer(t),t.readObject(l),un(t.readBytes(32)))}static fromLeaf(e,t,n){return new Kn(e,new l(t),n)}static clone(e){return e.clone()}}class Dr{constructor(e){u(this,"nullifier");this.nullifier=e}getKey(){return this.nullifier.toBigInt()}toBuffer(){return this.nullifier.toBuffer()}clone(){return new Dr(new l(this.nullifier))}toHashInputs(){return[Buffer.from(this.nullifier.toBuffer())]}static empty(){return new Dr(l.ZERO)}static random(){return new Dr(l.random())}isEmpty(){return this.nullifier.isZero()}updateTo(e){throw new Error("Nullifiers are create only")}static buildDummy(e){return new Dr(new l(e))}static fromBuffer(e){const t=J.asReader(e);return new Dr(t.readObject(l))}static get schema(){return R({nullifier:q.Fr}).transform(({nullifier:e})=>new Dr(e))}}class pn{constructor(e,t,n){u(this,"leaf");u(this,"nextKey");u(this,"nextIndex");this.leaf=e,this.nextKey=t,this.nextIndex=n}static get schema(){return R({leaf:Mr.schema,nextKey:q.Fr,nextIndex:q.BigInt}).transform(({leaf:e,nextKey:t,nextIndex:n})=>new pn(e,t,n))}static get leafSchema(){return Mr.schema}getKey(){return this.leaf.getKey()}getNextKey(){return this.nextKey.toBigInt()}getNextIndex(){return this.nextIndex}asLeaf(){return this.leaf}toBuffer(){return Buffer.concat(this.toHashInputs())}toHashInputs(){return[...this.leaf.toHashInputs(),Buffer.from(pr(this.nextIndex,32)),Buffer.from(this.nextKey.toBuffer())]}clone(){return new pn(this.leaf.clone(),this.nextKey,this.nextIndex)}static random(){return new pn(Mr.buildDummy(BigInt(Math.floor(Math.random()*1e3))),l.random(),BigInt(Math.floor(Math.random()*1e3)))}static empty(){return new pn(Mr.empty(),l.ZERO,0n)}static fromBuffer(e){const t=J.asReader(e),n=Mr.fromBuffer(t),s=un(t.readBytes(32)),i=l.fromBuffer(t);return new pn(n,i,s)}static fromLeaf(e,t,n){return new pn(e,new l(t),n)}static clone(e){return e.clone()}}class Mr{constructor(e,t){u(this,"slot");u(this,"value");this.slot=e,this.value=t}getKey(){return this.slot.toBigInt()}toBuffer(){return le([this.slot,this.value])}clone(){return new Mr(this.slot,this.value)}toHashInputs(){return[this.slot.toBuffer(),this.value.toBuffer()]}static fromBuffer(e){const t=J.asReader(e);return new Mr(l.fromBuffer(t),l.fromBuffer(t))}equals(e){return this.slot.equals(e.slot)&&this.value.equals(e.value)}toString(){return`PublicDataTreeLeaf(${this.slot.toString()}, ${this.value.toString()})`}isEmpty(){return this.slot.isZero()&&this.value.isZero()}updateTo(e){if(!this.slot.equals(e.slot))throw new Error("Invalid update: slots do not match");return new Mr(this.slot,e.value)}static buildDummy(e){return new Mr(new l(e),new l(0))}static empty(){return new Mr(l.ZERO,l.ZERO)}static get schema(){return R({slot:q.Fr,value:q.Fr}).transform(({slot:e,value:t})=>new Mr(e,t))}}class xe{constructor(e,t){u(this,"root");u(this,"nextAvailableLeafIndex");this.root=e,this.nextAvailableLeafIndex=t}static get schema(){return R({root:q.Fr,nextAvailableLeafIndex:q.UInt32}).transform(({root:e,nextAvailableLeafIndex:t})=>new xe(e,t))}getSize(){return this.root.size+4}toBuffer(){return le(this.root,this.nextAvailableLeafIndex)}toFields(){return[this.root,new l(this.nextAvailableLeafIndex)]}toString(){return tt(this.toBuffer())}static fromBuffer(e){const t=J.asReader(e);return new xe(l.fromBuffer(t),t.readNumber())}static fromString(e){return xe.fromBuffer(dt(e))}static fromFields(e){const t=Ee.asReader(e);return new xe(t.readField(),Number(t.readField().toBigInt()))}static zero(){return new xe(l.ZERO,0)}isZero(){return this.root.isZero()&&this.nextAvailableLeafIndex===0}[ue.inspect.custom](){return`AppendOnlyTreeSnapshot { root: ${this.root.toString()}, nextAvailableLeafIndex: ${this.nextAvailableLeafIndex} }`}equals(e){return this.root.equals(e.root)&&this.nextAvailableLeafIndex===e.nextAvailableLeafIndex}static random(){return new xe(l.random(),Math.floor(Math.random()*1e3))}}var Ur=function(r){return r[r.NULLIFIER_TREE=U1]="NULLIFIER_TREE",r[r.NOTE_HASH_TREE=j1]="NOTE_HASH_TREE",r[r.PUBLIC_DATA_TREE=Z1]="PUBLIC_DATA_TREE",r[r.L1_TO_L2_MESSAGE_TREE=z1]="L1_TO_L2_MESSAGE_TREE",r[r.ARCHIVE=V1]="ARCHIVE",r}({});const yI=()=>Object.values(Ur).filter(r=>!isNaN(Number(r)));Ur.NOTE_HASH_TREE+"",Ur.ARCHIVE+"",Ur.L1_TO_L2_MESSAGE_TREE+"",Ur.NULLIFIER_TREE+"",Ur.PUBLIC_DATA_TREE+"";Ur.NULLIFIER_TREE+"",Ur.NOTE_HASH_TREE+"",Ur.PUBLIC_DATA_TREE+"",Ur.L1_TO_L2_MESSAGE_TREE+"",Ur.ARCHIVE+"";const _i=class _i{constructor(e){u(this,"value");if(this.value=e,e>2**(_i.SIZE*8)-1)throw new Error(`Selector must fit in ${_i.SIZE} bytes (got value ${e}).`)}isEmpty(){return this.value===0}toBuffer(e=_i.SIZE){return pr(BigInt(this.value),e)}toString(){return tt(this.toBuffer())}[ue.inspect.custom](){return`Selector<${this.toString()}>`}equals(e){return this.value===e.value}toField(){return new l(BigInt(this.value))}};u(_i,"SIZE",4);let dr=_i;class Vn extends dr{static fromBuffer(e){const t=J.asReader(e),n=Number(un(t.readBytes(dr.SIZE)));return new Vn(n)}static fromField(e){return new Vn(Number(e.toBigInt()))}static async fromSignature(e){if(/\s/.test(e))throw new Error("Signature cannot contain whitespace");const n=(await _p(Buffer.from(e))).toBuffer().slice(-4);return Vn.fromBuffer(n)}static fromString(e){const t=Qm(e);if(t.length!==dr.SIZE)throw new Error(`Invalid EventSelector length ${t.length} (expected ${dr.SIZE}).`);return Vn.fromBuffer(t)}static empty(){return new Vn(0)}static random(){return Vn.fromBuffer(Wr(dr.SIZE))}toJSON(){return this.toString()}static get schema(){return Gr(Vn)}}const Qt=class Qt{constructor(e){u(this,"xCoord");if("length"in e&&e.length!==32)throw new Error(`Invalid AztecAddress length ${e.length}.`);this.xCoord=new l(e)}[ue.inspect.custom](){return`AztecAddress<${this.toString()}>`}static isAddress(e){return/^(0x)?[a-fA-F0-9]{64}$/.test(e)}static zero(){return Qt.ZERO}static fromField(e){return new Qt(e)}static fromBuffer(e){return new Qt(tf(e,l))}static fromFields(e){const t=Ee.asReader(e);return new Qt(t.readField())}static fromBigInt(e){return new Qt(new l(e))}static fromNumber(e){return new Qt(new l(e))}static fromString(e){return new Qt(dt(e))}static async random(){for(;;){const e=new Qt(l.random());if(await e.isValid())return e}}get size(){return this.xCoord.size}equals(e){return this.xCoord.equals(e.xCoord)}isZero(){return this.xCoord.isZero()}async isValid(){return await Qe.YFromX(this.xCoord)!==null}toAddressPoint(){return Qe.fromXAndSign(this.xCoord,!0)}toBuffer(){return this.xCoord.toBuffer()}toBigInt(){return this.xCoord.toBigInt()}toField(){return this.xCoord}toString(){return this.xCoord.toString()}toJSON(){return this.toString()}static get schema(){return Gr(Qt,Qt.isAddress)}};u(Qt,"SIZE_IN_BYTES",l.SIZE_IN_BYTES),u(Qt,"ZERO",new Qt(Buffer.alloc(32,0)));let W=Qt;ii.register("AztecAddress",W);function aA(r){return oA(r)||ag(r)}function oA(r){return r.kind==="struct"&&r.path.endsWith("address::EthAddress")}function ag(r){return r.kind==="struct"&&r.path.endsWith("address::AztecAddress")}function cA(r){return r.kind==="struct"&&r.path.endsWith("types::abis::function_selector::FunctionSelector")}function uA(r){return r.kind==="struct"&&r.fields.length===1&&r.fields[0].name==="inner"&&r.fields[0].type.kind==="field"}function lA(r,e){const t=Buffer.from(r),n=e!==void 0?t.subarray(-(e/8)):t;if(128&n.subarray(0,1).readUInt8()){for(let s=0;s<n.length;s++)n[s]=~n[s];return-(BigInt(`0x${n.toString("hex")}`)+1n)}return BigInt(`0x${n.toString("hex")}`)}class fA{constructor(e,t){u(this,"types");u(this,"flattened");this.types=e,this.flattened=t}decodeNext(e){switch(e.kind){case"field":return this.getNextField().toBigInt();case"integer":{const t=this.getNextField();return e.sign==="signed"?lA(t.toBuffer(),e.width):t.toBigInt()}case"boolean":return!this.getNextField().isZero();case"array":{const t=[];for(let n=0;n<e.length;n+=1)t.push(this.decodeNext(e.type));return t}case"struct":{const t={};if(ag(e))return new W(this.getNextField().toBuffer());for(const n of e.fields)t[n.name]=this.decodeNext(n.type);return t}case"string":{const t=[];for(let n=0;n<e.length;n+=1)t.push(this.getNextField().toBigInt());return t}case"tuple":{const t=[];for(const n of e.fields)t.push(this.decodeNext(n));return t}default:throw new Error(`Unsupported type: ${e}`)}}getNextField(){const e=this.flattened.shift();if(!e)throw new Error("Not enough return values");return e}decode(){if(this.types.length>1)throw new Error("Multiple types not supported");return this.types.length===0?[]:this.decodeNext(this.types[0])}}function dA(r,e){return new fA(r,e.slice()).decode()}class hA{constructor(e,t,n=!1){u(this,"name");u(this,"parameters");u(this,"includeNames");u(this,"separator");this.name=e,this.parameters=t,this.includeNames=n,this.separator=n?", ":","}getParameterType(e){switch(e.kind){case"field":return"Field";case"integer":if(e.sign==="signed")throw new Error("Unsupported type: signed integer");return`u${e.width}`;case"boolean":return"bool";case"array":return`[${this.getParameterType(e.type)};${e.length}]`;case"string":return`str<${e.length}>`;case"struct":return`(${e.fields.map(t=>`${this.decodeParameter(t)}`).join(this.separator)})`;default:throw new Error(`Unsupported type: ${e.kind}`)}}decodeParameter(e){const t=this.getParameterType(e.type);return this.includeNames?`${e.name}: ${t}`:t}decode(){return`${this.name}(${this.parameters.map(e=>this.decodeParameter(e)).join(this.separator)})`}}function mA(r,e){return new hA(r,e).decode()}class ze extends dr{static fromBuffer(e){const t=J.asReader(e),n=Number(un(t.readBytes(dr.SIZE)));return new ze(n)}static fromField(e){return new ze(Number(e.toBigInt()))}static fromFields(e){const t=Ee.asReader(e);return ze.fromField(t.readField())}static async fromSignature(e){if(/\s/.test(e))throw new Error("Signature cannot contain whitespace");const n=(await _p(Buffer.from(e))).toBuffer().slice(-4);return ze.fromBuffer(n)}static fromString(e){const t=Qm(e);if(t.length!==dr.SIZE)throw new Error(`Invalid FunctionSelector length ${t.length} (expected ${dr.SIZE}).`);return ze.fromBuffer(t)}static empty(){return new ze(0)}static async fromNameAndParameters(e,t){const{name:n,parameters:s}=typeof e=="string"?{name:e,parameters:t}:e,i=mA(n,s);return await this.fromSignature(i)}static random(){return ze.fromBuffer(Wr(dr.SIZE))}toJSON(){return this.toString()}static get schema(){return Gr(ze)}}ii.register("FunctionSelector",ze);class nn extends dr{static fromBuffer(e){const t=J.asReader(e),n=Number(un(t.readBytes(dr.SIZE)));if(n>=128)throw new Error(`Invalid note selector: ${n}`);return new nn(n)}static fromString(e){const t=e.replace(/^0x/i,"").slice(-8),n=Buffer.from(t,"hex");return nn.fromBuffer(n)}static fromField(e){return new nn(Number(e.toBigInt()))}static empty(){return new nn(0)}static random(){const e=Yl(128);return nn.fromField(new l(e))}toJSON(){return this.toString()}static get schema(){return Gr(nn)}}ii.register("NoteSelector",nn);const C={EthAddress:q.EthAddress,Fr:q.Fr,BigInt:q.BigInt,Integer:q.Integer,Buffer:q.Buffer,BufferHex:q.BufferHex,AztecAddress:W.schema,NoteSelector:nn.schema,FunctionSelector:ze.schema,EventSelector:Vn.schema},$a=Yt([C.BigInt,et(),C.AztecAddress,ee(Bn(()=>$a)),fr(Bn(()=>$a))]);class Ha{constructor(e,t,n){u(this,"index");u(this,"leafPreimage");u(this,"siblingPath");this.index=e,this.leafPreimage=t,this.siblingPath=n}static get schema(){return R({index:C.BigInt,leafPreimage:Kn.schema,siblingPath:Et.schemaFor(cc)}).transform(({index:e,leafPreimage:t,siblingPath:n})=>new Ha(e,t,n))}static random(){return new Ha(BigInt(Math.floor(Math.random()*1e3)),Kn.random(),Et.random(cc))}toFields(){return[new l(this.index),...this.leafPreimage.toFields(),...this.siblingPath.toFields()]}toNoirRepresentation(){return[new l(this.index).toString(),...this.leafPreimage.toFields().map(e=>e.toString()),this.siblingPath.toFields().map(e=>e.toString())]}}class gi{constructor(e,t,n){u(this,"index");u(this,"leafPreimage");u(this,"siblingPath");this.index=e,this.leafPreimage=t,this.siblingPath=n}static get schema(){return R({index:C.BigInt,leafPreimage:pn.schema,siblingPath:Et.schemaFor(ba)}).transform(({index:e,leafPreimage:t,siblingPath:n})=>new gi(e,t,n))}toFields(){return[new l(this.index),new l(this.leafPreimage.leaf.slot),new l(this.leafPreimage.leaf.value),new l(this.leafPreimage.nextIndex),new l(this.leafPreimage.nextKey),...this.siblingPath.toFields()]}toNoirRepresentation(){return[new l(this.index).toString(),new l(this.leafPreimage.leaf.slot).toString(),new l(this.leafPreimage.leaf.value).toString(),new l(this.leafPreimage.nextKey).toString(),new l(this.leafPreimage.nextIndex).toString(),this.siblingPath.toFields().map(e=>e.toString())]}toBuffer(){return le([this.index,this.leafPreimage,this.siblingPath])}toString(){return tt(this.toBuffer())}static random(){return new gi(BigInt(Math.floor(Math.random()*1e3)),pn.random(),Et.random(ba))}static fromBuffer(e){const t=J.asReader(e);return new gi(un(t.readBytes(32)),t.readObject(pn),Et.fromBuffer(t.readBytes(4+32*ba)))}static fromString(e){return gi.fromBuffer(dt(e))}}function pA(r){return Xi(r)}function bI(r,e){return wt([r,e],nt.NOTE_HASH_NONCE)}function wI(r,e){return wt([r,e],nt.SILOED_NOTE_HASH)}function vI(r,e){return wt([r,e],nt.UNIQUE_NOTE_HASH)}function gA(r,e){return wt([r,e],nt.OUTER_NULLIFIER)}function EI(r,e){return wt([r,e],nt.PUBLIC_LEAF_INDEX)}function og(r){return r.length===0?Promise.resolve(l.ZERO):wt(r,nt.FUNCTION_ARGS)}function cg(r){return r.length===0?Promise.resolve(l.ZERO):wt(r,nt.PUBLIC_CALLDATA)}function SI(r){return wt([r],nt.SECRET_HASH)}async function AI(r,e,t){const n=await wt([e,t],nt.MESSAGE_NULLIFIER);return gA(r,n)}class Gt{constructor(e,t,n,s){u(this,"masterNullifierPublicKey");u(this,"masterIncomingViewingPublicKey");u(this,"masterOutgoingViewingPublicKey");u(this,"masterTaggingPublicKey");this.masterNullifierPublicKey=e,this.masterIncomingViewingPublicKey=t,this.masterOutgoingViewingPublicKey=n,this.masterTaggingPublicKey=s}static get schema(){return R({masterNullifierPublicKey:q.Point,masterIncomingViewingPublicKey:q.Point,masterOutgoingViewingPublicKey:q.Point,masterTaggingPublicKey:q.Point}).transform(Gt.from)}static from(e){return new Gt(e.masterNullifierPublicKey,e.masterIncomingViewingPublicKey,e.masterOutgoingViewingPublicKey,e.masterTaggingPublicKey)}hash(){return this.isEmpty()?l.ZERO:wt([this.masterNullifierPublicKey,this.masterIncomingViewingPublicKey,this.masterOutgoingViewingPublicKey,this.masterTaggingPublicKey],nt.PUBLIC_KEYS_HASH)}isEmpty(){return this.masterNullifierPublicKey.isZero()&&this.masterIncomingViewingPublicKey.isZero()&&this.masterOutgoingViewingPublicKey.isZero()&&this.masterTaggingPublicKey.isZero()}static default(){return new Gt(new Qe(new l(G1),new l(K1),!1),new Qe(new l(Y1),new l(X1),!1),new Qe(new l(J1),new l(Q1),!1),new Qe(new l(eA),new l(tA),!1))}static async random(){return new Gt(await Qe.random(),await Qe.random(),await Qe.random(),await Qe.random())}equals(e){return this.masterNullifierPublicKey.equals(e.masterNullifierPublicKey)&&this.masterIncomingViewingPublicKey.equals(e.masterIncomingViewingPublicKey)&&this.masterOutgoingViewingPublicKey.equals(e.masterOutgoingViewingPublicKey)&&this.masterTaggingPublicKey.equals(e.masterTaggingPublicKey)}toBuffer(){return le([this.masterNullifierPublicKey,this.masterIncomingViewingPublicKey,this.masterOutgoingViewingPublicKey,this.masterTaggingPublicKey])}static fromBuffer(e){const t=J.asReader(e),n=t.readObject(Qe),s=t.readObject(Qe),i=t.readObject(Qe),a=t.readObject(Qe);return new Gt(n,s,i,a)}toNoirStruct(){return{npk_m:this.masterNullifierPublicKey.toWrappedNoirStruct(),ivpk_m:this.masterIncomingViewingPublicKey.toWrappedNoirStruct(),ovpk_m:this.masterOutgoingViewingPublicKey.toWrappedNoirStruct(),tpk_m:this.masterTaggingPublicKey.toWrappedNoirStruct()}}toFields(){return[...this.masterNullifierPublicKey.toFields(),...this.masterIncomingViewingPublicKey.toFields(),...this.masterOutgoingViewingPublicKey.toFields(),...this.masterTaggingPublicKey.toFields()]}encodeToNoir(){return this.toFields()}static fromFields(e){const t=Ee.asReader(e);return new Gt(t.readObject(Qe),t.readObject(Qe),t.readObject(Qe),t.readObject(Qe))}toString(){return tt(this.toBuffer())}static fromString(e){return Gt.fromBuffer(Buffer.from(Xa(e),"hex"))}}function yA(r){const e=`${r.toUpperCase()}SK_M`;return nt[e]}function _I(r,e){return bA(r,e,"n")}function bA(r,e,t){const n=yA(t);return wt([r.hi,r.lo,e],n)}function wA(r){return eo([r,nt.NSK_M])}function vA(r){return eo([r,nt.IVSK_M])}function EA(r){return eo([r,nt.OVSK_M])}function BI(r){return eo([r,nt.IVSK_M])}function of(r,e){return wt([r,e],nt.CONTRACT_ADDRESS_V1)}async function xl(r,e){const t=await of(await r.hash(),e),n=await new La().add(await yi(new Tn(t.toBigInt())),r.masterIncomingViewingPublicKey);return new W(n.x)}async function SA(r,e){const t=e.add(new Tn(r.toBigInt()));return(await yi(t)).y.toBigInt()<=(l.MODULUS-1n)/2n?t:new Tn(Tn.MODULUS-t.toBigInt())}function yi(r){const e=new La;return e.mul(e.generator(),r)}async function AA(r){const e=wA(r),t=vA(r),n=EA(r),s=eo([r,nt.TSK_M]),i=await yi(e),a=await yi(t),o=await yi(n),c=await yi(s),f=new Gt(i,a,o,c);return{masterNullifierSecretKey:e,masterIncomingViewingSecretKey:t,masterOutgoingViewingSecretKey:n,masterTaggingSecretKey:s,publicKeys:f}}async function _A(r,e,t){const n=await of(await r.publicKeys.hash(),r.partialAddress),s=await t.toAddressPoint();return new La().mul(s,await SA(n,e))}async function TI(r,e,t,n){const s=await _A(r,e,t);return Xi([s.x,s.y,n])}class Os{constructor(e){u(this,"items");this.items=e}toBuffer(){return le(this.items.length,this.items)}toFriendlyJSON(){return this.items}}var xI=function(r){return r[r.STANDARD=0]="STANDARD",r[r.ULTRA=1]="ULTRA",r}({});class Qn{constructor(e,t){u(this,"requestHash");u(this,"witness");this.requestHash=e,this.witness=t.map(n=>new l(n))}static get schema(){return Gr(Qn)}toJSON(){return this.toString()}toBuffer(){return le(this.requestHash,new Os(this.witness))}static fromBuffer(e){const t=J.asReader(e);return new Qn(l.fromBuffer(t),t.readVector(l))}toString(){return tt(this.toBuffer())}static fromString(e){return Qn.fromBuffer(dt(e))}static random(){return new Qn(l.random(),[l.random(),l.random(),l.random()])}}const II=r=>wt(r,nt.AUTHWIT_INNER),OI=(r,e,t,n)=>wt([r.toField(),e,t,n],nt.AUTHWIT_OUTER);R({l1StartBlock:C.BigInt,l1GenesisTime:C.BigInt,slotDuration:se(),epochDuration:se(),ethereumSlotDuration:se(),proofSubmissionWindow:se()});function BA(r,e){const t=r*BigInt(e.epochDuration);return[t,t+BigInt(e.epochDuration)-1n]}function RI(r,e){const[t,n]=BA(r,e),s=e.slotDuration/e.ethereumSlotDuration;return[e.l1GenesisTime+t*BigInt(e.slotDuration),e.l1GenesisTime+n*BigInt(e.slotDuration)+BigInt((s-1)*e.ethereumSlotDuration)]}const Ct=32;class hr{constructor(e,t,n,s){u(this,"numTxs");u(this,"blobsHash");u(this,"inHash");u(this,"outHash");if(this.numTxs=e,this.blobsHash=t,this.inHash=n,this.outHash=s,t.length!==Ct)throw new Error(`blobsHash buffer must be ${Ct} bytes`);if(t[0]!==0)throw new Error("blobsHash buffer should be truncated and left padded");if(n.length!==Ct)throw new Error(`inHash buffer must be ${Ct} bytes`);if(n[0]!==0)throw new Error("inHash buffer should be truncated and left padded");if(s.length!==Ct)throw new Error(`outHash buffer must be ${Ct} bytes`);if(s[0]!==0)throw new Error("outHash buffer should be truncated and left padded")}static get schema(){return R({numTxs:q.Fr,blobsHash:q.Buffer,inHash:q.Buffer,outHash:q.Buffer}).transform(({numTxs:e,blobsHash:t,inHash:n,outHash:s})=>new hr(e,t,n,s))}getSize(){return this.toBuffer().length}toBuffer(){return le(this.numTxs,this.blobsHash,this.inHash,this.outHash)}toInspect(){return{numTxs:this.numTxs.toNumber(),blobsHash:tt(this.blobsHash),inHash:tt(this.inHash),outHash:tt(this.outHash)}}toFields(){const e=[this.numTxs,l.fromBuffer(this.blobsHash),l.fromBuffer(this.inHash),l.fromBuffer(this.outHash)];if(e.length!==Dd)throw new Error(`Expected content commitment to have ${Dd} fields, but it has ${e.length} fields`);return e}static fromBuffer(e){const t=J.asReader(e);return new hr(t.readObject(l),t.readBytes(Ct),t.readBytes(Ct),t.readBytes(Ct))}static fromFields(e){const t=Ee.asReader(e);return new hr(t.readField(),t.readField().toBuffer(),t.readField().toBuffer(),t.readField().toBuffer())}static empty(){return new hr(l.zero(),Buffer.alloc(Ct),Buffer.alloc(Ct),Buffer.alloc(Ct))}isEmpty(){return this.numTxs.isZero()&&this.blobsHash.equals(Buffer.alloc(Ct))&&this.inHash.equals(Buffer.alloc(Ct))&&this.outHash.equals(Buffer.alloc(Ct))}toString(){return tt(this.toBuffer())}static fromString(e){const t=Buffer.from(e.replace(/^0x/i,""),"hex");return hr.fromBuffer(t)}equals(e){return this.inHash.equals(e.inHash)&&this.outHash.equals(e.outHash)&&this.numTxs.equals(e.numTxs)&&this.blobsHash.equals(e.blobsHash)}}function TA(r,e){return e.parseAsync(JSON.parse(r))}function cf(r,e){return JSON.stringify(r,(t,n)=>typeof n=="bigint"?n.toString():typeof n=="object"&&n&&n.type==="Buffer"&&Array.isArray(n.data)?$o.Buffer.from(n.data).toString("base64"):typeof n=="object"&&n&&$o.Buffer.isBuffer(n)?n.toString("base64"):typeof n=="object"&&n instanceof Map?Array.from(n.entries()):typeof n=="object"&&n instanceof Set?Array.from(n.values()):n,0)}class Ye{constructor(e,t){u(this,"feePerDaGas");u(this,"feePerL2Gas");this.feePerDaGas=new l(e),this.feePerL2Gas=new l(t)}static get schema(){return R({feePerDaGas:q.Fr,feePerL2Gas:q.Fr}).transform(Ye.from)}clone(){return new Ye(this.feePerDaGas,this.feePerL2Gas)}equals(e){return this.feePerDaGas.equals(e.feePerDaGas)&&this.feePerL2Gas.equals(e.feePerL2Gas)}get(e){switch(e){case"da":return this.feePerDaGas;case"l2":return this.feePerL2Gas}}mul(e){return e===1||e===1n?this.clone():typeof e=="bigint"?new Ye(new l(this.feePerDaGas.toBigInt()*e),new l(this.feePerL2Gas.toBigInt()*e)):new Ye(new l(this.feePerDaGas.toNumberUnsafe()*e),new l(this.feePerL2Gas.toNumberUnsafe()*e))}static from(e){return new Ye(e.feePerDaGas,e.feePerL2Gas)}static random(){return new Ye(l.random(),l.random())}static empty(){return new Ye(l.ZERO,l.ZERO)}isEmpty(){return this.feePerDaGas.isZero()&&this.feePerL2Gas.isZero()}static fromBuffer(e){const t=J.asReader(e);return new Ye(t.readObject(l),t.readObject(l))}toBuffer(){return le(this.feePerDaGas,this.feePerL2Gas)}static fromFields(e){const t=Ee.asReader(e);return new Ye(t.readField(),t.readField())}toFields(){return Je(this.feePerDaGas,this.feePerL2Gas)}toInspect(){return{feePerDaGas:this.feePerDaGas.toNumberUnsafe(),feePerL2Gas:this.feePerL2Gas.toNumberUnsafe()}}[ue.inspect.custom](){return`GasFees { feePerDaGas=${this.feePerDaGas.toBigInt()} feePerL2Gas=${this.feePerL2Gas.toBigInt()} }`}}class It{constructor(e,t,n,s,i,a,o,c){u(this,"chainId");u(this,"version");u(this,"blockNumber");u(this,"slotNumber");u(this,"timestamp");u(this,"coinbase");u(this,"feeRecipient");u(this,"gasFees");this.chainId=e,this.version=t,this.blockNumber=n,this.slotNumber=s,this.timestamp=i,this.coinbase=a,this.feeRecipient=o,this.gasFees=c}static get schema(){return R({chainId:C.Fr,version:C.Fr,blockNumber:C.Fr,slotNumber:C.Fr,timestamp:C.Fr,coinbase:C.EthAddress,feeRecipient:C.AztecAddress,gasFees:Ye.schema}).transform(It.from)}getSize(){return this.toBuffer().length}static from(e){return new It(...It.getFields(e))}static empty(e={}){return It.from({blockNumber:l.ZERO,slotNumber:l.ZERO,timestamp:l.ZERO,chainId:l.ZERO,version:l.ZERO,coinbase:gr.ZERO,feeRecipient:W.ZERO,gasFees:Ye.empty(),...e})}static fromBuffer(e){const t=J.asReader(e);return new It(l.fromBuffer(t),l.fromBuffer(t),l.fromBuffer(t),l.fromBuffer(t),l.fromBuffer(t),t.readObject(gr),t.readObject(W),t.readObject(Ye))}static fromFields(e){const t=Ee.asReader(e);return new It(t.readField(),t.readField(),t.readField(),t.readField(),t.readField(),gr.fromField(t.readField()),W.fromField(t.readField()),Ye.fromFields(t))}static getFields(e){return[e.chainId,e.version,e.blockNumber,e.slotNumber,e.timestamp,e.coinbase,e.feeRecipient,e.gasFees]}toBuffer(){return le(...It.getFields(this))}toFields(){const e=Je(...It.getFields(this));if(e.length!==Ud)throw new Error(`Invalid number of fields for GlobalVariables. Expected ${Ud}, got ${e.length}`);return e}toFriendlyJSON(){return{blockNumber:this.blockNumber.toNumber(),slotNumber:this.slotNumber.toNumber(),timestamp:this.timestamp.toString(),coinbase:this.coinbase.toString(),gasFees:cf(this.gasFees)}}clone(){return It.fromBuffer(this.toBuffer())}isEmpty(){return this.chainId.isZero()&&this.version.isZero()&&this.blockNumber.isZero()&&this.slotNumber.isZero()&&this.timestamp.isZero()&&this.coinbase.isZero()&&this.feeRecipient.isZero()&&this.gasFees.isEmpty()}toInspect(){return{chainId:this.chainId.toNumber(),version:this.version.toNumber(),blockNumber:this.blockNumber.toNumber(),slotNumber:this.slotNumber.toNumber(),timestamp:this.timestamp.toNumber(),coinbase:this.coinbase.toString(),feeRecipient:this.feeRecipient.toString(),feePerDaGas:this.gasFees.feePerDaGas.toNumber(),feePerL2Gas:this.gasFees.feePerL2Gas.toNumber()}}[ue.inspect.custom](){return`GlobalVariables ${ue.inspect(this.toInspect())}`}equals(e){return this.chainId.equals(e.chainId)&&this.version.equals(e.version)&&this.blockNumber.equals(e.blockNumber)&&this.slotNumber.equals(e.slotNumber)&&this.timestamp.equals(e.timestamp)&&this.coinbase.equals(e.coinbase)&&this.feeRecipient.equals(e.feeRecipient)&&this.gasFees.equals(e.gasFees)}}const ug=["da","l2"];class ke{constructor(e,t){u(this,"daGas");u(this,"l2Gas");this.daGas=e,this.l2Gas=t}static get schema(){return R({daGas:q.UInt32,l2Gas:q.UInt32}).transform(ke.from)}clone(){return new ke(this.daGas,this.l2Gas)}get(e){return this[`${e}Gas`]}equals(e){return this.daGas===e.daGas&&this.l2Gas===e.l2Gas}static from(e){return new ke(e.daGas??0,e.l2Gas??0)}static empty(){return new ke(0,0)}static random(){return new ke(Math.floor(Math.random()*1e9),Math.floor(Math.random()*1e9))}isEmpty(){return this.daGas===0&&this.l2Gas===0}static fromBuffer(e){const t=J.asReader(e);return new ke(t.readNumber(),t.readNumber())}toBuffer(){return le(this.daGas,this.l2Gas)}[ue.inspect.custom](){return`Gas { daGas=${this.daGas} l2Gas=${this.l2Gas} }`}add(e){return new ke(this.daGas+e.daGas,this.l2Gas+e.l2Gas)}sub(e){return new ke(this.daGas-e.daGas,this.l2Gas-e.l2Gas)}mul(e){return new ke(Math.ceil(this.daGas*e),Math.ceil(this.l2Gas*e))}gtAny(e){return this.daGas>e.daGas||this.l2Gas>e.l2Gas}computeFee(e){return ug.reduce((t,n)=>t.add(e.get(n).mul(new l(this.get(n)))),l.ZERO)}toFields(){return Je(this.daGas,this.l2Gas)}static fromFields(e){const t=Ee.asReader(e);return new ke(t.readU32(),t.readU32())}}class qt{constructor(e,t,n,s){u(this,"gasLimits");u(this,"teardownGasLimits");u(this,"maxFeesPerGas");u(this,"maxPriorityFeesPerGas");this.gasLimits=e,this.teardownGasLimits=t,this.maxFeesPerGas=n,this.maxPriorityFeesPerGas=s}static get schema(){return R({gasLimits:ke.schema,teardownGasLimits:ke.schema,maxFeesPerGas:Ye.schema,maxPriorityFeesPerGas:Ye.schema}).transform(qt.from)}getSize(){return this.toBuffer().length}static from(e){return new qt(ke.from(e.gasLimits),ke.from(e.teardownGasLimits),Ye.from(e.maxFeesPerGas),Ye.from(e.maxPriorityFeesPerGas))}clone(){return new qt(this.gasLimits.clone(),this.teardownGasLimits.clone(),this.maxFeesPerGas.clone(),this.maxPriorityFeesPerGas.clone())}getFeeLimit(){return ug.reduce((e,t)=>this.maxFeesPerGas.get(t).mul(new l(this.gasLimits.get(t))).add(e),l.ZERO)}static empty(){return new qt(ke.empty(),ke.empty(),Ye.empty(),Ye.empty())}static default(e){return qt.from({gasLimits:e.gasLimits??{l2Gas:lh,daGas:lh},teardownGasLimits:e.teardownGasLimits??{l2Gas:fh,daGas:fh},maxFeesPerGas:e.maxFeesPerGas,maxPriorityFeesPerGas:e.maxPriorityFeesPerGas??Ye.empty()})}isEmpty(){return this.gasLimits.isEmpty()&&this.teardownGasLimits.isEmpty()&&this.maxFeesPerGas.isEmpty()&&this.maxPriorityFeesPerGas.isEmpty()}equals(e){return this.gasLimits.equals(e.gasLimits)&&this.teardownGasLimits.equals(e.teardownGasLimits)&&this.maxFeesPerGas.equals(e.maxFeesPerGas)&&this.maxPriorityFeesPerGas.equals(e.maxPriorityFeesPerGas)}static fromBuffer(e){const t=J.asReader(e);return new qt(t.readObject(ke),t.readObject(ke),t.readObject(Ye),t.readObject(Ye))}toBuffer(){return le(...qt.getFields(this))}static fromFields(e){const t=Ee.asReader(e);return new qt(t.readObject(ke),t.readObject(ke),t.readObject(Ye),t.readObject(Ye))}toFields(){const e=Je(...qt.getFields(this));if(e.length!==$d)throw new Error(`Invalid number of fields for GasSettings. Expected ${$d} but got ${e.length}`);return e}static getFields(e){return[e.gasLimits,e.teardownGasLimits,e.maxFeesPerGas,e.maxPriorityFeesPerGas]}}class gs{constructor(e,t,n,s,i,a,o,c){u(this,"lastArchiveRoot");u(this,"contentCommitment");u(this,"slotNumber");u(this,"timestamp");u(this,"coinbase");u(this,"feeRecipient");u(this,"gasFees");u(this,"totalManaUsed");this.lastArchiveRoot=e,this.contentCommitment=t,this.slotNumber=n,this.timestamp=s,this.coinbase=i,this.feeRecipient=a,this.gasFees=o,this.totalManaUsed=c}static get schema(){return R({lastArchiveRoot:C.Fr,contentCommitment:hr.schema,slotNumber:C.Fr,timestamp:C.BigInt,coinbase:C.EthAddress,feeRecipient:C.AztecAddress,gasFees:Ye.schema,totalManaUsed:C.Fr}).transform(gs.from)}static getFields(e){return[e.lastArchiveRoot,e.contentCommitment,e.slotNumber,e.timestamp,e.coinbase,e.feeRecipient,e.gasFees,e.totalManaUsed]}static from(e){return new gs(...gs.getFields(e))}static fromBuffer(e){const t=J.asReader(e);return new gs(t.readObject(l),t.readObject(hr),l.fromBuffer(t),t.readUInt64(),t.readObject(gr),t.readObject(W),t.readObject(Ye),t.readObject(l))}toBuffer(){return le([this.lastArchiveRoot,this.contentCommitment,this.slotNumber,QE(this.timestamp),this.coinbase,this.feeRecipient,this.gasFees,this.totalManaUsed])}hash(){return C1([this.toBuffer()])}static empty(e={}){return gs.from({lastArchiveRoot:l.ZERO,contentCommitment:hr.empty(),slotNumber:l.ZERO,timestamp:0n,coinbase:gr.ZERO,feeRecipient:W.ZERO,gasFees:Ye.empty(),totalManaUsed:l.ZERO,...e})}isEmpty(){return this.lastArchiveRoot.isZero()&&this.contentCommitment.isEmpty()&&this.slotNumber.isZero()&&this.timestamp===0n&&this.coinbase.isZero()&&this.feeRecipient.isZero()&&this.gasFees.isEmpty()&&this.totalManaUsed.isZero()}toString(){return tt(this.toBuffer())}static fromString(e){return gs.fromBuffer(dt(e))}toInspect(){return{lastArchive:this.lastArchiveRoot.toString(),contentCommitment:this.contentCommitment.toInspect(),slotNumber:this.slotNumber.toBigInt(),timestamp:this.timestamp,coinbase:this.coinbase.toString(),feeRecipient:this.feeRecipient.toString(),gasFees:this.gasFees.toInspect(),totalManaUsed:this.totalManaUsed.toBigInt()}}[ue.inspect.custom](){const e=`da:${this.gasFees.feePerDaGas.toBigInt()}, l2:${this.gasFees.feePerL2Gas.toBigInt()}`;return`Header {
  lastArchiveRoot: ${this.lastArchiveRoot.toString()},
  contentCommitment: ${ue.inspect(this.contentCommitment)},
  slotNumber: ${this.slotNumber.toBigInt()},
  timestamp: ${this.timestamp},
  coinbase: ${this.coinbase.toString()},
  feeRecipient: ${this.feeRecipient.toString()},
  gasFees: ${e},
  totalManaUsed: ${this.totalManaUsed.toBigInt()},
}`}}class vn{constructor(e,t,n){u(this,"noteHashTree");u(this,"nullifierTree");u(this,"publicDataTree");this.noteHashTree=e,this.nullifierTree=t,this.publicDataTree=n}static get schema(){return R({noteHashTree:xe.schema,nullifierTree:xe.schema,publicDataTree:xe.schema}).transform(({noteHashTree:e,nullifierTree:t,publicDataTree:n})=>new vn(e,t,n))}getSize(){return this.noteHashTree.getSize()+this.nullifierTree.getSize()+this.publicDataTree.getSize()}static fromBuffer(e){const t=J.asReader(e);return new vn(t.readObject(xe),t.readObject(xe),t.readObject(xe))}static fromFields(e){const t=Ee.asReader(e),n=xe.fromFields(t),s=xe.fromFields(t),i=xe.fromFields(t);return new vn(n,s,i)}static empty(){return new vn(xe.zero(),xe.zero(),xe.zero())}toBuffer(){return le(this.noteHashTree,this.nullifierTree,this.publicDataTree)}toFields(){const e=[...this.noteHashTree.toFields(),...this.nullifierTree.toFields(),...this.publicDataTree.toFields()];if(e.length!==Wd)throw new Error(`Invalid number of fields for PartialStateReference. Expected ${Wd}, got ${e.length}`);return e}isEmpty(){return this.noteHashTree.isZero()&&this.nullifierTree.isZero()&&this.publicDataTree.isZero()}equals(e){return this.noteHashTree.equals(e.noteHashTree)&&this.nullifierTree.equals(e.nullifierTree)&&this.publicDataTree.equals(e.publicDataTree)}}class En{constructor(e,t){u(this,"l1ToL2MessageTree");u(this,"partial");this.l1ToL2MessageTree=e,this.partial=t}static get schema(){return R({l1ToL2MessageTree:xe.schema,partial:vn.schema}).transform(({l1ToL2MessageTree:e,partial:t})=>new En(e,t))}getSize(){return this.l1ToL2MessageTree.getSize()+this.partial.getSize()}toBuffer(){return le(this.l1ToL2MessageTree,this.partial)}toFields(){const e=[...this.l1ToL2MessageTree.toFields(),...this.partial.toFields()];if(e.length!==Qd)throw new Error(`Invalid number of fields for StateReference. Expected ${Qd}, got ${e.length}`);return e}static fromBuffer(e){const t=J.asReader(e);return new En(t.readObject(xe),t.readObject(vn))}static fromFields(e){const t=Ee.asReader(e),n=xe.fromFields(t),s=vn.fromFields(t);return new En(n,s)}static empty(){return new En(xe.zero(),vn.empty())}isEmpty(){return this.l1ToL2MessageTree.isZero()&&this.partial.isEmpty()}toInspect(){return{l1ToL2MessageTree:this.l1ToL2MessageTree.root.toString(),noteHashTree:this.partial.noteHashTree.root.toString(),nullifierTree:this.partial.nullifierTree.root.toString(),publicDataTree:this.partial.publicDataTree.root.toString()}}[ue.inspect.custom](){return`StateReference {
  l1ToL2MessageTree: ${ue.inspect(this.l1ToL2MessageTree)},
  noteHashTree: ${ue.inspect(this.partial.noteHashTree)},
  nullifierTree: ${ue.inspect(this.partial.nullifierTree)},
  publicDataTree: ${ue.inspect(this.partial.publicDataTree)},
}`}equals(e){return this.l1ToL2MessageTree.root.equals(e.l1ToL2MessageTree.root)&&this.partial.equals(e.partial)}}class ct{constructor(e,t,n,s,i,a){u(this,"lastArchive");u(this,"contentCommitment");u(this,"state");u(this,"globalVariables");u(this,"totalFees");u(this,"totalManaUsed");this.lastArchive=e,this.contentCommitment=t,this.state=n,this.globalVariables=s,this.totalFees=i,this.totalManaUsed=a}static get schema(){return R({lastArchive:xe.schema,contentCommitment:hr.schema,state:En.schema,globalVariables:It.schema,totalFees:q.Fr,totalManaUsed:q.Fr}).transform(ct.from)}static getFields(e){return[e.lastArchive,e.contentCommitment,e.state,e.globalVariables,e.totalFees,e.totalManaUsed]}static from(e){return new ct(...ct.getFields(e))}getSlot(){return this.globalVariables.slotNumber.toBigInt()}getBlockNumber(){return this.globalVariables.blockNumber.toNumber()}getSize(){return this.lastArchive.getSize()+this.contentCommitment.getSize()+this.state.getSize()+this.globalVariables.getSize()+this.totalFees.size+this.totalManaUsed.size}toBuffer(){return le(...ct.getFields(this))}toFields(){const e=Je(...ct.getFields(this));if(e.length!==nh)throw new Error(`Invalid number of fields for Header. Expected ${nh}, got ${e.length}`);return e}clone(){return ct.fromBuffer(this.toBuffer())}static fromBuffer(e){const t=J.asReader(e);return new ct(t.readObject(xe),t.readObject(hr),t.readObject(En),t.readObject(It),t.readObject(l),t.readObject(l))}static fromFields(e){const t=Ee.asReader(e);return new ct(xe.fromFields(t),hr.fromFields(t),En.fromFields(t),It.fromFields(t),t.readField(),t.readField())}static empty(e={}){return ct.from({lastArchive:xe.zero(),contentCommitment:hr.empty(),state:En.empty(),globalVariables:It.empty(),totalFees:l.ZERO,totalManaUsed:l.ZERO,...e})}isEmpty(){return this.lastArchive.isZero()&&this.contentCommitment.isEmpty()&&this.state.isEmpty()&&this.globalVariables.isEmpty()&&this.totalFees.isZero()&&this.totalManaUsed.isZero()}toString(){return tt(this.toBuffer())}static fromString(e){return ct.fromBuffer(dt(e))}hash(){return wt(this.toFields(),nt.BLOCK_HASH)}toPropose(){return new gs(this.lastArchive.root,this.contentCommitment,this.globalVariables.slotNumber,this.globalVariables.timestamp.toBigInt(),this.globalVariables.coinbase,this.globalVariables.feeRecipient,this.globalVariables.gasFees,this.totalManaUsed)}toInspect(){return{lastArchive:this.lastArchive.root.toString(),contentCommitment:this.contentCommitment.toInspect(),state:this.state.toInspect(),globalVariables:this.globalVariables.toInspect(),totalFees:this.totalFees.toBigInt(),totalManaUsed:this.totalManaUsed.toBigInt()}}[ue.inspect.custom](){return`Header {
  lastArchive: ${ue.inspect(this.lastArchive)},
  contentCommitment.numTxs: ${this.contentCommitment.numTxs.toNumber()},
  contentCommitment.blobsHash: ${this.contentCommitment.blobsHash.toString("hex")},
  contentCommitment.inHash: ${this.contentCommitment.inHash.toString("hex")},
  contentCommitment.outHash: ${this.contentCommitment.outHash.toString("hex")},
  state.l1ToL2MessageTree: ${ue.inspect(this.state.l1ToL2MessageTree)},
  state.noteHashTree: ${ue.inspect(this.state.partial.noteHashTree)},
  state.nullifierTree: ${ue.inspect(this.state.partial.nullifierTree)},
  state.publicDataTree: ${ue.inspect(this.state.partial.publicDataTree)},
  globalVariables: ${ue.inspect(this.globalVariables)},
  totalFees: ${this.totalFees},
  totalManaUsed: ${this.totalManaUsed},
}`}equals(e){return this.contentCommitment.equals(e.contentCommitment)&&this.state.equals(e.state)&&this.globalVariables.equals(e.globalVariables)&&this.totalFees.equals(e.totalFees)&&this.totalManaUsed.equals(e.totalManaUsed)&&this.lastArchive.equals(e.lastArchive)}}const xA=Fs("aztec:foundation:abi"),Oo=Ql("kind",[R({kind:st("boolean"),value:et()}),R({kind:st("string"),value:we()}),R({kind:st("array"),value:ee(Bn(()=>Oo))}),R({kind:st("tuple"),fields:ee(Bn(()=>Oo))}),R({kind:st("integer"),value:we(),sign:et()}),R({kind:st("struct"),fields:ee(R({name:we(),value:Bn(()=>Oo)}))})]),lg=["public","private","databus"],IA=["unsigned","signed"],os=Ql("kind",[R({kind:st("field")}),R({kind:st("boolean")}),R({kind:st("integer"),sign:Ka(IA),width:se()}),R({kind:st("array"),length:se(),type:Bn(()=>os)}),R({kind:st("string"),length:se()}),R({kind:st("struct"),fields:ee(Bn(()=>fg)),path:we()}),R({kind:st("tuple"),fields:ee(Bn(()=>os))})]),fg=R({name:we(),type:os});fg.and(R({visibility:Ka(lg)}));const OA=Yt([R({error_kind:st("string"),string:we()}),R({error_kind:st("fmtstring"),length:se(),item_types:ee(os)}),R({error_kind:st("custom")}).and(os)]);var tr=function(r){return r.PRIVATE="private",r.PUBLIC="public",r.UTILITY="utility",r}({});const dg=R({name:we(),functionType:Ya(tr),isInternal:et(),isStatic:et(),isInitializer:et(),parameters:ee(R({name:we(),type:os,visibility:Ka(lg)})),returnTypes:ee(os),errorTypes:fr(OA)}),RA=R({debugSymbols:R({location_tree:R({locations:ee(R({parent:se().nullable(),value:R({span:R({start:se(),end:se()}),file:se()})}))}),acir_locations:fr(se()),brillig_locations:fr(fr(se()))}),files:fr(R({source:we(),path:we()}))}),FA=dg.and(R({bytecode:q.Buffer,verificationKey:we().optional(),debugSymbols:we(),debug:RA.optional()})),CA=R({name:we(),index:se(),nullable:et()}),PA=R({id:nn.schema,typ:we(),fields:ee(CA)}),Ks=R({name:we(),functions:ee(FA),nonDispatchPublicFunctions:ee(dg),outputs:R({structs:fr(ee(os)).transform(r=>{for(const[e,t]of Object.entries(r))(e==="events"||e==="functions")&&(r[e]=t.sort((n,s)=>n.path>s.path?-1:1));return r}),globals:fr(ee(Oo))}),storageLayout:fr(R({slot:q.Fr})),notes:fr(PA),fileMap:fr(Fi.number(),R({source:we(),path:we()}))});function FI(r,e){const t=r.functions.find(s=>s.name===e);if(!t)throw new Error(`Unknown function ${e}`);const n=hg(r,t);return{...t,debug:n}}async function CI(r,e){var s;let t;if(typeof e=="string"?t=r.functions.find(i=>i.name===e):t=(s=(await Promise.all(r.functions.map(async a=>({fn:a,selector:await ze.fromNameAndParameters(a.name,a.parameters)})))).find(a=>e.equals(a.selector)))==null?void 0:s.fn,!t)throw new Error(`Unknown function ${e}`);const n=hg(r,t);return{...t,debug:n,contractName:r.name}}function Pc(r){return r.functions.map(e=>e).concat(r.nonDispatchPublicFunctions||[])}function NA(r){return JSON.parse(fb(Buffer.from(r,"base64"),{to:"string",raw:!0})).debug_infos}function hg(r,e){try{if(e.debugSymbols&&r.fileMap)return{debugSymbols:NA(e.debugSymbols)[0],files:r.fileMap}}catch(t){if(t instanceof RangeError&&t.message.includes("Invalid string length"))xA.warn(`Caught RangeError: Invalid string length. This suggests the debug_symbols field of the contract ${r.name} and function ${e.name} is huge; too big to parse. We'll skip returning this info until this issue is resolved. Here's the error:
${t.message}`);else throw t}}function mg(r){const t=Pc(r).filter(n=>n.isInitializer);return t.length>1?t.find(n=>n.name==="constructor")??t.find(n=>n.name==="initializer")??t.find(n=>{var s;return((s=n.parameters)==null?void 0:s.length)===0})??t.find(n=>n.functionType==="private")??t[0]:t[0]}function kA(r,e){if(typeof e=="string"){const n=Pc(r).find(s=>s.name===e);if(n){if(!n.isInitializer)throw new Error(`Method ${e} is not an initializer`)}else throw new Error(`Constructor method ${e} not found in contract artifact`);return n}else{if(e===void 0)return mg(r);if(!e.isInitializer)throw new Error(`Method ${e.name} is not an initializer`);return e}}var wh=1/0,pg=9007199254740991,LA=17976931348623157e292,vh=NaN,$A="[object Function]",HA="[object GeneratorFunction]",DA="[object Symbol]",MA=/^\s+|\s+$/g,UA=/^[-+]0x[0-9a-f]+$/i,jA=/^0b[01]+$/i,ZA=/^0o[0-7]+$/i,zA=/^(?:0|[1-9]\d*)$/,VA=parseInt,qA=Object.prototype,gg=qA.toString,WA=Math.ceil,GA=Math.max;function KA(r,e,t){var n=-1,s=r.length;e<0&&(e=-e>s?0:s+e),t=t>s?s:t,t<0&&(t+=s),s=e>t?0:t-e>>>0,e>>>=0;for(var i=Array(s);++n<s;)i[n]=r[n+e];return i}function YA(r,e){return e=e??pg,!!e&&(typeof r=="number"||zA.test(r))&&r>-1&&r%1==0&&r<e}function XA(r,e,t){if(!uc(t))return!1;var n=typeof e;return(n=="number"?e_(t)&&YA(e,t.length):n=="string"&&e in t)?QA(t[e],r):!1}function JA(r,e,t){(t?XA(r,e,t):e===void 0)?e=1:e=GA(a_(e),0);var n=r?r.length:0;if(!n||e<1)return[];for(var s=0,i=0,a=Array(WA(n/e));s<n;)a[i++]=KA(r,s,s+=e);return a}function QA(r,e){return r===e||r!==r&&e!==e}function e_(r){return r!=null&&r_(r.length)&&!t_(r)}function t_(r){var e=uc(r)?gg.call(r):"";return e==$A||e==HA}function r_(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=pg}function uc(r){var e=typeof r;return!!r&&(e=="object"||e=="function")}function n_(r){return!!r&&typeof r=="object"}function s_(r){return typeof r=="symbol"||n_(r)&&gg.call(r)==DA}function i_(r){if(!r)return r===0?r:0;if(r=o_(r),r===wh||r===-wh){var e=r<0?-1:1;return e*LA}return r===r?r:0}function a_(r){var e=i_(r),t=e%1;return e===e?t?e-t:e:0}function o_(r){if(typeof r=="number")return r;if(s_(r))return vh;if(uc(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=uc(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=r.replace(MA,"");var t=jA.test(r);return t||ZA.test(r)?VA(r.slice(2),t?2:8):UA.test(r)?vh:+r}var c_=JA;const u_=Ua(c_);function yg(r,e){const t=[new l(r.length),...u_(r,l.SIZE_IN_BYTES-1).map(n=>{const s=Buffer.alloc(l.SIZE_IN_BYTES);return Buffer.from(n).copy(s,1),l.fromBuffer(s)})];if(t.length>e)throw new Error(`Input buffer exceeds maximum size: got ${t.length} but max is ${e}`);return[...t,...Array(e-t.length).fill(l.ZERO)]}class Pi{constructor(e,t){u(this,"abi");u(this,"args");u(this,"flattened");this.abi=e,this.args=t,this.flattened=[]}static typeSize(e){switch(e.kind){case"field":case"boolean":case"integer":return 1;case"string":return e.length;case"array":return e.length*Pi.typeSize(e.type);case"struct":return e.fields.reduce((t,n)=>t+Pi.typeSize(n.type),0);case"tuple":return e.fields.reduce((t,n)=>t+Pi.typeSize(n),0);default:{const t=e;throw new Error(`Unhandled abi type: ${t}`)}}}encodeArgument(e,t,n){if(t===void 0||t==null)throw new Error(`Undefined argument ${n??"unnamed"} of type ${e.kind}`);switch(e.kind){case"field":if(typeof t=="number")this.flattened.push(new l(BigInt(t)));else if(typeof t=="bigint")this.flattened.push(new l(t));else if(typeof t=="string")this.flattened.push(l.fromString(t));else if(typeof t=="boolean")this.flattened.push(new l(t?1n:0n));else if(typeof t=="object")if(Buffer.isBuffer(t))this.flattened.push(l.fromBuffer(t));else if(typeof t.toField=="function")this.flattened.push(t.toField());else if(typeof t.value=="string")this.flattened.push(l.fromHexString(t.value));else throw new Error(`Argument for ${n} cannot be serialized to a field`);else throw new Error(`Invalid argument "${t}" of type ${e.kind}`);break;case"boolean":this.flattened.push(new l(t?1n:0n));break;case"array":for(let s=0;s<e.length;s+=1)this.encodeArgument(e.type,t[s],`${n}[${s}]`);break;case"string":for(let s=0;s<e.length;s+=1){const i=s<t.length?BigInt(t.charCodeAt(s)):0n;this.flattened.push(new l(i))}break;case"struct":{if(t.encodeToNoir!==void 0){this.flattened.push(...t.encodeToNoir());break}const s=aA(e);if(s&&typeof t.address>"u"&&typeof t.inner>"u"){this.encodeArgument({kind:"field"},t,`${n}.inner`);break}if(s&&typeof t.address<"u"){this.encodeArgument({kind:"field"},t.address,`${n}.address`);break}if(cA(e)){this.encodeArgument({kind:"integer",sign:"unsigned",width:32},t.value??t,`${n}.inner`);break}if(uA(e)){this.encodeArgument({kind:"field"},t.inner??t,`${n}.inner`);break}for(const i of e.fields)this.encodeArgument(i.type,t[i.name],`${n}.${i.name}`);break}case"integer":if(typeof t=="string"){const s=BigInt(t);this.flattened.push(new l(s))}else this.flattened.push(new l(t));break;default:throw new Error(`Unsupported type: ${e.kind}`)}}encode(){for(let e=0;e<this.abi.parameters.length;e+=1){const t=this.abi.parameters[e];this.encodeArgument(t.type,this.args[e],t.name)}return this.flattened}}function bg(r,e){return new Pi(r,e).encode()}function PI(r){return r.parameters.reduce((e,t)=>e+Pi.typeSize(t.type),0)}const l_="private",f_="public",d_="utility",h_="internal",m_="initializer",p_="view";function NI(r){return Buffer.from(cf(r),"utf-8")}function kI(r){return TA(r.toString("utf-8"),Ks)}function LI(r){return g_(r)?r:w_(r)}function $I(r){return v_(r)}function g_(r){if(typeof r!="object")return!1;const e=r;if(typeof e.name!="string"||!Array.isArray(e.functions))return!1;for(const t of e.functions)if(typeof t.name!="string"||typeof t.functionType!="string"||!lc(t)&&t.bytecode.length)return!1;if(!Array.isArray(e.nonDispatchPublicFunctions))return!1;for(const t of e.nonDispatchPublicFunctions)if(typeof t.name!="string"||typeof t.functionType!="string")return!1;return!0}function y_(r){const{visibility:e}=r;if(e==="databus")throw new Error(`Unsupported visibility ${r.visibility} for noir contract function parameter ${r.name}.`);return{...r,visibility:e}}function lc(r){return(r.functionType??vg(r))!==tr.PUBLIC||r.name=="public_dispatch"}function uf(r,e){if(r.custom_attributes===void 0)throw new Error(`No custom attributes found for contract function ${r.name}. Try rebuilding the contract with the latest nargo version.`);const t=vg(r),n=r.custom_attributes.includes(h_),s=r.custom_attributes.includes(p_);let i=r.abi.parameters.map(y_);b_(i)&&(i=i.slice(1));let a=[];if(t===tr.UTILITY)a=r.abi.return_type?[r.abi.return_type.abi_type]:a;else{const o=`${e.name}::${r.name}_abi`,f=e.outputs.structs.functions.find(h=>h.kind==="struct"&&h.path===o);if(f){if(f.kind!=="struct")throw new Error("Could not generate contract function artifact");const h=f.fields.find(d=>d.name==="return_type");h&&(a=[h.type])}}return{name:r.name,functionType:t,isInternal:n,isStatic:s,isInitializer:r.custom_attributes.includes(m_),parameters:i,returnTypes:a,errorTypes:r.abi.error_types,...r.assert_messages?{assertMessages:r.assert_messages}:void 0}}function wg(r,e){return{...uf(r,e),bytecode:r.bytecode,debugSymbols:r.debug_symbols,...r.verification_key?{verificationKey:r.verification_key}:void 0}}function vg(r){if(r.custom_attributes.includes(l_))return tr.PRIVATE;if(r.custom_attributes.includes(f_))return tr.PUBLIC;if(r.custom_attributes.includes(d_))return tr.UTILITY;throw new Error(`Invalid function type for a noir contract function ${r.name}`)}function b_(r){const e=r[0];return(e==null?void 0:e.type.kind)==="struct"&&e.type.path.includes("ContextInputs")}function Eg(r){const t=(r.outputs.globals.storage?r.outputs.globals.storage:[]).find(s=>{var a;return((a=s.fields.find(o=>o.name==="contract_name"))==null?void 0:a.value).value===r.name}),n=t?t.fields.find(s=>s.name=="fields").value.fields:[];return n.length===0?{}:n.reduce((s,i)=>{const a=i.name,o=i.value.fields[0].value;return s[a]={slot:`0x${o.value}`},s},{})}function Sg(r){const e=r.outputs.globals.notes;return e?e.reduce((t,n)=>{const s=n.fields,i=s.find(d=>d.kind==="integer"),a=s.find(d=>d.kind==="string"),o=s.find(d=>d.kind==="struct");if(!i||!a||!o)throw new Error(`Could not find note type id, name or fields for note ${n}`);const c=i.value,f=a.value,h=o.fields.map(d=>({name:d.name,index:parseInt(d.value.fields[0].value.value,16),nullable:d.value.fields[1].value.value}));return t[f]={id:c,typ:f,fields:h},t},{}):{}}function w_(r){try{return Ks.parse({name:r.name,functions:r.functions.filter(e=>lc(e)).map(e=>wg(e,r)),nonDispatchPublicFunctions:r.functions.filter(e=>!lc(e)).map(e=>uf(e,r)),outputs:r.outputs,storageLayout:Eg(r),notes:Sg(r),fileMap:r.file_map})}catch(e){throw new Error(`Could not generate contract artifact for ${r.name}: ${e}`)}}function v_(r){try{return Ks.parse({name:r.name,functions:r.functions.map(e=>wg(e,r)),nonDispatchPublicFunctions:r.functions.filter(e=>!lc(e)).map(e=>uf(e,r)),outputs:r.outputs,storageLayout:Eg(r),notes:Sg(r),fileMap:r.file_map})}catch(e){throw new Error(`Could not generate contract artifact for ${r.name}: ${e}`)}}class Wt{constructor(e,t,n,s){u(this,"msgSender");u(this,"contractAddress");u(this,"functionSelector");u(this,"isStaticCall");this.msgSender=e,this.contractAddress=t,this.functionSelector=n,this.isStaticCall=s}static empty(){return new Wt(W.ZERO,W.ZERO,ze.empty(),!1)}static async random(){return new Wt(await W.random(),await W.random(),ze.random(),Math.random()>.5)}static get schema(){return R({msgSender:C.AztecAddress,contractAddress:C.AztecAddress,functionSelector:C.FunctionSelector,isStaticCall:et()}).transform(Wt.from)}isEmpty(){return this.msgSender.isZero()&&this.contractAddress.isZero()&&this.functionSelector.isEmpty()&&!this.isStaticCall}static from(e){return new Wt(...Wt.getFields(e))}static getFields(e){return[e.msgSender,e.contractAddress,e.functionSelector,e.isStaticCall]}toBuffer(){return le(...Wt.getFields(this))}toFields(){const e=Je(...Wt.getFields(this));if(e.length!==Hd)throw new Error(`Invalid number of fields for CallContext. Expected ${Hd}, got ${e.length}`);return e}static fromBuffer(e){const t=J.asReader(e);return new Wt(t.readObject(W),t.readObject(W),t.readObject(ze),t.readBoolean())}static fromFields(e){const t=Ee.asReader(e);return new Wt(t.readObject(W),t.readObject(W),t.readObject(ze),t.readBoolean())}equals(e){return e.msgSender.equals(this.msgSender)&&e.contractAddress.equals(this.contractAddress)&&e.functionSelector.equals(this.functionSelector)&&e.isStaticCall===this.isStaticCall}[ue.inspect.custom](){return`CallContext {
      msgSender: ${this.msgSender}
      contractAddress: ${this.contractAddress}
      functionSelector: ${this.functionSelector}
      isStaticCall: ${this.isStaticCall}
    }`}}class cr{constructor(e,t){u(this,"isSome");u(this,"value");this.isSome=e,this.value=t}toBuffer(){return le(...cr.getFields(this))}toFields(){const e=Je(...cr.getFields(this));if(e.length!==zd)throw new Error(`Invalid number of fields for MaxBlockNumber. Expected ${zd}, got ${e.length}`);return e}static fromBuffer(e){const t=J.asReader(e);return new cr(t.readBoolean(),l.fromBuffer(t))}static fromFields(e){const t=Ee.asReader(e);return new cr(t.readBoolean(),t.readField())}static empty(){return new cr(!1,l.ZERO)}isEmpty(){return!this.isSome&&this.value.isZero()}static from(e){return new cr(...cr.getFields(e))}static getFields(e){return[e.isSome,e.value]}}class Yn{constructor(e,t){u(this,"selector");u(this,"isPrivate");this.selector=e,this.isPrivate=t}static async fromAbi(e){return new Yn(await ze.fromNameAndParameters(e.name,e.parameters),e.functionType===tr.PRIVATE)}static get schema(){return R({selector:ze.schema,isPrivate:et()}).transform(({selector:e,isPrivate:t})=>new Yn(e,t))}toBuffer(){return le(this.selector,this.isPrivate)}toFields(){const e=[this.selector.toField(),new l(this.isPrivate)];if(e.length!==Md)throw new Error(`Invalid number of fields for FunctionData. Expected ${Md}, got ${e.length}`);return e}isEmpty(){return this.selector.isEmpty()}equals(e){return this.selector.equals(e.selector)&&this.isPrivate===e.isPrivate}static empty(e){return new Yn(ze.empty(),(e==null?void 0:e.isPrivate)??!1)}static fromBuffer(e){const t=J.asReader(e);return new Yn(t.readObject(ze),t.readBoolean())}static fromFields(e){const t=Ee.asReader(e),n=ze.fromFields(t),s=t.readBoolean();return new Yn(n,s)}}class da{constructor(e,t,n,s){u(this,"l1ToL2MessageTree");u(this,"noteHashTree");u(this,"nullifierTree");u(this,"publicDataTree");this.l1ToL2MessageTree=e,this.noteHashTree=t,this.nullifierTree=n,this.publicDataTree=s}static get schema(){return R({l1ToL2MessageTree:xe.schema,noteHashTree:xe.schema,nullifierTree:xe.schema,publicDataTree:xe.schema}).transform(({l1ToL2MessageTree:e,noteHashTree:t,nullifierTree:n,publicDataTree:s})=>new da(e,t,n,s))}getSize(){return this.l1ToL2MessageTree.getSize()+this.noteHashTree.getSize()+this.nullifierTree.getSize()+this.publicDataTree.getSize()}static fromBuffer(e){const t=J.asReader(e);return new da(t.readObject(xe),t.readObject(xe),t.readObject(xe),t.readObject(xe))}toBuffer(){return le(this.l1ToL2MessageTree,this.noteHashTree,this.nullifierTree,this.publicDataTree)}static fromFields(e){const t=Ee.asReader(e),n=xe.fromFields(t),s=xe.fromFields(t),i=xe.fromFields(t),a=xe.fromFields(t);return new da(n,s,i,a)}toFields(){const e=[...this.l1ToL2MessageTree.toFields(),...this.noteHashTree.toFields(),...this.nullifierTree.toFields(),...this.publicDataTree.toFields()];if(e.length!==eh)throw new Error(`Invalid number of fields for TreeSnapshots. Expected ${eh}, got ${e.length}`);return e}static empty(){return new da(xe.zero(),xe.zero(),xe.zero(),xe.zero())}isEmpty(){return this.l1ToL2MessageTree.isZero()&&this.noteHashTree.isZero()&&this.nullifierTree.isZero()&&this.publicDataTree.isZero()}[ue.inspect.custom](){return`TreeSnapshots {
  l1ToL2MessageTree: ${ue.inspect(this.l1ToL2MessageTree)},
  noteHashTree: ${ue.inspect(this.noteHashTree)},
  nullifierTree: ${ue.inspect(this.nullifierTree)},
  publicDataTree: ${ue.inspect(this.publicDataTree)},
}`}}class ft{constructor(e,t,n){u(this,"gasSettings");u(this,"chainId");u(this,"version");this.gasSettings=n,this.chainId=new l(e),this.version=new l(t)}static get schema(){return R({chainId:q.Fr,version:q.Fr,gasSettings:qt.schema}).transform(ft.from)}getSize(){return this.chainId.size+this.version.size+this.gasSettings.getSize()}clone(){return new ft(this.chainId,this.version,this.gasSettings.clone())}toBuffer(){return le(...ft.getFields(this))}static fromFields(e){const t=Ee.asReader(e);return new ft(t.readField(),t.readField(),t.readObject(qt))}toFields(){const e=Je(...ft.getFields(this));if(e.length!==th)throw new Error(`Invalid number of fields for TxContext. Expected ${th}, got ${e.length}`);return e}static fromBuffer(e){const t=J.asReader(e);return new ft(l.fromBuffer(t),l.fromBuffer(t),t.readObject(qt))}static empty(e=0,t=0){return new ft(new l(e),new l(t),qt.empty())}isEmpty(){return this.chainId.isZero()&&this.version.isZero()&&this.gasSettings.isEmpty()}static from(e){return new ft(...ft.getFields(e))}static getFields(e){return[e.chainId,e.version,e.gasSettings]}}class Ut{constructor(e,t,n,s){u(this,"historicalHeader");u(this,"txContext");u(this,"vkTreeRoot");u(this,"protocolContractTreeRoot");this.historicalHeader=e,this.txContext=t,this.vkTreeRoot=n,this.protocolContractTreeRoot=s}static from(e){return new Ut(...Ut.getFields(e))}static getFields(e){return[e.historicalHeader,e.txContext,e.vkTreeRoot,e.protocolContractTreeRoot]}static fromFields(e){const t=Ee.asReader(e);return new Ut(t.readObject(ct),t.readObject(ft),t.readField(),t.readField())}toFields(){const e=Je(...Ut.getFields(this));if(e.length!==ah)throw new Error(`Invalid number of fields for TxConstantData. Expected ${ah}, got ${e.length}`);return e}static fromBuffer(e){const t=J.asReader(e);return new Ut(t.readObject(ct),t.readObject(ft),l.fromBuffer(t),l.fromBuffer(t))}toBuffer(){return le(...Ut.getFields(this))}static empty(){return new Ut(ct.empty(),ft.empty(),l.ZERO,l.ZERO)}getSize(){return this.historicalHeader.getSize()+this.txContext.getSize()+this.vkTreeRoot.size+this.protocolContractTreeRoot.size}clone(){return Ut.fromBuffer(this.toBuffer())}}class ys{constructor(e,t,n,s,i){u(this,"origin");u(this,"functionData");u(this,"argsHash");u(this,"txContext");u(this,"salt");this.origin=e,this.functionData=t,this.argsHash=n,this.txContext=s,this.salt=i}static getFields(e){return[e.origin,e.functionData,e.argsHash,e.txContext,e.salt]}static from(e){return new ys(...ys.getFields(e))}toBuffer(){return le([...ys.getFields(this)])}toFields(){const e=Je(...ys.getFields(this));if(e.length!==rh)throw new Error(`Invalid number of fields for TxRequest. Expected ${rh}, got ${e.length}`);return e}static fromBuffer(e){const t=J.asReader(e);return new ys(t.readObject(W),t.readObject(Yn),l.fromBuffer(t),t.readObject(ft),l.fromBuffer(t))}hash(){return wt(this.toFields(),nt.TX_REQUEST)}static empty(){return new ys(W.ZERO,Yn.empty(),l.zero(),ft.empty(),l.zero())}isEmpty(){return this.origin.isZero()&&this.functionData.isEmpty()&&this.argsHash.isZero()&&this.txContext.isEmpty()&&this.salt.isZero()}}class Ss{constructor(e,t){u(this,"pkM");u(this,"skApp");this.pkM=e,this.skApp=t instanceof l?t:new l(t.toBigInt())}toBuffer(){return le(this.pkM,this.skApp)}get skAppAsGrumpkinScalar(){return new Ep(this.skApp.toBigInt())}static fromBuffer(e){const t=J.asReader(e);return new Ss(Qe.fromBuffer(t),l.fromBuffer(t))}toFields(){const e=[this.pkM.toFields(),this.skApp].flat();if(e.length!==Vd)throw new Error(`Invalid number of fields for KeyValidationRequest. Expected ${Vd}, got ${e.length}`);return e}static fromFields(e){const t=Ee.asReader(e);return new Ss(Qe.fromFields(t),t.readField())}isEmpty(){return this.pkM.isZero()&&this.skApp.isZero()}static empty(){return new Ss(Qe.ZERO,l.ZERO)}static async random(){return new Ss(await Qe.random(),l.random())}}class Ys{constructor(e,t){u(this,"request");u(this,"skAppGenerator");this.request=e,this.skAppGenerator=t}toBuffer(){return le(this.request,this.skAppGenerator)}static fromBuffer(e){const t=J.asReader(e);return new Ys(t.readObject(Ss),l.fromBuffer(t))}toFields(){const e=[...this.request.toFields(),this.skAppGenerator];if(e.length!==qd)throw new Error(`Invalid number of fields for KeyValidationRequestAndGenerator. Expected ${qd}, got ${e.length}`);return e}static fromFields(e){const t=Ee.asReader(e);return new Ys(Ss.fromFields(t),t.readField())}isEmpty(){return this.request.isEmpty()&&this.skAppGenerator.isZero()}static empty(){return new Ys(Ss.empty(),l.ZERO)}}class an{constructor(e,t){u(this,"value");u(this,"length");this.value=e,this.length=t}static from(e){return new an(e.value,e.length)}toFields(){return[this.value,new l(this.length)]}static fromFields(e){const t=Ee.asReader(e);return new an(t.readField(),t.readU32())}isEmpty(){return this.value.isZero()&&!this.length}static empty(){return new an(l.zero(),0)}toBuffer(){return le(this.value,this.length)}static fromBuffer(e){const t=J.asReader(e);return new an(l.fromBuffer(t),t.readNumber())}toString(){return`value=${this.value} length=${this.length}`}scope(e){return new Fn(this,e)}[ue.inspect.custom](){return`LogHash { ${this.toString()} }`}}class Rn{constructor(e,t){u(this,"logHash");u(this,"counter");this.logHash=e,this.counter=t}toFields(){return[...this.logHash.toFields(),new l(this.counter)]}static fromFields(e){const t=Ee.asReader(e);return new Rn(t.readObject(an),t.readU32())}isEmpty(){return this.logHash.isEmpty()&&!this.counter}static empty(){return new Rn(an.empty(),0)}toBuffer(){return le(this.logHash,this.counter)}static fromBuffer(e){const t=J.asReader(e);return new Rn(an.fromBuffer(t),t.readNumber())}}class Fn{constructor(e,t){u(this,"logHash");u(this,"contractAddress");this.logHash=e,this.contractAddress=t}get value(){return this.logHash.value}toFields(){return[...this.logHash.toFields(),this.contractAddress.toField()]}static fromFields(e){const t=Ee.asReader(e);return new Fn(t.readObject(an),W.fromField(t.readField()))}isEmpty(){return this.logHash.isEmpty()&&this.contractAddress.isZero()}static empty(){return new Fn(an.empty(),W.ZERO)}toBuffer(){return le(this.logHash,this.contractAddress)}static fromBuffer(e){const t=J.asReader(e);return new Fn(an.fromBuffer(t),W.fromBuffer(t))}toString(){return`logHash=${this.logHash} contractAddress=${this.contractAddress}`}}class Ro{constructor(e,t){u(this,"inner");u(this,"contractAddress");this.inner=e,this.contractAddress=t}toFields(){return[...this.inner.toFields(),this.contractAddress.toField()]}static fromFields(e){const t=Ee.asReader(e);return new Ro(t.readObject(Rn),W.fromField(t.readField()))}toBuffer(){return le(this.inner,this.contractAddress)}static fromBuffer(e){const t=J.asReader(e);return new Ro(Rn.fromBuffer(t),W.fromBuffer(t))}isEmpty(){return this.inner.isEmpty()&&this.contractAddress.isZero()}static empty(){return new Ro(Rn.empty(),W.ZERO)}}class Xs{constructor(e,t,n,s,i){u(this,"callContext");u(this,"argsHash");u(this,"returnsHash");u(this,"startSideEffectCounter");u(this,"endSideEffectCounter");this.callContext=e,this.argsHash=t,this.returnsHash=n,this.startSideEffectCounter=s,this.endSideEffectCounter=i}toFields(){return Je([this.callContext,this.argsHash,this.returnsHash,this.startSideEffectCounter,this.endSideEffectCounter])}static fromFields(e){const t=Ee.asReader(e);return new Xs(t.readObject(Wt),t.readField(),t.readField(),t.readU32(),t.readU32())}toBuffer(){return le(this.callContext,this.argsHash,this.returnsHash,this.startSideEffectCounter,this.endSideEffectCounter)}static fromBuffer(e){const t=J.asReader(e);return new Xs(t.readObject(Wt),l.fromBuffer(t),l.fromBuffer(t),t.readNumber(),t.readNumber())}isEmpty(){return this.callContext.isEmpty()&&this.argsHash.isZero()&&this.returnsHash.isZero()&&this.startSideEffectCounter===0&&this.endSideEffectCounter===0}static empty(){return new Xs(Wt.empty(),l.ZERO,l.ZERO,0,0)}equals(e){return e.callContext.equals(this.callContext)&&e.argsHash.equals(this.argsHash)&&e.returnsHash.equals(this.returnsHash)&&e.startSideEffectCounter===this.startSideEffectCounter&&e.endSideEffectCounter===this.endSideEffectCounter}toString(){return`PrivateCallRequest(contractAddress: ${this.callContext.contractAddress}, selector: ${this.callContext.functionSelector}, msgSender: ${this.callContext.msgSender}, isStatic: ${this.callContext.isEmpty},  argsHash: ${this.argsHash}, returnsHash: ${this.returnsHash}, startSideEffectCounter: ${this.startSideEffectCounter}, endSideEffectCounter: ${this.endSideEffectCounter})`}}const Pr=class Pr{constructor(e,t){u(this,"fields");u(this,"emittedLength");this.fields=e,this.emittedLength=t}static from(e){return new Pr(...Pr.getFields(e))}static getFields(e){return[e.fields,e.emittedLength]}toFields(){return Je(...Pr.getFields(this))}static fromFields(e){const t=Ee.asReader(e);return new Pr(t.readFieldArray(fi),t.readU32())}getEmittedFields(){return this.fields.slice(0,this.emittedLength)}toBlobFields(){return[new l(this.emittedLength)].concat(this.getEmittedFields())}static fromBlobFields(e){const t=Ee.asReader(e),n=t.readU32(),s=t.readFieldArray(n);return new Pr(Kl(s,l.ZERO,fi),n)}isEmpty(){return this.fields.every(e=>e.isZero())}static empty(){return new Pr(Xe(fi,l.zero),0)}toBuffer(){return le(this.fields,this.emittedLength)}static fromBuffer(e){const t=J.asReader(e);return new Pr(t.readArray(fi,l),t.readNumber())}static random(e=l.random()){const t=Xe(fi,l.random);return t[0]=e,new Pr(t,fi)}static get schema(){return R({fields:ee(q.Fr),emittedLength:se()}).strict().transform(({fields:e,emittedLength:t})=>Pr.fromFields(e.concat(new l(t))))}equals(e){return this.fields.every((t,n)=>t.equals(e.fields[n]))&&this.emittedLength===e.emittedLength}[ue.inspect.custom](){return`PrivateLog {
      fields: [${this.fields.map(e=>ue.inspect(e)).join(", ")}],
      emittedLength: ${this.emittedLength},
    }`}};u(Pr,"SIZE_IN_BYTES",l.SIZE_IN_BYTES*rA);let Bt=Pr;class ur{constructor(e,t,n){u(this,"log");u(this,"noteHashCounter");u(this,"counter");this.log=e,this.noteHashCounter=t,this.counter=n}static from(e){return new ur(...ur.getFields(e))}static getFields(e){return[e.log,e.noteHashCounter,e.counter]}static fromFields(e){const t=Ee.asReader(e);return new ur(t.readObject(Bt),t.readU32(),t.readU32())}toFields(){const e=Je(...ur.getFields(this));if(e.length!==Gd)throw new Error(`Invalid number of fields for PrivateLogData. Expected ${Gd}, got ${e.length}`);return e}static fromBuffer(e){const t=J.asReader(e);return new ur(t.readObject(Bt),t.readNumber(),t.readNumber())}toBuffer(){return le(...ur.getFields(this))}static empty(){return new ur(Bt.empty(),0,0)}isEmpty(){return this.log.isEmpty()&&!this.noteHashCounter&&!this.counter}[ue.inspect.custom](){return`PrivateLogData {
      log: ${this.log.fields}
      noteHashCounter: ${this.noteHashCounter}
      counter: ${this.counter}
    }`}}class ms{constructor(e,t){u(this,"inner");u(this,"contractAddress");this.inner=e,this.contractAddress=t}static from(e){return new ms(...ms.getFields(e))}static getFields(e){return[e.inner,e.contractAddress]}toFields(){return Je(...ms.getFields(this))}static fromFields(e){const t=Ee.asReader(e);return new ms(t.readObject(ur),W.fromField(t.readField()))}isEmpty(){return this.inner.isEmpty()&&this.contractAddress.isZero()}static empty(){return new ms(ur.empty(),W.ZERO)}toBuffer(){return le(...ms.getFields(this))}static fromBuffer(e){const t=J.asReader(e);return new ms(ur.fromBuffer(t),W.fromBuffer(t))}[ue.inspect.custom](){return`ScopedPrivateLogData {
      inner.counter: ${this.inner.counter}
      inner.noteHashCounter: ${this.inner.noteHashCounter}
      inner.log: ${this.inner.log.fields}
      contractAddress: ${this.contractAddress}
    }`}}class Zr{constructor(e,t,n){u(this,"recipient");u(this,"content");u(this,"counter");this.recipient=e,this.content=t,this.counter=n}static get schema(){return R({recipient:q.EthAddress,content:q.Fr,counter:se().int().nonnegative()}).transform(({recipient:e,content:t,counter:n})=>new Zr(e,t,n))}static empty(){return new Zr(gr.ZERO,l.zero(),0)}equals(e){return this.recipient.equals(e.recipient)&&this.content.equals(e.content)&&this.counter===e.counter}toBuffer(){return le(this.recipient,this.content,this.counter)}toFields(){const e=[this.recipient.toField(),this.content,new l(this.counter)];if(e.length!==jd)throw new Error(`Invalid number of fields for L2ToL1Message. Expected ${jd}, got ${e.length}`);return e}static fromFields(e){const t=Ee.asReader(e);return new Zr(t.readObject(gr),t.readField(),t.readU32())}static fromBuffer(e){const t=J.asReader(e);return new Zr(t.readObject(gr),t.readObject(l),t.readNumber())}isEmpty(){return this.recipient.isZero()&&this.content.isZero()&&!this.counter}scope(e){return new jr(this,e)}}class jr{constructor(e,t){u(this,"message");u(this,"contractAddress");this.message=e,this.contractAddress=t}static get schema(){return R({message:Zr.schema,contractAddress:W.schema}).transform(({message:e,contractAddress:t})=>new jr(e,t))}static getFields(e){return[e.message,e.contractAddress]}static empty(){return new jr(Zr.empty(),W.ZERO)}equals(e){return this.message.equals(e.message)&&this.contractAddress.equals(e.contractAddress)}toBuffer(){return le(this.message,this.contractAddress)}static fromBuffer(e){const t=J.asReader(e);return new jr(t.readObject(Zr),t.readObject(W))}static fromFields(e){const t=Ee.asReader(e);return new jr(t.readObject(Zr),t.readObject(W))}toFields(){const e=Je(...jr.getFields(this));if(e.length!==Zd)throw new Error(`Invalid number of fields for ScopedL2ToL1Message. Expected ${Zd}, got ${e.length}`);return e}isEmpty(){return this.message.isEmpty()&&this.contractAddress.isZero()}}class Ar{constructor(e,t){u(this,"value");u(this,"counter");this.value=e,this.counter=t}toBuffer(){return le(this.value,this.counter)}static fromBuffer(e){const t=J.asReader(e);return new Ar(l.fromBuffer(t),t.readNumber())}toFields(){return[this.value,new l(this.counter)]}static fromFields(e){const t=Ee.asReader(e);return new Ar(t.readField(),t.readU32())}isEmpty(){return this.value.isZero()&&!this.counter}static empty(){return new Ar(l.zero(),0)}scope(e){return new wa(this,e)}}class wa{constructor(e,t){u(this,"readRequest");u(this,"contractAddress");this.readRequest=e,this.contractAddress=t}get value(){return this.readRequest.value}get counter(){return this.readRequest.counter}toBuffer(){return le(this.readRequest,this.contractAddress)}static fromBuffer(e){const t=J.asReader(e);return new wa(Ar.fromBuffer(t),W.fromBuffer(t))}toFields(){return[...this.readRequest.toFields(),this.contractAddress.toField()]}static fromFields(e){const t=Ee.asReader(e);return new wa(t.readObject(Ar),W.fromField(t.readField()))}isEmpty(){return this.readRequest.isEmpty()&&this.contractAddress.isZero()}static empty(){return new wa(Ar.empty(),W.ZERO)}}class Cn{constructor(e,t){u(this,"value");u(this,"counter");this.value=e,this.counter=t}toFields(){return[this.value,new l(this.counter)]}static fromFields(e){const t=Ee.asReader(e);return new Cn(t.readField(),t.readU32())}isEmpty(){return this.value.isZero()&&!this.counter}static empty(){return new Cn(l.zero(),0)}toBuffer(){return le(this.value,this.counter)}static fromBuffer(e){const t=J.asReader(e);return new Cn(l.fromBuffer(t),t.readNumber())}toString(){return`value=${this.value} counter=${this.counter}`}scope(e){return new va(this,e)}}class va{constructor(e,t){u(this,"noteHash");u(this,"contractAddress");this.noteHash=e,this.contractAddress=t}get counter(){return this.noteHash.counter}get value(){return this.noteHash.value}toFields(){return[...this.noteHash.toFields(),this.contractAddress.toField()]}static fromFields(e){const t=Ee.asReader(e);return new va(t.readObject(Cn),W.fromField(t.readField()))}isEmpty(){return this.noteHash.isEmpty()&&this.contractAddress.isZero()}static empty(){return new va(Cn.empty(),W.ZERO)}toBuffer(){return le(this.noteHash,this.contractAddress)}static fromBuffer(e){const t=J.asReader(e);return new va(Cn.fromBuffer(t),W.fromBuffer(t))}toString(){return`noteHash=${this.noteHash} contractAddress=${this.contractAddress}`}}class Pn{constructor(e,t,n){u(this,"value");u(this,"counter");u(this,"noteHash");this.value=e,this.counter=t,this.noteHash=n}toFields(){return[this.value,new l(this.counter),this.noteHash]}static fromFields(e){const t=Ee.asReader(e);return new Pn(t.readField(),t.readU32(),t.readField())}isEmpty(){return this.value.isZero()&&!this.counter&&this.noteHash.isZero()}static empty(){return new Pn(l.zero(),0,l.zero())}toBuffer(){return le(this.value,this.counter,this.noteHash)}static fromBuffer(e){const t=J.asReader(e);return new Pn(l.fromBuffer(t),t.readNumber(),l.fromBuffer(t))}toString(){return`value=${this.value} counter=${this.counter} noteHash=${this.noteHash}`}scope(e){return new Ea(this,e)}}class Ea{constructor(e,t){u(this,"nullifier");u(this,"contractAddress");this.nullifier=e,this.contractAddress=t}get counter(){return this.nullifier.counter}get value(){return this.nullifier.value}get nullifiedNoteHash(){return this.nullifier.noteHash}toFields(){return[...this.nullifier.toFields(),this.contractAddress.toField()]}static fromFields(e){const t=Ee.asReader(e);return new Ea(t.readObject(Pn),W.fromField(t.readField()))}isEmpty(){return this.nullifier.isEmpty()&&this.contractAddress.isZero()}static empty(){return new Ea(Pn.empty(),W.ZERO)}toBuffer(){return le(this.nullifier,this.contractAddress)}static fromBuffer(e){const t=J.asReader(e);return new Ea(Pn.fromBuffer(t),W.fromBuffer(t))}toString(){return`nullifier=${this.nullifier} contractAddress=${this.contractAddress}`}}class ut{constructor(e,t,n,s){u(this,"msgSender");u(this,"contractAddress");u(this,"isStaticCall");u(this,"calldataHash");this.msgSender=e,this.contractAddress=t,this.isStaticCall=n,this.calldataHash=s}static get schema(){return R({msgSender:W.schema,contractAddress:W.schema,isStaticCall:et(),calldataHash:q.Fr}).transform(({msgSender:e,contractAddress:t,isStaticCall:n,calldataHash:s})=>new ut(e,t,n,s))}getSize(){return this.isEmpty()?0:this.toBuffer().length}static from(e){return new ut(...ut.getFields(e))}static getFields(e){return[e.msgSender,e.contractAddress,e.isStaticCall,e.calldataHash]}static fromFields(e){const t=Ee.asReader(e);return new ut(t.readObject(W),t.readObject(W),t.readBoolean(),t.readField())}toFields(){const e=Je(...ut.getFields(this));if(e.length!==Yd)throw new Error(`Invalid number of fields for PublicCallRequest. Expected ${Yd}, got ${e.length}`);return e}static fromBuffer(e){const t=J.asReader(e);return new ut(t.readObject(W),t.readObject(W),t.readBoolean(),t.readObject(l))}toBuffer(){return le(...ut.getFields(this))}static empty(){return new ut(W.ZERO,W.ZERO,!1,l.ZERO)}isEmpty(){return this.msgSender.isZero()&&this.contractAddress.isZero()&&!this.isStaticCall&&this.calldataHash.isEmpty()}[ue.inspect.custom](){return`PublicCallRequest {
      msgSender: ${this.msgSender}
      contractAddress: ${this.contractAddress}
      isStaticCall: ${this.isStaticCall}
      calldataHash: ${this.calldataHash}
    }`}static async fromCalldata(e,t,n,s){const i=await cg(s);return new ut(e,t,n,i)}}class Xn{constructor(e,t){u(this,"inner");u(this,"counter");this.inner=e,this.counter=t}getSize(){return this.isEmpty()?0:this.toBuffer().length}static getFields(e){return[e.inner,e.counter]}static fromFields(e){const t=Ee.asReader(e);return new Xn(t.readObject(ut),t.readU32())}toFields(){const e=Je(...Xn.getFields(this));if(e.length!==Xd)throw new Error(`Invalid number of fields for CountedPublicCallRequest. Expected ${Xd}, got ${e.length}`);return e}static fromBuffer(e){const t=J.asReader(e);return new Xn(t.readObject(ut),t.readNumber())}toBuffer(){return le(...Xn.getFields(this))}static empty(){return new Xn(ut.empty(),0)}isEmpty(){return this.inner.isEmpty()&&this.counter==0}}function fc(r){return r.reduce((e,t,n)=>{if(!t.isEmpty()){if(e!==n)throw new Error("Non-empty items must be placed continuously from index 0.");return e+1}return e},0)}function yo(r,e,t=r.length){const n=fc(r),s=fc(e);if(n+s>t)throw new Error("Combined non-empty items exceeded the maximum allowed.");const i=[...r];return e.slice(0,s).forEach((a,o)=>i[o+n]=a),i}function E_(r,e,t=!0){return[...r].sort((n,s)=>n.isEmpty()?1:s.isEmpty()?-1:t?e(n,s):e(s,n))}function S_(r,e){return r.counter-e.counter}function A_(r,e=!0){return E_(r,S_,e)}function fn(r){return r.every(e=>e.isEmpty())}function HI(r){return r.filter(e=>!e.isEmpty())}class tn{constructor(e,t,n,s,i,a,o,c,f,h,d,v,b,D,U,ie,K,I,x,k,re){u(this,"callContext");u(this,"argsHash");u(this,"returnsHash");u(this,"minRevertibleSideEffectCounter");u(this,"isFeePayer");u(this,"maxBlockNumber");u(this,"noteHashReadRequests");u(this,"nullifierReadRequests");u(this,"keyValidationRequestsAndGenerators");u(this,"noteHashes");u(this,"nullifiers");u(this,"privateCallRequests");u(this,"publicCallRequests");u(this,"publicTeardownCallRequest");u(this,"l2ToL1Msgs");u(this,"privateLogs");u(this,"contractClassLogsHashes");u(this,"startSideEffectCounter");u(this,"endSideEffectCounter");u(this,"historicalHeader");u(this,"txContext");this.callContext=e,this.argsHash=t,this.returnsHash=n,this.minRevertibleSideEffectCounter=s,this.isFeePayer=i,this.maxBlockNumber=a,this.noteHashReadRequests=o,this.nullifierReadRequests=c,this.keyValidationRequestsAndGenerators=f,this.noteHashes=h,this.nullifiers=d,this.privateCallRequests=v,this.publicCallRequests=b,this.publicTeardownCallRequest=D,this.l2ToL1Msgs=U,this.privateLogs=ie,this.contractClassLogsHashes=K,this.startSideEffectCounter=I,this.endSideEffectCounter=x,this.historicalHeader=k,this.txContext=re}static from(e){return new tn(...tn.getFields(e))}static fromBuffer(e){const t=J.asReader(e);return new tn(t.readObject(Wt),t.readObject(l),t.readObject(l),t.readObject(l),t.readBoolean(),t.readObject(cr),t.readArray(_u,Ar),t.readArray(Bu,Ar),t.readArray(Tu,Ys),t.readArray(wu,Cn),t.readArray(vu,Pn),t.readArray(Eu,Xs),t.readArray(Su,Xn),t.readObject(ut),t.readArray(Au,Zr),t.readArray(xu,ur),t.readArray(Iu,Rn),t.readObject(l),t.readObject(l),t.readObject(ct),t.readObject(ft))}static fromFields(e){const t=Ee.asReader(e);return new tn(t.readObject(Wt),t.readField(),t.readField(),t.readField(),t.readBoolean(),t.readObject(cr),t.readArray(_u,Ar),t.readArray(Bu,Ar),t.readArray(Tu,Ys),t.readArray(wu,Cn),t.readArray(vu,Pn),t.readArray(Eu,Xs),t.readArray(Su,Xn),t.readObject(ut),t.readArray(Au,Zr),t.readArray(xu,ur),t.readArray(Iu,Rn),t.readField(),t.readField(),t.readObject(ct),t.readObject(ft))}static empty(){return new tn(Wt.empty(),l.ZERO,l.ZERO,l.ZERO,!1,cr.empty(),Xe(_u,Ar.empty),Xe(Bu,Ar.empty),Xe(Tu,Ys.empty),Xe(wu,Cn.empty),Xe(vu,Pn.empty),Xe(Eu,Xs.empty),Xe(Su,Xn.empty),ut.empty(),Xe(Au,Zr.empty),Xe(xu,ur.empty),Xe(Iu,Rn.empty),l.ZERO,l.ZERO,ct.empty(),ft.empty())}isEmpty(){return this.callContext.isEmpty()&&this.argsHash.isZero()&&this.returnsHash.isZero()&&this.minRevertibleSideEffectCounter.isZero()&&!this.isFeePayer&&this.maxBlockNumber.isEmpty()&&fn(this.noteHashReadRequests)&&fn(this.nullifierReadRequests)&&fn(this.keyValidationRequestsAndGenerators)&&fn(this.noteHashes)&&fn(this.nullifiers)&&fn(this.privateCallRequests)&&fn(this.publicCallRequests)&&this.publicTeardownCallRequest.isEmpty()&&fn(this.l2ToL1Msgs)&&fn(this.privateLogs)&&fn(this.contractClassLogsHashes)&&this.startSideEffectCounter.isZero()&&this.endSideEffectCounter.isZero()&&this.historicalHeader.isEmpty()&&this.txContext.isEmpty()}static getFields(e){return[e.callContext,e.argsHash,e.returnsHash,e.minRevertibleSideEffectCounter,e.isFeePayer,e.maxBlockNumber,e.noteHashReadRequests,e.nullifierReadRequests,e.keyValidationRequestsAndGenerators,e.noteHashes,e.nullifiers,e.privateCallRequests,e.publicCallRequests,e.publicTeardownCallRequest,e.l2ToL1Msgs,e.privateLogs,e.contractClassLogsHashes,e.startSideEffectCounter,e.endSideEffectCounter,e.historicalHeader,e.txContext]}toBuffer(){return le(...tn.getFields(this))}toFields(){const e=Je(...tn.getFields(this));if(e.length!==sh)throw new Error(`Invalid number of fields for PrivateCircuitPublicInputs. Expected ${sh}, got ${e.length}`);return e}toJSON(){return this.toBuffer()}static get schema(){return Ja(tn)}}class Lt{constructor(e){u(this,"fields");if(this.fields=e,e.length!==hn)throw new Error(`Invalid number of fields for ContractClassLog. Expected ${hn}, got ${e.length}`)}static get schema(){return R({fields:ee(q.Fr).refine(e=>e.length===hn)}).transform(({fields:e})=>new Lt(e))}toFields(){return this.fields}static fromFields(e){const t=Ee.asReader(e);return new Lt(Array.from({length:hn},()=>t.readField()))}toBuffer(){return le(this.fields)}static fromBuffer(e){const t=J.asReader(e);return new Lt(Array.from({length:hn},()=>t.readObject(l)))}equals(e){return this.fields.every((t,n)=>t.equals(e.fields[n]))}getEmittedFields(e){return this.fields.slice(0,e)}static fromEmittedFields(e){return new Lt(e.concat(Array(hn-e.length).fill(l.ZERO)))}isEmpty(){return this.fields.every(e=>e.isZero())}static empty(){return new Lt(Array(hn).fill(l.ZERO))}static random(e=hn){return new Lt(Array.from({length:e},()=>l.random()).concat(Array(hn-e).fill(l.ZERO)))}async hash(){return await Xi(this.fields)}clone(){return Lt.fromBuffer(this.toBuffer())}}const Nr=class Nr{constructor(e,t,n){u(this,"contractAddress");u(this,"fields");u(this,"emittedLength");u(this,"unsiloedFirstField");this.contractAddress=e,this.fields=t,this.emittedLength=n}static from(e){return new Nr(e.contractAddress,e.fields,e.emittedLength)}toFields(){return Je([this.contractAddress,this.fields,this.emittedLength])}equals(e){return this.contractAddress.equals(e.contractAddress)&&this.fields.equals(e.fields)&&this.emittedLength===e.emittedLength}static fromFields(e){const t=Ee.asReader(e);return new Nr(t.readObject(W),t.readObject(Lt),t.readU32())}getEmittedFields(){return this.fields.getEmittedFields(this.emittedLength)}toBlobFields(){return[new l(this.emittedLength),this.contractAddress.toField()].concat(this.getEmittedFields())}static fromBlobFields(e){const t=Ee.asReader(e),n=t.readU32(),s=t.readObject(W),i=t.readFieldArray(n);return new Nr(s,Lt.fromEmittedFields(i),n)}isEmpty(){return this.contractAddress.isZero()&&this.fields.isEmpty()&&this.emittedLength===0}static empty(){return new Nr(W.ZERO,Lt.empty(),0)}toBuffer(){return le([this.contractAddress,this.fields,this.emittedLength])}static fromBuffer(e){const t=J.asReader(e),n=t.readObject(W),s=Lt.fromBuffer(t),i=t.readNumber();return new Nr(n,s,i)}static async random(){const e=Math.ceil(hn/2);return new Nr(await W.random(),Lt.random(e),e)}setUnsiloedFirstField(e){this.unsiloedFirstField=e}toUnsiloed(){return this.contractAddress.isZero()?this:this.unsiloedFirstField?new Nr(this.contractAddress,new Lt([this.unsiloedFirstField].concat(this.fields.fields.slice(1))),this.emittedLength):this}async silo(){if(this.contractAddress.isZero())return this;const e=this.fields.clone(),t=e.fields[0],n=await Xi([this.contractAddress,t]);e.fields[0]=n;const s=new Nr(this.contractAddress,e,this.emittedLength);return s.setUnsiloedFirstField(t),s}async hash(){return await this.fields.hash()}static get schema(){return R({contractAddress:W.schema,fields:Lt.schema,emittedLength:se()}).transform(Nr.from)}[ue.inspect.custom](){return`ContractClassLog {
      contractAddress: ${this.contractAddress.toString()},
      emittedLength: ${this.emittedLength},
      fields: [${this.fields.fields.map(e=>ue.inspect(e)).join(", ")}],
    }`}};u(Nr,"SIZE_IN_BYTES",l.SIZE_IN_BYTES*sA);let zr=Nr;class Tr extends Os{toJSON(){return this.toBuffer()}static get schema(){return C.Buffer.transform(Tr.fromBuffer)}static fromBuffer(e){const t=J.asReader(e);return new Tr(t.readVector(l))}static random(){const e=Yl(10)+1,t=Array.from({length:e},()=>l.random());return new Tr(t)}toString(){return tt(this.toBuffer())}static fromString(e){return Tr.fromBuffer(dt(e))}get length(){return this.items.length}equals(e){return this.items.every((t,n)=>t.equals(e.items[n]))}}class $t{constructor(e,t){u(this,"values");u(this,"hash");this.values=e,this.hash=t}getSize(){return this.values.length+1}static get schema(){return R({values:ee(C.Fr),hash:C.Fr}).transform($t.from)}static from(e){return new $t(...$t.getFields(e))}static getFields(e){return[e.values,e.hash]}static random(){return new $t([l.random(),l.random()],l.random())}toBuffer(){return le(new Os(this.values),this.hash)}static fromBuffer(e){const t=J.asReader(e);return new $t(t.readVector(l),l.fromBuffer(t))}static async fromArgs(e){return new $t(e,await og(e))}static async fromCalldata(e){return new $t(e,await cg(e))}}class Ni{constructor(e,t,n){u(this,"note");u(this,"storageSlot");u(this,"noteTypeId");this.note=e,this.storageSlot=t,this.noteTypeId=n}static get schema(){return R({note:Tr.schema,storageSlot:C.Fr,noteTypeId:C.NoteSelector}).transform(Ni.from)}static from(e){return new Ni(e.note,e.storageSlot,e.noteTypeId)}static random(){return new Ni(Tr.random(),l.random(),nn.random())}}class Da{constructor(e,t){u(this,"log");u(this,"counter");this.log=e,this.counter=t}static get schema(){return R({log:zr.schema,counter:C.Integer}).transform(Da.from)}static from(e){return new Da(e.log,e.counter)}isEmpty(){return this.log.isEmpty()&&!this.counter}}class rs{constructor(e,t,n){u(this,"entrypoint");u(this,"firstNullifier");u(this,"publicFunctionCalldata");this.entrypoint=e,this.firstNullifier=t,this.publicFunctionCalldata=n}static get schema(){return R({entrypoint:ws.schema,firstNullifier:C.Fr,publicFunctionCalldata:ee($t.schema)}).transform(rs.from)}static from(e){return new rs(e.entrypoint,e.firstNullifier,e.publicFunctionCalldata)}static async random(e=1){return new rs(await ws.random(e),l.random(),[$t.random(),$t.random()])}getSimulationBlockNumber(){return this.entrypoint.publicInputs.historicalHeader.globalVariables.blockNumber.toNumber()}}class ws{constructor(e,t,n,s,i,a,o,c,f,h,d){u(this,"acir");u(this,"vk");u(this,"partialWitness");u(this,"publicInputs");u(this,"noteHashLeafIndexMap");u(this,"newNotes");u(this,"noteHashNullifierCounterMap");u(this,"returnValues");u(this,"nestedExecutions");u(this,"contractClassLogs");u(this,"profileResult");this.acir=e,this.vk=t,this.partialWitness=n,this.publicInputs=s,this.noteHashLeafIndexMap=i,this.newNotes=a,this.noteHashNullifierCounterMap=o,this.returnValues=c,this.nestedExecutions=f,this.contractClassLogs=h,this.profileResult=d}static get schema(){return R({acir:C.Buffer,vk:C.Buffer,partialWitness:Io(Fi.number(),we()),publicInputs:tn.schema,noteHashLeafIndexMap:Io(C.BigInt,C.BigInt),newNotes:ee(Ni.schema),noteHashNullifierCounterMap:Io(Fi.number(),se()),returnValues:ee(C.Fr),nestedExecutions:ee(Bn(()=>ws.schema)),contractClassLogs:ee(Da.schema)}).transform(ws.from)}static from(e){return new ws(e.acir,e.vk,e.partialWitness,e.publicInputs,e.noteHashLeafIndexMap,e.newNotes,e.noteHashNullifierCounterMap,e.returnValues,e.nestedExecutions,e.contractClassLogs)}static async random(e=1){return new ws(Wr(4),Wr(4),new Map([[1,"one"]]),tn.empty(),new Map([[1n,1n]]),[Ni.random()],new Map([[0,0]]),[l.random()],await ip(e,()=>ws.random(0)),[new Da(await zr.random(),Yl(10))])}}function DI(r){const e=new Map,t=(n,s)=>{n.noteHashLeafIndexMap.forEach((i,a)=>s.set(a,i)),n.nestedExecutions.forEach(i=>t(i,s))};return t(r.entrypoint,e),e}function MI(r){const e=new Map,t=(n,s)=>{n.noteHashNullifierCounterMap.forEach((i,a)=>s.set(a,i)),n.nestedExecutions.forEach(i=>t(i,s))};return t(r.entrypoint,e),e}function Ag(r){return[r.contractClassLogs,...r.nestedExecutions.flatMap(Ag)].flat()}function _g(r){const e=Ag(r.entrypoint);return A_(e).map(n=>n.log.fields)}function UI(r){const e=t=>t.nestedExecutions.reduce((n,s)=>{const i=e(s);return i||n},t.publicInputs.minRevertibleSideEffectCounter.toNumber());return e(r.entrypoint)}function __(r,e){return r.flatMap(e).concat(r.flatMap(({nestedExecutions:n})=>__(n,e)))}class bi{constructor(e,t){u(this,"request");u(this,"calldata");this.request=e,this.calldata=t}get functionSelector(){return ze.fromField(this.calldata[0])}get args(){return this.calldata.slice(1)}static get schema(){return R({request:ut.schema,calldata:ee(C.Fr)}).transform(bi.from)}static from(e){return new bi(e.request,e.calldata)}toBuffer(){return le(this.request,new Os(this.calldata))}static fromBuffer(e){const t=J.asReader(e);return new bi(ut.fromBuffer(t),t.readVector(l))}static empty(){return new bi(ut.empty(),[])}isEmpty(){return this.request.isEmpty()&&this.calldata.length===0}[ue.inspect.custom](){return`PublicCallRequestWithCalldata {
      request: ${ue.inspect(this.request)}
      calldata: ${this.calldata}
    }`}}class Ge{constructor(e){u(this,"hash");this.hash=e}static random(){return new Ge(l.random())}static fromBuffer(e){const t=J.asReader(e);return new this(t.readObject(l))}static fromString(e){return new Ge(l.fromString(e))}static fromBigInt(e){return new Ge(new l(e))}toBuffer(){return this.hash.toBuffer()}toString(){return this.hash.toString()}toBigInt(){return this.hash.toBigInt()}toJSON(){return this.toString()}equals(e){return this.hash.equals(e.hash)}static get schema(){return C.BufferHex.transform(e=>new Ge(l.fromBuffer(e)))}static zero(){return new Ge(l.ZERO)}static get SIZE(){return l.SIZE_IN_BYTES}}var B_=function(r){return r[r.OK=0]="OK",r[r.APP_LOGIC_REVERTED=1]="APP_LOGIC_REVERTED",r[r.TEARDOWN_REVERTED=2]="TEARDOWN_REVERTED",r[r.BOTH_REVERTED=3]="BOTH_REVERTED",r}({});function Eh(r){return r===0||r===1||r===2||r===3}const mt=class mt{constructor(e){u(this,"code");this.code=e.valueOf()}getCode(){return this.code}equals(e){return this.code===e.code}isOK(){return this.equals(mt.OK)}getDescription(){switch(this.code){case 0:return"OK";case 1:return"Application logic reverted";case 2:return"Teardown reverted";case 3:return"Both reverted";default:return`Unknown RevertCode: ${this.code}`}}toJSON(){return this.code}static get schema(){return Ya(B_).transform(e=>new mt(e))}toHashPreimage(){const e=Buffer.alloc(mt.PREIMAGE_SIZE_IN_BYTES-mt.PACKED_SIZE_IN_BYTES);return Buffer.concat([e,this.toBuffer()])}toBuffer(){const e=Buffer.alloc(mt.PACKED_SIZE_IN_BYTES);return e.writeUInt8(this.code,0),e}toField(){return new l(this.toBuffer())}getSerializedLength(){return this.toBuffer().length}static fromField(e){if(!Eh(e.toNumber()))throw new Error(`Invalid RevertCode: ${e.toNumber()}`);return new mt(e.toNumber())}static fromFields(e){const t=Ee.asReader(e);return mt.fromField(t.readField())}static fromBuffer(e){const n=J.asReader(e).readBytes(mt.PACKED_SIZE_IN_BYTES).readUInt8(0);if(!Eh(n))throw new Error(`Invalid RevertCode: ${n}`);return new mt(n)}static random(){return new mt(Math.floor(Math.random()*mt.NUM_OPTIONS))}[ue.inspect.custom](){return`RevertCode<${this.code.toString()}>`}};u(mt,"OK",new mt(0)),u(mt,"APP_LOGIC_REVERTED",new mt(1)),u(mt,"TEARDOWN_REVERTED",new mt(2)),u(mt,"BOTH_REVERTED",new mt(3)),u(mt,"PREIMAGE_SIZE_IN_BYTES",32),u(mt,"PACKED_SIZE_IN_BYTES",1),u(mt,"NUM_OPTIONS",4);let sn=mt;class wi extends Vt{constructor(e){super(e)}static random(){return new wi(l.random().toBuffer())}static get schema(){return C.BufferHex.transform(e=>new wi(e))}static zero(){return new wi(Vt.ZERO.toBuffer())}static fromField(e){return new wi(e.toBuffer())}}var Fo=function(r){return r.DROPPED="dropped",r.PENDING="pending",r.SUCCESS="success",r.APP_LOGIC_REVERTED="app_logic_reverted",r.TEARDOWN_REVERTED="teardown_reverted",r.BOTH_REVERTED="both_reverted",r}({});class ki{constructor(e,t,n,s,i,a){u(this,"txHash");u(this,"status");u(this,"error");u(this,"transactionFee");u(this,"blockHash");u(this,"blockNumber");this.txHash=e,this.status=t,this.error=n,this.transactionFee=s,this.blockHash=i,this.blockNumber=a}static empty(){return new ki(Ge.zero(),"dropped","")}static get schema(){return R({txHash:Ge.schema,status:Ya(Fo),error:we(),blockHash:wi.schema.optional(),blockNumber:se().int().nonnegative().optional(),transactionFee:C.BigInt.optional()}).transform(ki.from)}static from(e){return new ki(e.txHash,e.status,e.error,e.transactionFee,e.blockHash,e.blockNumber)}static statusFromRevertCode(e){if(e.equals(sn.OK))return"success";if(e.equals(sn.APP_LOGIC_REVERTED))return"app_logic_reverted";if(e.equals(sn.TEARDOWN_REVERTED))return"teardown_reverted";if(e.equals(sn.BOTH_REVERTED))return"both_reverted";throw new Error(`Unknown revert code: ${e.getCode()}`)}}class Br{constructor(e){u(this,"maxBlockNumber");this.maxBlockNumber=e}getSize(){return this.toBuffer().length}toBuffer(){return le(this.maxBlockNumber)}toString(){return tt(this.toBuffer())}static getFields(e){return[e.maxBlockNumber]}static fromFields(e){const t=Ee.asReader(e);return new Br(cr.fromFields(t))}toFields(){const e=Je(...Br.getFields(this));if(e.length!==Jd)throw new Error(`Invalid number of fields for RollupValidationRequests. Expected ${Jd}, got ${e.length}`);return e}static fromBuffer(e){const t=J.asReader(e);return new Br(t.readObject(cr))}static fromString(e){return Br.fromBuffer(dt(e))}static empty(){return new Br(cr.empty())}}class er{constructor(e,t,n,s,i,a){u(this,"noteHashes");u(this,"nullifiers");u(this,"l2ToL1Msgs");u(this,"privateLogs");u(this,"contractClassLogsHashes");u(this,"publicCallRequests");this.noteHashes=e,this.nullifiers=t,this.l2ToL1Msgs=n,this.privateLogs=s,this.contractClassLogsHashes=i,this.publicCallRequests=a}getSize(){return $r(this.noteHashes)+$r(this.nullifiers)+$r(this.l2ToL1Msgs)+$r(this.privateLogs)+$r(this.contractClassLogsHashes)+$r(this.publicCallRequests)}static getFields(e){return[e.noteHashes,e.nullifiers,e.l2ToL1Msgs,e.privateLogs,e.contractClassLogsHashes,e.publicCallRequests]}static fromFields(e){const t=Ee.asReader(e);return new this(t.readFieldArray(Bs),t.readFieldArray(Ts),t.readArray(xs,jr),t.readArray(Is,Bt),t.readArray(Ci,Fn),t.readArray(Ou,ut))}static from(e){return new er(...er.getFields(e))}static fromBuffer(e){const t=J.asReader(e);return new er(t.readArray(Bs,l),t.readArray(Ts,l),t.readArray(xs,jr),t.readArray(Is,Bt),t.readArray(Ci,Fn),t.readArray(Ou,ut))}toBuffer(){return le(...er.getFields(this))}toFields(){const e=Je(...er.getFields(this));if(e.length!==oh)throw new Error(`Invalid number of fields for PrivateToPublicAccumulatedData. Expected ${oh}, got ${e.length}`);return e}static empty(){return new er(Xe(Bs,l.zero),Xe(Ts,l.zero),Xe(xs,jr.empty),Xe(Is,Bt.empty),Xe(Ci,Fn.empty),Xe(Ou,ut.empty))}[ue.inspect.custom](){return`PrivateToPublicAccumulatedData {
      noteHashes: [${this.noteHashes.filter(e=>!e.isZero()).map(e=>ue.inspect(e)).join(", ")}],
      nullifiers: [${this.nullifiers.filter(e=>!e.isZero()).map(e=>ue.inspect(e)).join(", ")}],
      l2ToL1Msgs: [${this.l2ToL1Msgs.filter(e=>!e.isEmpty()).map(e=>ue.inspect(e)).join(", ")}],
      privateLogs: [${this.privateLogs.filter(e=>!e.isEmpty()).map(e=>ue.inspect(e)).join(", ")}],
      contractClassLogsHashes: [${this.contractClassLogsHashes.filter(e=>!e.isEmpty()).map(e=>ue.inspect(e)).join(", ")}],
      publicCallRequests: [${this.publicCallRequests.filter(e=>!e.isEmpty()).map(e=>ue.inspect(e)).join(", ")}],
    }`}}class vi{constructor(e,t,n,s,i,a,o){u(this,"constants");u(this,"rollupValidationRequests");u(this,"nonRevertibleAccumulatedData");u(this,"revertibleAccumulatedData");u(this,"publicTeardownCallRequest");u(this,"gasUsed");u(this,"feePayer");this.constants=e,this.rollupValidationRequests=t,this.nonRevertibleAccumulatedData=n,this.revertibleAccumulatedData=s,this.publicTeardownCallRequest=i,this.gasUsed=a,this.feePayer=o}toBuffer(){return le(this.constants,this.rollupValidationRequests,this.nonRevertibleAccumulatedData,this.revertibleAccumulatedData,this.publicTeardownCallRequest,this.gasUsed,this.feePayer)}static getFields(e){return[e.constants,e.rollupValidationRequests,e.nonRevertibleAccumulatedData,e.revertibleAccumulatedData,e.publicTeardownCallRequest,e.gasUsed,e.feePayer]}static fromBuffer(e){const t=J.asReader(e);return new vi(t.readObject(Ut),t.readObject(Br),t.readObject(er),t.readObject(er),t.readObject(ut),t.readObject(ke),t.readObject(W))}static empty(){return new vi(Ut.empty(),Br.empty(),er.empty(),er.empty(),ut.empty(),ke.empty(),W.ZERO)}static fromString(e){return vi.fromBuffer(dt(e))}toString(){return tt(this.toBuffer())}toFields(){const e=Je(...vi.getFields(this));if(e.length!==ch)throw new Error(`Invalid number of fields for PrivateToPublicKernelCircuitPublicInputs. Expected ${ch}, got ${e.length}`);return e}hash(){return wt(this.toFields(),nt.PUBLIC_TX_HASH)}}class or{constructor(e,t,n,s,i){u(this,"noteHashes");u(this,"nullifiers");u(this,"l2ToL1Msgs");u(this,"privateLogs");u(this,"contractClassLogsHashes");this.noteHashes=e,this.nullifiers=t,this.l2ToL1Msgs=n,this.privateLogs=s,this.contractClassLogsHashes=i}getSize(){return $r(this.noteHashes)+$r(this.nullifiers)+$r(this.l2ToL1Msgs)+$r(this.privateLogs)+$r(this.contractClassLogsHashes)}static getFields(e){return[e.noteHashes,e.nullifiers,e.l2ToL1Msgs,e.privateLogs,e.contractClassLogsHashes]}static from(e){return new or(...or.getFields(e))}static get schema(){return Ja(or)}toJSON(){return this.toBuffer()}toBuffer(){return le(...or.getFields(this))}toString(){return tt(this.toBuffer())}static fromBuffer(e){const t=J.asReader(e);return new or(t.readArray(Bs,l),t.readArray(Ts,l),t.readArray(xs,jr),t.readArray(Is,Bt),t.readArray(Ci,Fn))}static fromString(e){return or.fromBuffer(dt(e))}static empty(){return new or(Xe(Bs,l.zero),Xe(Ts,l.zero),Xe(xs,jr.empty),Xe(Is,Bt.empty),Xe(Ci,Fn.empty))}toFields(){const e=Je(...or.getFields(this));if(e.length!==ih)throw new Error(`Invalid number of fields for PrivateToRollupAccumulatedData. Expected ${ih}, got ${e.length}`);return e}[ue.inspect.custom](){return`PrivateToRollupAccumulatedData {
      noteHashes: [${this.noteHashes.filter(e=>!e.isZero()).map(e=>ue.inspect(e)).join(", ")}],
      nullifiers: [${this.nullifiers.filter(e=>!e.isZero()).map(e=>ue.inspect(e)).join(", ")}],
      l2ToL1Msgs: [${this.l2ToL1Msgs.filter(e=>!e.isEmpty()).map(e=>ue.inspect(e)).join(", ")}],
      privateLogs:  [${this.privateLogs.filter(e=>!e.isEmpty()).map(e=>ue.inspect(e)).join(", ")}]
      contractClassLogsHashes: : [${this.contractClassLogsHashes.filter(e=>!e.isEmpty()).map(e=>ue.inspect(e)).join(", ")}],
    }`}}class Us{constructor(e,t,n,s,i){u(this,"constants");u(this,"rollupValidationRequests");u(this,"end");u(this,"gasUsed");u(this,"feePayer");this.constants=e,this.rollupValidationRequests=t,this.end=n,this.gasUsed=s,this.feePayer=i}getNonEmptyNullifiers(){return this.end.nullifiers.filter(e=>!e.isZero())}toBuffer(){return le(this.constants,this.rollupValidationRequests,this.end,this.gasUsed,this.feePayer)}static fromBuffer(e){const t=J.asReader(e);return new Us(t.readObject(Ut),t.readObject(Br),t.readObject(or),t.readObject(ke),t.readObject(W))}static empty(){return new Us(Ut.empty(),Br.empty(),or.empty(),ke.empty(),W.ZERO)}toString(){return tt(this.toBuffer())}static fromString(e){return Us.fromBuffer(dt(e))}toJSON(){return this.toBuffer()}static getFields(e){return[e.constants,e.rollupValidationRequests,e.end,e.gasUsed,e.feePayer]}static get schema(){return Ja(Us)}toFields(){const e=Je(...Us.getFields(this));if(e.length!==uh)throw new Error(`Invalid number of fields for PrivateToRollupKernelCircuitPublicInputs. Expected ${uh}, got ${e.length}`);return e}hash(){return wt(this.toFields(),nt.PRIVATE_TX_HASH)}}class dc{constructor(e,t,n){u(this,"nonRevertibleAccumulatedData");u(this,"revertibleAccumulatedData");u(this,"publicTeardownCallRequest");this.nonRevertibleAccumulatedData=e,this.revertibleAccumulatedData=t,this.publicTeardownCallRequest=n}getSize(){return this.nonRevertibleAccumulatedData.getSize()+this.revertibleAccumulatedData.getSize()+this.publicTeardownCallRequest.getSize()}get needsSetup(){return!this.nonRevertibleAccumulatedData.publicCallRequests[0].isEmpty()}get needsAppLogic(){return!this.revertibleAccumulatedData.publicCallRequests[0].isEmpty()}get needsTeardown(){return!this.publicTeardownCallRequest.isEmpty()}static fromBuffer(e){const t=J.asReader(e);return new dc(t.readObject(er),t.readObject(er),t.readObject(ut))}toBuffer(){return le(this.nonRevertibleAccumulatedData,this.revertibleAccumulatedData,this.publicTeardownCallRequest)}static empty(){return new dc(er.empty(),er.empty(),ut.empty())}}class Li{constructor(e){u(this,"end");this.end=e}static fromBuffer(e){const t=J.asReader(e);return new Li(t.readObject(or))}getSize(){return this.end.getSize()}toBuffer(){return le(this.end)}static empty(){return new Li(or.empty())}}class xr{constructor(e,t,n,s,i,a){u(this,"constants");u(this,"rollupValidationRequests");u(this,"gasUsed");u(this,"feePayer");u(this,"forPublic");u(this,"forRollup");if(this.constants=e,this.rollupValidationRequests=t,this.gasUsed=n,this.feePayer=s,this.forPublic=i,this.forRollup=a,!i&&!a)throw new Error("Missing partial public inputs for private tail circuit.");if(i&&a)throw new Error("Cannot create PrivateKernelTailCircuitPublicInputs that is for both public kernel circuit and rollup circuit.")}static get schema(){return Ja(xr)}toJSON(){return this.toBuffer()}getSize(){var e,t;return(((e=this.forPublic)==null?void 0:e.getSize())??0)+(((t=this.forRollup)==null?void 0:t.getSize())??0)+this.constants.getSize()+this.rollupValidationRequests.getSize()+this.feePayer.size}toPrivateToPublicKernelCircuitPublicInputs(){if(!this.forPublic)throw new Error("Private tail public inputs is not for public circuit.");return new vi(this.constants,this.rollupValidationRequests,this.forPublic.nonRevertibleAccumulatedData,this.forPublic.revertibleAccumulatedData,this.forPublic.publicTeardownCallRequest,this.gasUsed,this.feePayer)}toPrivateToRollupKernelCircuitPublicInputs(){if(!this.forRollup)throw new Error("Private tail public inputs is not for rollup circuit.");const e=new Ut(this.constants.historicalHeader,this.constants.txContext,this.constants.vkTreeRoot,this.constants.protocolContractTreeRoot);return new Us(e,this.rollupValidationRequests,this.forRollup.end,this.gasUsed,this.feePayer)}numberOfPublicCallRequests(){return this.numberOfNonRevertiblePublicCallRequests()+this.numberOfRevertiblePublicCallRequests()+(this.hasTeardownPublicCallRequest()?1:0)}numberOfNonRevertiblePublicCallRequests(){return this.forPublic?fc(this.forPublic.nonRevertibleAccumulatedData.publicCallRequests):0}numberOfRevertiblePublicCallRequests(){return this.forPublic?fc(this.forPublic.revertibleAccumulatedData.publicCallRequests):0}hasTeardownPublicCallRequest(){return this.forPublic?!this.forPublic.publicTeardownCallRequest.isEmpty():!1}getNonRevertiblePublicCallRequests(){return this.forPublic?this.forPublic.nonRevertibleAccumulatedData.publicCallRequests.filter(e=>!e.isEmpty()):[]}getRevertiblePublicCallRequests(){return this.forPublic?this.forPublic.revertibleAccumulatedData.publicCallRequests.filter(e=>!e.isEmpty()):[]}getTeardownPublicCallRequest(){var t;const e=(t=this.forPublic)==null?void 0:t.publicTeardownCallRequest;return e!=null&&e.isEmpty()?void 0:e}getNonEmptyNoteHashes(){return(this.forPublic?yo(this.forPublic.nonRevertibleAccumulatedData.noteHashes,this.forPublic.revertibleAccumulatedData.noteHashes):this.forRollup.end.noteHashes).filter(t=>!t.isZero())}getNonEmptyNullifiers(){return(this.forPublic?yo(this.forPublic.nonRevertibleAccumulatedData.nullifiers,this.forPublic.revertibleAccumulatedData.nullifiers):this.forRollup.end.nullifiers).filter(t=>!t.isZero())}getNonEmptyPrivateLogs(){return(this.forPublic?yo(this.forPublic.nonRevertibleAccumulatedData.privateLogs,this.forPublic.revertibleAccumulatedData.privateLogs):this.forRollup.end.privateLogs).filter(t=>!t.isEmpty())}getNonEmptyContractClassLogsHashes(){return(this.forPublic?yo(this.forPublic.nonRevertibleAccumulatedData.contractClassLogsHashes,this.forPublic.revertibleAccumulatedData.contractClassLogsHashes):this.forRollup.end.contractClassLogsHashes).filter(t=>!t.isEmpty())}getEmittedContractClassLogsLength(){const e=t=>t.reduce((n,s)=>n+s.logHash.length,0);return this.forPublic?e(this.forPublic.nonRevertibleAccumulatedData.contractClassLogsHashes)+e(this.forPublic.revertibleAccumulatedData.contractClassLogsHashes):e(this.forRollup.end.contractClassLogsHashes)}getEmittedPrivateLogsLength(){const e=t=>t.reduce((n,s)=>n+s.emittedLength,0);return this.forPublic?e(this.forPublic.nonRevertibleAccumulatedData.privateLogs)+e(this.forPublic.revertibleAccumulatedData.privateLogs):e(this.forRollup.end.privateLogs)}static fromBuffer(e){const t=J.asReader(e),n=t.readBoolean();return new xr(t.readObject(Ut),t.readObject(Br),t.readObject(ke),t.readObject(W),n?t.readObject(dc):void 0,n?void 0:t.readObject(Li))}toBuffer(){const e=!!this.forPublic;return le(e,this.constants,this.rollupValidationRequests,this.gasUsed,this.feePayer,e?this.forPublic.toBuffer():this.forRollup.toBuffer())}static empty(){return new xr(Ut.empty(),Br.empty(),ke.empty(),W.ZERO,void 0,Li.empty())}static emptyWithNullifier(){const e=or.empty();return e.nullifiers[0]=l.random(),new xr(Ut.empty(),Br.empty(),ke.empty(),W.ZERO,void 0,new Li(e))}}class Bg{constructor(){u(this,"cachedId")}async p2pMessageIdentifier(){return this.cachedId?this.cachedId:(this.cachedId=await this.generateP2PMessageIdentifier(),this.cachedId)}toMessage(){return this.toBuffer()}}u(Bg,"p2pTopic");var T_=function(r){return r.tx="tx",r.block_proposal="block_proposal",r.block_attestation="block_attestation",r}({});const x_=172052;class mr{constructor(e){u(this,"clientIvcProofBuffer");this.clientIvcProofBuffer=e}isEmpty(){return this.clientIvcProofBuffer.length===0}static empty(){return new mr(Buffer.from(""))}static fake(e=Math.floor(Math.random()*255)){return new mr(Buffer.alloc(1,e))}static random(){return new mr(Buffer.from(Wr(x_)))}static get schema(){return Ja(mr)}toJSON(){return this.toBuffer()}static fromBuffer(e){const t=J.asReader(e);return new mr(t.readBuffer())}toBuffer(){return le(this.clientIvcProofBuffer.length,this.clientIvcProofBuffer)}}var qs,ha;const Wn=class Wn extends Bg{constructor(t,n,s,i){super();Vc(this,qs);u(this,"data");u(this,"clientIvcProof");u(this,"contractClassLogs");u(this,"publicFunctionCalldata");u(this,"txHash");u(this,"calldataMap");this.data=t,this.clientIvcProof=n,this.contractClassLogs=s,this.publicFunctionCalldata=i}async generateP2PMessageIdentifier(){return new Vt((await this.getTxHash()).toBuffer())}hasPublicCalls(){return this.numberOfPublicCalls()>0}numberOfPublicCalls(){return this.data.numberOfPublicCallRequests()}getNonRevertiblePublicCallRequestsWithCalldata(){return this.data.getNonRevertiblePublicCallRequests().map(t=>zt(this,qs,ha).call(this,t))}getRevertiblePublicCallRequestsWithCalldata(){return this.data.getRevertiblePublicCallRequests().map(t=>zt(this,qs,ha).call(this,t))}getTeardownPublicCallRequestWithCalldata(){const t=this.data.getTeardownPublicCallRequest();return t?zt(this,qs,ha).call(this,t):void 0}getPublicCallRequestsWithCalldata(){const t=this.data.getTeardownPublicCallRequest();return[...this.data.getNonRevertiblePublicCallRequests(),...this.data.getRevertiblePublicCallRequests(),...t?[t]:[]].map(s=>zt(this,qs,ha).call(this,s))}getTotalPublicCalldataCount(){return this.publicFunctionCalldata.reduce((t,n)=>t+n.values.length,0)}getGasSettings(){return this.data.constants.txContext.gasSettings}static fromBuffer(t){const n=J.asReader(t);return new Wn(n.readObject(xr),n.readObject(mr),n.readVectorUint8Prefix(Lt),n.readVectorUint8Prefix($t))}toBuffer(){return le([this.data,this.clientIvcProof,mn(this.contractClassLogs,1),mn(this.publicFunctionCalldata,1)])}static get schema(){return R({data:xr.schema,clientIvcProof:mr.schema,contractClassLogs:ee(Lt.schema),publicFunctionCalldata:ee($t.schema)}).transform(Wn.from)}static from(t){return new Wn(t.data,t.clientIvcProof,t.contractClassLogs,t.publicFunctionCalldata)}async getPublicLogs(t){return t.getPublicLogs({txHash:await this.getTxHash()})}async getSplitContractClassLogs(t,n=!1){if(!this.data.forPublic)return[];const s=t?this.data.forPublic.revertibleAccumulatedData.contractClassLogsHashes.filter(i=>!i.isEmpty()):this.data.forPublic.nonRevertibleAccumulatedData.contractClassLogsHashes.filter(i=>!i.isEmpty());return await this.filterContractClassLogs(s,n)}async filterContractClassLogs(t,n=!1){const s=[];for(const i of this.contractClassLogs){const a=await i.hash(),o=t.find(c=>c.value.equals(a));if(o){const c=zr.from({contractAddress:o.contractAddress,fields:i,emittedLength:o.logHash.length});s.push(n?await c.silo():c)}}return s}async getTxHash(t=!1){if(!this.txHash||t){const n=this.data.forPublic?await this.data.toPrivateToPublicKernelCircuitPublicInputs().hash():await this.data.toPrivateToRollupKernelCircuitPublicInputs().hash();this.txHash=new Ge(n)}return this.txHash}setTxHash(t){this.txHash=t}getCalldataMap(){if(!this.calldataMap){const t=new Map;this.publicFunctionCalldata.forEach(n=>t.set(n.hash.toString(),n.values)),this.calldataMap=t}return this.calldataMap}async getStats(){var t;return{txHash:(await this.getTxHash()).toString(),noteHashCount:this.data.getNonEmptyNoteHashes().length,nullifierCount:this.data.getNonEmptyNullifiers().length,privateLogCount:this.data.getNonEmptyPrivateLogs().length,classRegisteredCount:this.data.getNonEmptyContractClassLogsHashes().length,contractClassLogSize:this.data.getEmittedContractClassLogsLength(),proofSize:this.clientIvcProof.clientIvcProofBuffer.length,size:this.toBuffer().length,feePaymentMethod:(t=this.data.forPublic)!=null&&t.needsSetup?"fpc":"fee_juice"}}getSize(){return this.data.getSize()+this.clientIvcProof.clientIvcProofBuffer.length+$r(this.contractClassLogs)+this.publicFunctionCalldata.reduce((t,n)=>t+n.getSize(),0)}getEstimatedPrivateTxEffectsSize(){return this.data.getNonEmptyNoteHashes().length*l.SIZE_IN_BYTES+this.data.getNonEmptyNullifiers().length*l.SIZE_IN_BYTES+this.data.getEmittedPrivateLogsLength()*l.SIZE_IN_BYTES+this.data.getEmittedContractClassLogsLength()*l.SIZE_IN_BYTES}static async getHash(t){return I_(t)?t.hash:await t.getTxHash()}static async getHashes(t){return await Promise.all(t.map(Wn.getHash))}static clone(t){const n=xr.fromBuffer(t.data.toBuffer()),s=mr.fromBuffer(t.clientIvcProof.toBuffer()),i=t.contractClassLogs.map(c=>c.clone()),a=t.publicFunctionCalldata.map(c=>$t.fromBuffer(c.toBuffer())),o=new Wn(n,s,i,a);return t.txHash&&o.setTxHash(Ge.fromBuffer(t.txHash.toBuffer())),o}static random(t=!1){return new Wn(xr.emptyWithNullifier(),t?mr.random():mr.empty(),[Lt.random()],[$t.random()])}async filterRevertedLogs(){this.contractClassLogs=(await this.getSplitContractClassLogs(!1)).map(t=>t.fields)}};qs=new WeakSet,ha=function(t){const s=this.getCalldataMap().get(t.calldataHash.toString())??[];return new bi(t,s)},u(Wn,"p2pTopic",T_.tx);let _r=Wn;function I_(r){return r.hash!==void 0}class rn{constructor(e,t,n,s,i){u(this,"historicalHeader");u(this,"txContext");u(this,"vkTreeRoot");u(this,"protocolContractTreeRoot");u(this,"globalVariables");this.historicalHeader=e,this.txContext=t,this.vkTreeRoot=n,this.protocolContractTreeRoot=s,this.globalVariables=i}static combine(e,t){return new rn(e.historicalHeader,e.txContext,e.vkTreeRoot,e.protocolContractTreeRoot,t)}static get schema(){return R({historicalHeader:ct.schema,txContext:ft.schema,vkTreeRoot:q.Fr,protocolContractTreeRoot:q.Fr,globalVariables:It.schema}).transform(rn.from).or(Gr(rn))}toBuffer(){return le(this.historicalHeader,this.txContext,this.vkTreeRoot,this.protocolContractTreeRoot,this.globalVariables)}clone(){return rn.fromBuffer(this.toBuffer())}getSize(){return this.historicalHeader.getSize()+this.txContext.getSize()+this.vkTreeRoot.size+this.protocolContractTreeRoot.size+this.globalVariables.getSize()}static from({historicalHeader:e,txContext:t,vkTreeRoot:n,protocolContractTreeRoot:s,globalVariables:i}){return new rn(e,t,n,s,i)}static fromBuffer(e){const t=J.asReader(e);return new rn(t.readObject(ct),t.readObject(ft),l.fromBuffer(t),l.fromBuffer(t),t.readObject(It))}static fromFields(e){const t=Ee.asReader(e);return new rn(t.readObject(ct),t.readObject(ft),t.readField(),t.readField(),t.readObject(It))}static empty(){return new rn(ct.empty(),ft.empty(),l.ZERO,l.ZERO,It.empty())}}const ir=class ir{constructor(e,t){u(this,"leafSlot");u(this,"value");this.leafSlot=e,this.value=t}static get schema(){return R({leafSlot:q.Fr,value:q.Fr}).transform(ir.from)}static from(e){return new ir(...ir.getFields(e))}static getFields(e){return[e.leafSlot,e.value]}static fromFields(e){const t=Ee.asReader(e);return new ir(t.readField(),t.readField())}toFields(){const e=Je(...ir.getFields(this));if(e.length!==Kd)throw new Error(`Invalid number of fields for PublicDataWrite. Expected ${Kd}, got ${e.length}`);return e}static fromBlobFields(e){const t=Ee.asReader(e);return new ir(t.readField(),t.readField())}toBlobFields(){return[this.leafSlot,this.value]}static fromBuffer(e){const t=J.asReader(e);return new ir(l.fromBuffer(t),l.fromBuffer(t))}toBuffer(){return le(...ir.getFields(this))}static fromString(e){return ir.fromBuffer(dt(e))}toString(){return tt(this.toBuffer())}static empty(){return new ir(l.ZERO,l.ZERO)}static random(){return new ir(l.random(),l.random())}static isEmpty(e){return e.isEmpty()}isEmpty(){return this.leafSlot.isZero()&&this.value.isZero()}equals(e){return this.leafSlot.equals(e.leafSlot)&&this.value.equals(e.value)}};u(ir,"SIZE_IN_BYTES",l.SIZE_IN_BYTES*2);let Ei=ir;const Sr=class Sr{constructor(e,t,n){u(this,"contractAddress");u(this,"fields");u(this,"emittedLength");this.contractAddress=e,this.fields=t,this.emittedLength=n}static from(e){return new Sr(...Sr.getFields(e))}static getFields(e){return[e.contractAddress,e.fields,e.emittedLength]}toFields(){return Je(...Sr.getFields(this))}static fromFields(e){const t=Ee.asReader(e);return new Sr(t.readObject(W),t.readFieldArray(Hs),t.readU32())}getEmittedFields(){return this.fields.slice(0,this.emittedLength)}toBlobFields(){return[new l(this.emittedLength),this.contractAddress.toField()].concat(this.getEmittedFields())}static fromBlobFields(e){const t=Ee.asReader(e),n=t.readU32(),s=t.readObject(W),i=t.readFieldArray(n);return new Sr(s,Kl(i,l.ZERO,Hs),n)}isEmpty(){return this.contractAddress.isZero()&&this.fields.every(e=>e.isZero())&&this.emittedLength===0}static empty(){return new Sr(W.ZERO,Xe(Hs,l.zero),0)}toBuffer(){return le(...Sr.getFields(this))}static fromBuffer(e){const t=J.asReader(e);return new Sr(t.readObject(W),t.readArray(Hs,l),t.readNumber())}static async random(){return new Sr(await W.random(),Xe(Hs,l.random),Hs)}equals(e){return this.contractAddress.equals(e.contractAddress)&&this.fields.every((t,n)=>t.equals(e.fields[n]))&&this.emittedLength===e.emittedLength}toHumanReadable(){return`PublicLog: (contractAddress: ${this.contractAddress} fields: ${this.fields}) emittedLength: ${this.emittedLength}`}static get schema(){return R({contractAddress:W.schema,fields:ee(q.Fr).refine(e=>e.length===Hs),emittedLength:se()}).transform(({contractAddress:e,fields:t,emittedLength:n})=>Sr.fromFields([e.toField(),...t,new l(n)]))}[ue.inspect.custom](){return`PublicLog {
      contractAddress: ${ue.inspect(this.contractAddress)},
      fields: [${this.fields.map(e=>ue.inspect(e)).join(", ")}],
      emittedLength: ${this.emittedLength},
    }`}};u(Sr,"SIZE_IN_BYTES",l.SIZE_IN_BYTES*nA);let Kt=Sr;const Il=8392562855083340404n,ma=Il.toString(16).length/2,bo=ma+7;class lr{constructor(e,t,n,s,i,a,o,c,f,h){u(this,"revertCode");u(this,"txHash");u(this,"transactionFee");u(this,"noteHashes");u(this,"nullifiers");u(this,"l2ToL1Msgs");u(this,"publicDataWrites");u(this,"privateLogs");u(this,"publicLogs");u(this,"contractClassLogs");if(this.revertCode=e,this.txHash=t,this.transactionFee=n,this.noteHashes=s,this.nullifiers=i,this.l2ToL1Msgs=a,this.publicDataWrites=o,this.privateLogs=c,this.publicLogs=f,this.contractClassLogs=h,s.length>Bs)throw new Error(`Too many note hashes: ${s.length}, max: ${Bs}`);if(s.forEach(d=>{if(d.isZero())throw new Error("Note hash is zero")}),i.length>Ts)throw new Error(`Too many nullifiers: ${i.length}, max: ${Ts}`);if(i.forEach(d=>{if(d.isZero())throw new Error("Nullifier is zero")}),a.length>xs)throw new Error(`Too many L2 to L1 messages: ${a.length}, max: ${xs}`);if(a.forEach(d=>{if(d.isZero())throw new Error("L2 to L1 message is zero")}),o.length>Ru)throw new Error(`Too many public data writes: ${o.length}, max: ${Ru}`);if(o.forEach(d=>{if(d.isEmpty())throw new Error("Public data write is empty")}),c.length>Is)throw new Error(`Too many private logs: ${c.length}, max: ${Is}`);c.forEach(d=>{if(d.isEmpty())throw new Error("Private log is empty")})}toBuffer(){return le([this.revertCode,this.txHash,this.transactionFee,mn(this.noteHashes,1),mn(this.nullifiers,1),mn(this.l2ToL1Msgs,1),mn(this.publicDataWrites,1),mn(this.privateLogs,1),mn(this.publicLogs,1),mn(this.contractClassLogs,1)])}equals(e){return this.revertCode.equals(e.revertCode)&&this.txHash.equals(e.txHash)&&this.transactionFee.equals(e.transactionFee)&&this.noteHashes.length===e.noteHashes.length&&this.noteHashes.every((t,n)=>t.equals(e.noteHashes[n]))&&this.nullifiers.length===e.nullifiers.length&&this.nullifiers.every((t,n)=>t.equals(e.nullifiers[n]))&&this.l2ToL1Msgs.length===e.l2ToL1Msgs.length&&this.l2ToL1Msgs.every((t,n)=>t.equals(e.l2ToL1Msgs[n]))&&this.publicDataWrites.length===e.publicDataWrites.length&&this.publicDataWrites.every((t,n)=>t.equals(e.publicDataWrites[n]))&&this.privateLogs.length===e.privateLogs.length&&this.privateLogs.every((t,n)=>t.equals(e.privateLogs[n]))&&this.publicLogs.length===e.publicLogs.length&&this.publicLogs.every((t,n)=>t.equals(e.publicLogs[n]))&&this.contractClassLogs.length===e.contractClassLogs.length&&this.contractClassLogs.every((t,n)=>t.equals(e.contractClassLogs[n]))}getDASize(){return this.toBlobFields().length*l.SIZE_IN_BYTES}static fromBuffer(e){const t=J.asReader(e);return new lr(sn.fromBuffer(t),Ge.fromBuffer(t),l.fromBuffer(t),t.readVectorUint8Prefix(l),t.readVectorUint8Prefix(l),t.readVectorUint8Prefix(l),t.readVectorUint8Prefix(Ei),t.readVectorUint8Prefix(Bt),t.readVectorUint8Prefix(Kt),t.readVectorUint8Prefix(zr))}txOutHash(){const{l2ToL1Msgs:e}=this;if(e.length==0)return Buffer.alloc(32);const t=e.length==1?1:Math.ceil(Math.log2(e.length));let n=Kl(e.map(i=>i.toBuffer()),Buffer.alloc(32),2**t),s=[];for(let i=0;i<t;i++){for(let a=0;a<n.length;a+=2)s[a/2]=qp(Buffer.concat([n[a],n[a+1]]));n=s,s=[]}return n[0]}static async random(e=3,t=1){return new lr(sn.random(),Ge.random(),new l(Math.floor(Math.random()*1e5)),Xe(Bs,l.random),Xe(Ts,l.random),Xe(xs,l.random),Xe(Ru,Ei.random),Xe(Is,()=>Bt.random()),await Nd(e*t,async()=>await Kt.random()),await Nd(Ci,zr.random))}static empty(){return new lr(sn.OK,Ge.zero(),l.ZERO,[],[],[],[],[],[],[])}isEmpty(){return this.nullifiers.length===0}toString(){return tt(this.toBuffer())}toPrefix(e,t){const n=Buffer.alloc(4);return n.writeUint8(e),n.writeUInt16BE(t,2),new l(n)}static fromPrefix(e){const t=e.toBuffer().subarray(-4);return{type:t[0],length:new l(t.subarray(-2)).toNumber()}}encodeFirstField(e,t){const n=Buffer.alloc(2);return n.writeUInt16BE(e,0),new l(Buffer.concat([pr(Il,ma),Buffer.alloc(1),n,Buffer.alloc(1),Buffer.from([Fu]),Buffer.alloc(1),t.toBuffer()]))}static decodeFirstField(e){const t=e.toBuffer().subarray(-bo);return{length:new l(t.subarray(ma+1,ma+3)).toNumber(),revertCode:t[t.length-1]}}static isFirstField(e){const t=e.toBuffer();if(!t.subarray(0,e.size-bo).equals(Buffer.alloc(e.size-bo)))return!1;const n=t.subarray(-bo);return!(!new l(n.subarray(0,ma)).equals(new l(Il))||n[n.length-3]!==Fu||n[n.length-1]>4)}toBlobFields(){if(this.isEmpty())return[];const e=[];return e.push(l.ZERO),e.push(this.txHash.hash),e.push(new l(Buffer.concat([Buffer.from([iA]),Buffer.alloc(1),this.transactionFee.toBuffer().subarray(3)]))),this.noteHashes.length&&(e.push(this.toPrefix(dh,this.noteHashes.length)),e.push(...this.noteHashes)),this.nullifiers.length&&(e.push(this.toPrefix(hh,this.nullifiers.length)),e.push(...this.nullifiers)),this.l2ToL1Msgs.length&&(e.push(this.toPrefix(mh,this.l2ToL1Msgs.length)),e.push(...this.l2ToL1Msgs)),this.publicDataWrites.length&&(e.push(this.toPrefix(ph,this.publicDataWrites.length)),e.push(...this.publicDataWrites.flatMap(t=>t.toBlobFields()))),this.privateLogs.length&&(e.push(this.toPrefix(gh,this.privateLogs.length)),e.push(...this.privateLogs.flatMap(t=>t.toBlobFields()))),this.publicLogs.length&&(e.push(this.toPrefix(yh,this.publicLogs.length)),e.push(...this.publicLogs.flatMap(t=>t.toBlobFields()))),this.contractClassLogs.length&&(e.push(this.toPrefix(bh,this.contractClassLogs.length)),e.push(...this.contractClassLogs.flatMap(t=>t.toBlobFields()))),e[0]=this.encodeFirstField(e.length,this.revertCode),e}static fromBlobFields(e){const t=d=>{if(d.length)throw new Error("Invalid fields given to TxEffect.fromBlobFields(): Attempted to assign property twice.")},n=this.empty(),s=Ee.asReader(e),i=s.remainingFields();if(!i)return n;const a=s.readField();if(!this.isFirstField(a))throw new Error("Invalid fields given to TxEffect.fromBlobFields(): First field invalid.");const{length:o,revertCode:c}=this.decodeFirstField(a);n.revertCode=sn.fromField(new l(c)),n.txHash=new Ge(s.readField());const f=s.readField();n.transactionFee=l.fromBuffer(Buffer.concat([Buffer.alloc(3),f.toBuffer().subarray(3)]));let h=i-s.remainingFields();for(;h<o;){const{type:d,length:v}=this.fromPrefix(s.readField());switch(d){case dh:t(n.noteHashes),n.noteHashes=s.readFieldArray(v);break;case hh:t(n.nullifiers),n.nullifiers=s.readFieldArray(v);break;case mh:t(n.l2ToL1Msgs),n.l2ToL1Msgs=s.readFieldArray(v);break;case ph:{t(n.publicDataWrites),n.publicDataWrites=Array.from({length:v},()=>Ei.fromBlobFields(s));break}case gh:{t(n.privateLogs),n.privateLogs=Array.from({length:v},()=>Bt.fromBlobFields(s));break}case yh:{t(n.publicLogs),n.publicLogs=Array.from({length:v},()=>Kt.fromBlobFields(s));break}case bh:{t(n.contractClassLogs),n.contractClassLogs=Array.from({length:v},()=>zr.fromBlobFields(s));break}case Fu:default:throw new Error("Too many fields to decode given to TxEffect.fromBlobFields()")}h=i-s.remainingFields()}return n}static from(e){return new lr(e.revertCode,e.txHash,e.transactionFee,e.noteHashes,e.nullifiers,e.l2ToL1Msgs,e.publicDataWrites,e.privateLogs,e.publicLogs,e.contractClassLogs)}static get schema(){return R({revertCode:sn.schema,txHash:Ge.schema,transactionFee:q.Fr,noteHashes:ee(q.Fr),nullifiers:ee(q.Fr),l2ToL1Msgs:ee(q.Fr),publicDataWrites:ee(Ei.schema),privateLogs:ee(Bt.schema),publicLogs:ee(Kt.schema),contractClassLogs:ee(zr.schema)}).transform(lr.from)}[ue.inspect.custom](){return`TxEffect {
      revertCode: ${this.revertCode.getCode()},
      txHash: ${this.txHash},
      transactionFee: ${this.transactionFee},
      note hashes: [${this.noteHashes.map(e=>e.toString()).join(", ")}],
      nullifiers: [${this.nullifiers.map(e=>e.toString()).join(", ")}],
      l2ToL1Msgs: [${this.l2ToL1Msgs.map(e=>e.toString()).join(", ")}],
      publicDataWrites: [${this.publicDataWrites.map(e=>e.toString()).join(", ")}],
      privateLogs: [${this.privateLogs.map(e=>e.fields.map(t=>t.toString()).join(",")).join(", ")}],
      publicLogs: [${this.publicLogs.map(e=>e.fields.map(t=>t.toString()).join(",")).join(", ")}],
      contractClassLogs: [${this.contractClassLogs.map(e=>e.toFields().map(t=>t.toString()).join(",")).join(", ")}],
     }`}static fromString(e){return lr.fromBuffer(dt(e))}}const O_=R({functionName:we(),gateCount:se().optional(),bytecode:ac,witness:Io(se(),we()),vk:ac,timings:R({witgen:se(),gateCount:se().optional()})}),Tg=R({functionName:we(),time:se(),oracles:at(fr(we(),R({times:ee(se())})))}),xg=R({sync:at(se()),proving:at(se()),perFunction:ee(Tg),unaccounted:se(),total:se()}),Ig=R({sync:se(),publicSimulation:at(se()),validation:at(se()),perFunction:ee(Tg),unaccounted:se(),total:se()});class hc{constructor(e,t){u(this,"executionSteps");u(this,"timings");this.executionSteps=e,this.timings=t}static get schema(){return R({executionSteps:ee(O_),timings:xg}).transform(({executionSteps:e,timings:t})=>new hc(e,t))}static random(){return new hc([{functionName:"random",bytecode:Buffer.from("random"),witness:new Map([[1,"random"]]),vk:Buffer.from("random"),timings:{witgen:1,gateCount:1}}],{sync:1,proving:1,perFunction:[{functionName:"random",time:1}],unaccounted:1,total:4})}}class mc{constructor(e,t){u(this,"result");u(this,"timings");this.result=e,this.timings=t}static get schema(){return R({result:$a,timings:at(Ig)}).transform(({result:e,timings:t})=>new mc(e,t))}static random(){return new mc(l.random().toBigInt(),{sync:1,publicSimulation:1,validation:1,perFunction:[{functionName:"random",time:1}],unaccounted:1,total:5})}}class Sa{constructor(e,t,n,s){u(this,"privateExecutionResult");u(this,"publicInputs");u(this,"clientIvcProof");u(this,"timings");this.privateExecutionResult=e,this.publicInputs=t,this.clientIvcProof=n,this.timings=s}toTx(){const e=_g(this.privateExecutionResult);return new _r(this.publicInputs,this.clientIvcProof,e,this.privateExecutionResult.publicFunctionCalldata)}static get schema(){return R({privateExecutionResult:rs.schema,publicInputs:xr.schema,clientIvcProof:mr.schema,timings:at(xg)}).transform(Sa.from)}static from(e){return new Sa(e.privateExecutionResult,e.publicInputs,e.clientIvcProof)}static async random(){return new Sa(await rs.random(),xr.empty(),mr.empty())}}var Sh=1/0,R_=9007199254740991,F_=17976931348623157e292,Ah=NaN,Cu=4294967295,C_="[object Symbol]",P_=/^\s+|\s+$/g,N_=/^[-+]0x[0-9a-f]+$/i,k_=/^0b[01]+$/i,L_=/^0o[0-7]+$/i,$_=parseInt;function H_(r,e){for(var t=-1,n=Array(r);++t<r;)n[t]=e(t);return n}var D_=Object.prototype,M_=D_.toString,U_=Math.min;function _h(r){var e=typeof r;return!!r&&(e=="object"||e=="function")}function j_(r){return!!r&&typeof r=="object"}function Z_(r){return typeof r=="symbol"||j_(r)&&M_.call(r)==C_}function z_(r){if(!r)return r===0?r:0;if(r=q_(r),r===Sh||r===-Sh){var e=r<0?-1:1;return e*F_}return r===r?r:0}function V_(r){var e=z_(r),t=e%1;return e===e?t?e-t:e:0}function q_(r){if(typeof r=="number")return r;if(Z_(r))return Ah;if(_h(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=_h(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=r.replace(P_,"");var t=k_.test(r);return t||L_.test(r)?$_(r.slice(2),t?2:8):N_.test(r)?Ah:+r}function W_(r){return r}function G_(r,e){if(r=V_(r),r<1||r>R_)return[];var t=Cu,n=U_(r,Cu);e=typeof e=="function"?e:W_,r-=Cu;for(var s=H_(n,e);++t<r;)e(t);return s}var K_=G_;const Og=Ua(K_),Y_=R({filePath:we(),line:se().int().nonnegative(),column:se().int().nonnegative(),fileSource:we(),locationText:we()}),X_=Yt([ee(Y_),ee(we())]);function J_(r){return typeof r[0]=="string"}class Ma extends Error{constructor(t,n,s=[],i,a){super(t,a);u(this,"originalMessage");u(this,"functionErrorStack");u(this,"revertData");u(this,"noirErrorStack");u(this,"aztecContext");this.originalMessage=t,this.functionErrorStack=n,this.revertData=s,this.noirErrorStack=i,this.aztecContext="";const o=()=>this.getMessage(),c=()=>this.getStack();Object.defineProperties(this,{message:{configurable:!1,enumerable:!0,get(){return o()}},stack:{configurable:!1,enumerable:!0,get(){return c()},set(f){}}})}getMessage(){return this.noirErrorStack&&!J_(this.noirErrorStack)&&this.noirErrorStack.length?`${this.originalMessage} '${this.noirErrorStack[this.noirErrorStack.length-1].locationText}'${this.aztecContext}`:this.originalMessage}getOriginalMessage(){return this.originalMessage}setOriginalMessage(t){this.originalMessage=t}enrichWithContractName(t,n){this.functionErrorStack.forEach(s=>{s.contractAddress.equals(t)&&(s.contractName=n)})}enrichWithFunctionName(t,n,s){this.functionErrorStack.forEach(i=>{i.contractAddress.equals(t)&&i.functionSelector&&i.functionSelector.equals(n)&&(i.functionName=s)})}getStack(){const t=this.getCallStack(),n=this.getNoirCallStack(),s=[...t.map(i=>{var a;return`at ${i.contractName??i.contractAddress.toString()}.${i.functionName??((a=i.functionSelector)==null?void 0:a.toString())??"unknown"}`}),...n.map(i=>typeof i=="string"?`at opcode ${i}`:`at ${i.locationText} (${i.filePath}:${i.line}:${i.column})`)];return[`Simulation error: ${this.message}`,...s.reverse()].join(`
`)}getCallStack(){return this.functionErrorStack}getNoirCallStack(){return this.noirErrorStack||[]}setNoirCallStack(t){this.noirErrorStack=t}setAztecContext(t){this.aztecContext=t}toJSON(){return{originalMessage:this.originalMessage,functionErrorStack:this.functionErrorStack,noirErrorStack:this.noirErrorStack,revertData:this.revertData.map(t=>t.toString())}}static get schema(){return R({originalMessage:we(),functionErrorStack:ee(R({contractAddress:C.AztecAddress,contractName:we().optional(),functionSelector:at(C.FunctionSelector),functionName:we().optional()})),noirErrorStack:X_.optional(),revertData:ee(C.Fr)}).transform(({originalMessage:t,functionErrorStack:n,noirErrorStack:s,revertData:i})=>new Ma(t,n,i,s))}static async random(){return new Ma("Random simulation error",[{contractAddress:await W.random(),functionSelector:ze.random()}])}}class Jn{constructor(e,t){u(this,"values");u(this,"nested");this.values=e,this.nested=t??[]}static get schema(){return R({values:ee(q.Fr).optional(),nested:ee(Bn(()=>Jn.schema))}).transform(({values:e,nested:t})=>new Jn(e,t))}static empty(){return new Jn([])}static random(e=1){return new Jn(Og(3,l.random),e>0?[Jn.random(e-1)]:[])}}class Wi{constructor(e,t,n,s,i){u(this,"revertReason");u(this,"constants");u(this,"txEffect");u(this,"publicReturnValues");u(this,"gasUsed");this.revertReason=e,this.constants=t,this.txEffect=n,this.publicReturnValues=s,this.gasUsed=i}static get schema(){return R({revertReason:Ma.schema.optional(),constants:rn.schema,txEffect:lr.schema,publicReturnValues:ee(Jn.schema),gasUsed:R({totalGas:ke.schema,teardownGas:ke.schema,publicGas:ke.schema,billedGas:ke.schema})}).transform(e=>new Wi(e.revertReason,e.constants,e.txEffect,e.publicReturnValues,e.gasUsed))}static async random(){return new Wi(await Ma.random(),rn.empty(),lr.empty(),Og(2,Jn.random),{teardownGas:ke.random(),totalGas:ke.random(),publicGas:ke.random(),billedGas:ke.random()})}}class Bh{constructor(e,t){u(this,"privateExecutionResult");u(this,"publicInputs");this.privateExecutionResult=e,this.publicInputs=t}getPrivateReturnValues(){return Q_(this.privateExecutionResult)}toSimulatedTx(){const e=_g(this.privateExecutionResult);return new _r(this.publicInputs,mr.empty(),e,this.privateExecutionResult.publicFunctionCalldata)}}class Si{constructor(e,t,n,s){u(this,"privateExecutionResult");u(this,"publicInputs");u(this,"publicOutput");u(this,"timings");this.privateExecutionResult=e,this.publicInputs=t,this.publicOutput=n,this.timings=s}get gasUsed(){var e;return((e=this.publicOutput)==null?void 0:e.gasUsed)??{totalGas:this.publicInputs.gasUsed,billedGas:this.publicInputs.gasUsed,teardownGas:ke.empty(),publicGas:ke.empty()}}static get schema(){return R({privateExecutionResult:rs.schema,publicInputs:xr.schema,publicOutput:Wi.schema.optional(),timings:at(Ig)}).transform(Si.from)}static from(e){return new Si(e.privateExecutionResult,e.publicInputs,e.publicOutput,e.timings)}static fromPrivateSimulationResultAndPublicOutput(e,t,n){return new Si(e.privateExecutionResult,e.publicInputs,t,n)}static async random(){return new Si(await rs.random(),xr.empty(),await Wi.random())}getPrivateReturnValues(){return new Bh(this.privateExecutionResult,this.publicInputs).getPrivateReturnValues()}toSimulatedTx(){return new Bh(this.privateExecutionResult,this.publicInputs).toSimulatedTx()}getPublicReturnValues(){return this.publicOutput?this.publicOutput.publicReturnValues:[]}}function Q_(r){const e=t=>{const n=new Jn(t.returnValues);return n.nested=t.nestedExecutions.map(s=>e(s)),n};return e(r.entrypoint)}class es{constructor(e,t,n){u(this,"contractAddress");u(this,"storageSlot");u(this,"data");this.contractAddress=e,this.storageSlot=t,this.data=n}static get schema(){return Gr(es)}toJSON(){return this.toString()}toBuffer(){return le(this.contractAddress,this.storageSlot,new Os(this.data))}static fromBuffer(e){const t=J.asReader(e);return new es(W.fromBuffer(t),l.fromBuffer(t),t.readVector(l))}toString(){return tt(this.toBuffer())}static fromString(e){return es.fromBuffer(dt(e))}}class gn{constructor(e,t,n,s,i,a,o,c=l.random()){u(this,"origin");u(this,"functionSelector");u(this,"firstCallArgsHash");u(this,"txContext");u(this,"argsOfCalls");u(this,"authWitnesses");u(this,"capsules");u(this,"salt");this.origin=e,this.functionSelector=t,this.firstCallArgsHash=n,this.txContext=s,this.argsOfCalls=i,this.authWitnesses=a,this.capsules=o,this.salt=c}static get schema(){return R({origin:C.AztecAddress,functionSelector:C.FunctionSelector,firstCallArgsHash:C.Fr,txContext:ft.schema,argsOfCalls:ee($t.schema),authWitnesses:ee(Qn.schema),capsules:ee(es.schema),salt:C.Fr}).transform(gn.from)}toTxRequest(){return new ys(this.origin,new Yn(this.functionSelector,!0),this.firstCallArgsHash,this.txContext,this.salt)}static getFields(e){return[e.origin,e.functionSelector,e.firstCallArgsHash,e.txContext,e.argsOfCalls,e.authWitnesses,e.capsules,e.salt]}static from(e){return new gn(...gn.getFields(e))}toBuffer(){return le(this.origin,this.functionSelector,this.firstCallArgsHash,this.txContext,new Os(this.argsOfCalls),new Os(this.authWitnesses),new Os(this.capsules),this.salt)}toString(){return tt(this.toBuffer())}static fromBuffer(e){const t=J.asReader(e);return new gn(t.readObject(W),t.readObject(ze),l.fromBuffer(t),t.readObject(ft),t.readVector($t),t.readVector(Qn),t.readVector(es),l.fromBuffer(t))}static fromString(e){return gn.fromBuffer(dt(e))}static async random(){return new gn(await W.random(),ze.random(),l.random(),ft.empty(),[$t.random()],[Qn.random()],[new es(await W.random(),l.random(),[l.random(),l.random()]),new es(await W.random(),l.random(),[l.random()])],l.random())}[ue.inspect.custom](){return`TxExecutionRequest(${this.origin} called ${this.functionSelector})`}}const eB=Ql("result",[R({result:st("valid"),reason:ee(we()).optional()}),R({result:st("invalid"),reason:ee(we())}),R({result:st("skipped"),reason:ee(we())})]);function Rg(r){return R({data:r,l2BlockNumber:C.Integer,l2BlockHash:we()})}function Fg(){return Rg(lr.schema).extend({txIndexInBlock:q.Integer})}class As{constructor(e){u(this,"txEffects");this.txEffects=e,e.forEach(t=>{if(t.isEmpty())throw new Error("Empty tx effect not allowed in Body")})}equals(e){return this.txEffects.length===e.txEffects.length&&this.txEffects.every((t,n)=>t.equals(e.txEffects[n]))}static get schema(){return R({txEffects:ee(lr.schema)}).transform(({txEffects:e})=>new As(e))}toBuffer(){return le(this.txEffects.length,this.txEffects)}static fromBuffer(e){const t=J.asReader(e);return new this(t.readVector(lr))}toBlobFields(){let e=[];if(this.txEffects.forEach(t=>{e=e.concat(t.toBlobFields())}),e.length>Ld*kd)throw new Error(`Attempted to overfill block's blobs with ${e.length} elements. The maximum is ${Ld*kd}`);return e}static fromBlobFields(e){const t=[],n=new Ee(e);for(;!n.isFinished();)t.push(lr.fromBlobFields(n));return new this(t)}[ue.inspect.custom](){return`Body {
  txEffects: ${ue.inspect(this.txEffects)},
}`}static async random(e=4,t=3,n=1){const s=await ip(e,()=>lr.random(t,n));return new As(s)}static empty(){return new As([])}}function tB(r=0,e=void 0,t=void 0,n=void 0,s=void 0){return new ct($i(r+256),rB(r+512,e,s),nB(r+1536),iB(r+=1792,t,n??t),new l(r+2048),new l(r+2304))}function $i(r=1){return new xe(new l(r),r)}function rB(r=0,e=void 0,t=void 0){return new hr(e?new l(e):new l(r),pr(BigInt(r+256),Ct),t??pr(BigInt(r+512),Ct),pr(BigInt(r+768),Ct))}function nB(r=0){return new En($i(r),sB(r+1))}function sB(r=0){return new vn($i(r),$i(r+1),$i(r+2))}function iB(r=1,e=void 0,t=void 0){return new It(new l(r),new l(r+1),new l(e??r+2),new l(t??r+3),new l(r+4),gr.fromField(new l(r+5)),W.fromField(new l(r+6)),new Ye(new l(r+7),new l(r+8)))}class bn{constructor(e,t,n){u(this,"archive");u(this,"header");u(this,"body");this.archive=e,this.header=t,this.body=n}static get schema(){return R({archive:xe.schema,header:ct.schema,body:As.schema}).transform(({archive:e,header:t,body:n})=>new bn(e,t,n))}static fromBuffer(e){const t=J.asReader(e),n=t.readObject(ct),s=t.readObject(xe),i=t.readObject(As);return new bn(s,n,i)}toBuffer(){return le(this.header,this.archive,this.body)}static fromString(e){return bn.fromBuffer(dt(e))}toString(){return tt(this.toBuffer())}static async random(e,t=4,n=3,s=1,i=void 0,a=void 0){const o=await As.random(t,n,s);return new bn($i(e+1),tB(0,t,e,a??e,i),o)}static empty(){return new bn(xe.zero(),ct.empty(),As.empty())}get number(){return this.header.getBlockNumber()}hash(){return this.header.hash()}getStats(){const e={privateLogCount:this.body.txEffects.reduce((t,n)=>t+n.privateLogs.length,0),publicLogCount:this.body.txEffects.reduce((t,n)=>t+n.publicLogs.length,0),contractClassLogCount:this.body.txEffects.reduce((t,n)=>t+n.contractClassLogs.length,0),contractClassLogSize:this.body.txEffects.reduce((t,n)=>t+n.contractClassLogs.reduce((s,i)=>s+i.emittedLength,0),0)};return{txCount:this.body.txEffects.length,blockNumber:this.number,blockTimestamp:this.header.globalVariables.timestamp.toNumber(),...e}}equals(e){return this.archive.equals(e.archive)&&this.header.equals(e.header)&&this.body.equals(e.body)}}class aB extends Error{constructor(){super(...arguments);u(this,"name","InterruptError")}}class oB extends Error{constructor(){super(...arguments);u(this,"name","TimeoutError")}}class jI extends Error{constructor(){super(...arguments);u(this,"name","AbortError")}}class ZI{constructor(){u(this,"interrupts",[])}async sleep(e){let t;const n=new Promise(a=>{t=a,this.interrupts.push(a)}),s=new Promise(a=>setTimeout(()=>a(!1),e)),i=await Promise.race([n,s]);if(this.interrupts=this.interrupts.filter(a=>a!==t),i)throw new aB("Interrupted.")}interrupt(e=!1){this.interrupts.forEach(t=>t(e)),this.interrupts=[]}}function Cg(r,e){return new Promise(t=>setTimeout(()=>t(e),r))}function cB(){let r,e;return{promise:new Promise((n,s)=>{r=n,e=s}),resolve:r,reject:e}}function zI(r,e){if(r!==0&&!e)throw new Error(`Hash is required for non-genesis blocks (got block number ${r})`);return{number:r,hash:e}}const Pu=Yt([R({number:st(0),hash:Na()}),R({number:se(),hash:we()})]),uB=R({latest:Pu,proven:Pu,finalized:Pu}),Er=Yt([C.Integer,st("latest")]),lB=R({block:bn.schema,l1:R({blockNumber:q.BigInt,timestamp:q.BigInt,blockHash:we()}),signatures:ee(zn.schema)});class Vr{constructor(e,t,n){u(this,"blockNumber");u(this,"txIndex");u(this,"logIndex");if(this.blockNumber=e,this.txIndex=t,this.logIndex=n,!Number.isInteger(e)||e<q1)throw new Error(`Invalid block number: ${e}`);if(!Number.isInteger(t))throw new Error(`Invalid tx index: ${t}`);if(!Number.isInteger(n))throw new Error(`Invalid log index: ${n}`)}static random(){return new Vr(Math.floor(Math.random()*1e3)+1,Math.floor(Math.random()*1e3),Math.floor(Math.random()*100))}static get schema(){return R({blockNumber:C.Integer,txIndex:C.Integer,logIndex:C.Integer}).transform(({blockNumber:e,txIndex:t,logIndex:n})=>new Vr(e,t,n))}toBuffer(){return Buffer.concat([pr(BigInt(this.blockNumber),4),pr(BigInt(this.txIndex),4),pr(BigInt(this.logIndex),4)])}static fromBuffer(e){const t=J.asReader(e),n=t.readNumber(),s=t.readNumber(),i=t.readNumber();return new Vr(n,s,i)}toString(){return`${this.blockNumber}-${this.txIndex}-${this.logIndex}`}static fromString(e){const[t,n,s]=e.split("-"),i=Number(t),a=Number(n),o=Number(s);return new Vr(i,a,o)}toHumanReadable(){return`logId: (blockNumber: ${this.blockNumber}, txIndex: ${this.txIndex}, logIndex: ${this.logIndex})`}}const pc=R({txHash:Ge.schema.optional(),fromBlock:C.Integer.optional(),toBlock:C.Integer.optional(),afterLog:Vr.schema.optional(),contractAddress:C.AztecAddress.optional()});var gc={exports:{}};gc.exports;(function(r,e){var t=200,n="__lodash_hash_undefined__",s=1,i=2,a=9007199254740991,o="[object Arguments]",c="[object Array]",f="[object AsyncFunction]",h="[object Boolean]",d="[object Date]",v="[object Error]",b="[object Function]",D="[object GeneratorFunction]",U="[object Map]",ie="[object Number]",K="[object Null]",I="[object Object]",x="[object Promise]",k="[object Proxy]",re="[object RegExp]",ye="[object Set]",fe="[object String]",Fe="[object Symbol]",Se="[object Undefined]",Ve="[object WeakMap]",rt="[object ArrayBuffer]",Te="[object DataView]",B="[object Float32Array]",Q="[object Float64Array]",z="[object Int8Array]",L="[object Int16Array]",te="[object Int32Array]",he="[object Uint8Array]",P="[object Uint8ClampedArray]",F="[object Uint16Array]",Y="[object Uint32Array]",Z=/[\\^$.*+?()[\]{}|]/g,y=/^\[object .+?Constructor\]$/,g=/^(?:0|[1-9]\d*)$/,p={};p[B]=p[Q]=p[z]=p[L]=p[te]=p[he]=p[P]=p[F]=p[Y]=!0,p[o]=p[c]=p[rt]=p[h]=p[Te]=p[d]=p[v]=p[b]=p[U]=p[ie]=p[I]=p[re]=p[ye]=p[fe]=p[Ve]=!1;var E=typeof globalThis=="object"&&globalThis&&globalThis.Object===Object&&globalThis,M=typeof self=="object"&&self&&self.Object===Object&&self,N=E||M||Function("return this")(),$=e&&!e.nodeType&&e,X=$&&!0&&r&&!r.nodeType&&r,ge=X&&X.exports===$,Oe=ge&&E.process,Ue=function(){try{return Oe&&Oe.binding&&Oe.binding("util")}catch{}}(),pt=Ue&&Ue.isTypedArray;function jt(m,S){for(var j=-1,me=m==null?0:m.length,lt=0,Ce=[];++j<me;){var vt=m[j];S(vt,j,m)&&(Ce[lt++]=vt)}return Ce}function Ir(m,S){for(var j=-1,me=S.length,lt=m.length;++j<me;)m[lt+j]=S[j];return m}function Kr(m,S){for(var j=-1,me=m==null?0:m.length;++j<me;)if(S(m[j],j,m))return!0;return!1}function Dt(m,S){for(var j=-1,me=Array(m);++j<m;)me[j]=S(j);return me}function H(m){return function(S){return m(S)}}function cs(m,S){return m.has(S)}function Xt(m,S){return m==null?void 0:m[S]}function Dn(m){var S=-1,j=Array(m.size);return m.forEach(function(me,lt){j[++S]=[lt,me]}),j}function Yr(m,S){return function(j){return m(S(j))}}function _(m){var S=-1,j=Array(m.size);return m.forEach(function(me){j[++S]=me}),j}var O=Array.prototype,ae=Function.prototype,pe=Object.prototype,ve=N["__core-js_shared__"],Ne=ae.toString,Ae=pe.hasOwnProperty,je=function(){var m=/[^.]+$/.exec(ve&&ve.keys&&ve.keys.IE_PROTO||"");return m?"Symbol(src)_1."+m:""}(),qe=pe.toString,Tt=RegExp("^"+Ne.call(Ae).replace(Z,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ot=ge?N.Buffer:void 0,ln=N.Symbol,Mn=N.Uint8Array,us=pe.propertyIsEnumerable,Xr=O.splice,wr=ln?ln.toStringTag:void 0,pf=Object.getOwnPropertySymbols,fy=Ot?Ot.isBuffer:void 0,dy=Yr(Object.keys,Object),Dc=oi(N,"DataView"),ta=oi(N,"Map"),Mc=oi(N,"Promise"),Uc=oi(N,"Set"),jc=oi(N,"WeakMap"),ra=oi(Object,"create"),hy=Ns(Dc),my=Ns(ta),py=Ns(Mc),gy=Ns(Uc),yy=Ns(jc),gf=ln?ln.prototype:void 0,Zc=gf?gf.valueOf:void 0;function Cs(m){var S=-1,j=m==null?0:m.length;for(this.clear();++S<j;){var me=m[S];this.set(me[0],me[1])}}function by(){this.__data__=ra?ra(null):{},this.size=0}function wy(m){var S=this.has(m)&&delete this.__data__[m];return this.size-=S?1:0,S}function vy(m){var S=this.__data__;if(ra){var j=S[m];return j===n?void 0:j}return Ae.call(S,m)?S[m]:void 0}function Ey(m){var S=this.__data__;return ra?S[m]!==void 0:Ae.call(S,m)}function Sy(m,S){var j=this.__data__;return this.size+=this.has(m)?0:1,j[m]=ra&&S===void 0?n:S,this}Cs.prototype.clear=by,Cs.prototype.delete=wy,Cs.prototype.get=vy,Cs.prototype.has=Ey,Cs.prototype.set=Sy;function Un(m){var S=-1,j=m==null?0:m.length;for(this.clear();++S<j;){var me=m[S];this.set(me[0],me[1])}}function Ay(){this.__data__=[],this.size=0}function _y(m){var S=this.__data__,j=so(S,m);if(j<0)return!1;var me=S.length-1;return j==me?S.pop():Xr.call(S,j,1),--this.size,!0}function By(m){var S=this.__data__,j=so(S,m);return j<0?void 0:S[j][1]}function Ty(m){return so(this.__data__,m)>-1}function xy(m,S){var j=this.__data__,me=so(j,m);return me<0?(++this.size,j.push([m,S])):j[me][1]=S,this}Un.prototype.clear=Ay,Un.prototype.delete=_y,Un.prototype.get=By,Un.prototype.has=Ty,Un.prototype.set=xy;function Ps(m){var S=-1,j=m==null?0:m.length;for(this.clear();++S<j;){var me=m[S];this.set(me[0],me[1])}}function Iy(){this.size=0,this.__data__={hash:new Cs,map:new(ta||Un),string:new Cs}}function Oy(m){var S=io(this,m).delete(m);return this.size-=S?1:0,S}function Ry(m){return io(this,m).get(m)}function Fy(m){return io(this,m).has(m)}function Cy(m,S){var j=io(this,m),me=j.size;return j.set(m,S),this.size+=j.size==me?0:1,this}Ps.prototype.clear=Iy,Ps.prototype.delete=Oy,Ps.prototype.get=Ry,Ps.prototype.has=Fy,Ps.prototype.set=Cy;function no(m){var S=-1,j=m==null?0:m.length;for(this.__data__=new Ps;++S<j;)this.add(m[S])}function Py(m){return this.__data__.set(m,n),this}function Ny(m){return this.__data__.has(m)}no.prototype.add=no.prototype.push=Py,no.prototype.has=Ny;function ls(m){var S=this.__data__=new Un(m);this.size=S.size}function ky(){this.__data__=new Un,this.size=0}function Ly(m){var S=this.__data__,j=S.delete(m);return this.size=S.size,j}function $y(m){return this.__data__.get(m)}function Hy(m){return this.__data__.has(m)}function Dy(m,S){var j=this.__data__;if(j instanceof Un){var me=j.__data__;if(!ta||me.length<t-1)return me.push([m,S]),this.size=++j.size,this;j=this.__data__=new Ps(me)}return j.set(m,S),this.size=j.size,this}ls.prototype.clear=ky,ls.prototype.delete=Ly,ls.prototype.get=$y,ls.prototype.has=Hy,ls.prototype.set=Dy;function My(m,S){var j=ao(m),me=!j&&tb(m),lt=!j&&!me&&zc(m),Ce=!j&&!me&&!lt&&Bf(m),vt=j||me||lt||Ce,Rt=vt?Dt(m.length,String):[],Mt=Rt.length;for(var gt in m)Ae.call(m,gt)&&!(vt&&(gt=="length"||lt&&(gt=="offset"||gt=="parent")||Ce&&(gt=="buffer"||gt=="byteLength"||gt=="byteOffset")||Yy(gt,Mt)))&&Rt.push(gt);return Rt}function so(m,S){for(var j=m.length;j--;)if(Ef(m[j][0],S))return j;return-1}function Uy(m,S,j){var me=S(m);return ao(m)?me:Ir(me,j(m))}function na(m){return m==null?m===void 0?Se:K:wr&&wr in Object(m)?Gy(m):eb(m)}function yf(m){return sa(m)&&na(m)==o}function bf(m,S,j,me,lt){return m===S?!0:m==null||S==null||!sa(m)&&!sa(S)?m!==m&&S!==S:jy(m,S,j,me,bf,lt)}function jy(m,S,j,me,lt,Ce){var vt=ao(m),Rt=ao(S),Mt=vt?c:fs(m),gt=Rt?c:fs(S);Mt=Mt==o?I:Mt,gt=gt==o?I:gt;var vr=Mt==I,Jr=gt==I,Zt=Mt==gt;if(Zt&&zc(m)){if(!zc(S))return!1;vt=!0,vr=!1}if(Zt&&!vr)return Ce||(Ce=new ls),vt||Bf(m)?wf(m,S,j,me,lt,Ce):qy(m,S,Mt,j,me,lt,Ce);if(!(j&s)){var Or=vr&&Ae.call(m,"__wrapped__"),Rr=Jr&&Ae.call(S,"__wrapped__");if(Or||Rr){var ds=Or?m.value():m,jn=Rr?S.value():S;return Ce||(Ce=new ls),lt(ds,jn,j,me,Ce)}}return Zt?(Ce||(Ce=new ls),Wy(m,S,j,me,lt,Ce)):!1}function Zy(m){if(!_f(m)||Jy(m))return!1;var S=Sf(m)?Tt:y;return S.test(Ns(m))}function zy(m){return sa(m)&&Af(m.length)&&!!p[na(m)]}function Vy(m){if(!Qy(m))return dy(m);var S=[];for(var j in Object(m))Ae.call(m,j)&&j!="constructor"&&S.push(j);return S}function wf(m,S,j,me,lt,Ce){var vt=j&s,Rt=m.length,Mt=S.length;if(Rt!=Mt&&!(vt&&Mt>Rt))return!1;var gt=Ce.get(m);if(gt&&Ce.get(S))return gt==S;var vr=-1,Jr=!0,Zt=j&i?new no:void 0;for(Ce.set(m,S),Ce.set(S,m);++vr<Rt;){var Or=m[vr],Rr=S[vr];if(me)var ds=vt?me(Rr,Or,vr,S,m,Ce):me(Or,Rr,vr,m,S,Ce);if(ds!==void 0){if(ds)continue;Jr=!1;break}if(Zt){if(!Kr(S,function(jn,ks){if(!cs(Zt,ks)&&(Or===jn||lt(Or,jn,j,me,Ce)))return Zt.push(ks)})){Jr=!1;break}}else if(!(Or===Rr||lt(Or,Rr,j,me,Ce))){Jr=!1;break}}return Ce.delete(m),Ce.delete(S),Jr}function qy(m,S,j,me,lt,Ce,vt){switch(j){case Te:if(m.byteLength!=S.byteLength||m.byteOffset!=S.byteOffset)return!1;m=m.buffer,S=S.buffer;case rt:return!(m.byteLength!=S.byteLength||!Ce(new Mn(m),new Mn(S)));case h:case d:case ie:return Ef(+m,+S);case v:return m.name==S.name&&m.message==S.message;case re:case fe:return m==S+"";case U:var Rt=Dn;case ye:var Mt=me&s;if(Rt||(Rt=_),m.size!=S.size&&!Mt)return!1;var gt=vt.get(m);if(gt)return gt==S;me|=i,vt.set(m,S);var vr=wf(Rt(m),Rt(S),me,lt,Ce,vt);return vt.delete(m),vr;case Fe:if(Zc)return Zc.call(m)==Zc.call(S)}return!1}function Wy(m,S,j,me,lt,Ce){var vt=j&s,Rt=vf(m),Mt=Rt.length,gt=vf(S),vr=gt.length;if(Mt!=vr&&!vt)return!1;for(var Jr=Mt;Jr--;){var Zt=Rt[Jr];if(!(vt?Zt in S:Ae.call(S,Zt)))return!1}var Or=Ce.get(m);if(Or&&Ce.get(S))return Or==S;var Rr=!0;Ce.set(m,S),Ce.set(S,m);for(var ds=vt;++Jr<Mt;){Zt=Rt[Jr];var jn=m[Zt],ks=S[Zt];if(me)var Tf=vt?me(ks,jn,Zt,S,m,Ce):me(jn,ks,Zt,m,S,Ce);if(!(Tf===void 0?jn===ks||lt(jn,ks,j,me,Ce):Tf)){Rr=!1;break}ds||(ds=Zt=="constructor")}if(Rr&&!ds){var oo=m.constructor,co=S.constructor;oo!=co&&"constructor"in m&&"constructor"in S&&!(typeof oo=="function"&&oo instanceof oo&&typeof co=="function"&&co instanceof co)&&(Rr=!1)}return Ce.delete(m),Ce.delete(S),Rr}function vf(m){return Uy(m,sb,Ky)}function io(m,S){var j=m.__data__;return Xy(S)?j[typeof S=="string"?"string":"hash"]:j.map}function oi(m,S){var j=Xt(m,S);return Zy(j)?j:void 0}function Gy(m){var S=Ae.call(m,wr),j=m[wr];try{m[wr]=void 0;var me=!0}catch{}var lt=qe.call(m);return me&&(S?m[wr]=j:delete m[wr]),lt}var Ky=pf?function(m){return m==null?[]:(m=Object(m),jt(pf(m),function(S){return us.call(m,S)}))}:ib,fs=na;(Dc&&fs(new Dc(new ArrayBuffer(1)))!=Te||ta&&fs(new ta)!=U||Mc&&fs(Mc.resolve())!=x||Uc&&fs(new Uc)!=ye||jc&&fs(new jc)!=Ve)&&(fs=function(m){var S=na(m),j=S==I?m.constructor:void 0,me=j?Ns(j):"";if(me)switch(me){case hy:return Te;case my:return U;case py:return x;case gy:return ye;case yy:return Ve}return S});function Yy(m,S){return S=S??a,!!S&&(typeof m=="number"||g.test(m))&&m>-1&&m%1==0&&m<S}function Xy(m){var S=typeof m;return S=="string"||S=="number"||S=="symbol"||S=="boolean"?m!=="__proto__":m===null}function Jy(m){return!!je&&je in m}function Qy(m){var S=m&&m.constructor,j=typeof S=="function"&&S.prototype||pe;return m===j}function eb(m){return qe.call(m)}function Ns(m){if(m!=null){try{return Ne.call(m)}catch{}try{return m+""}catch{}}return""}function Ef(m,S){return m===S||m!==m&&S!==S}var tb=yf(function(){return arguments}())?yf:function(m){return sa(m)&&Ae.call(m,"callee")&&!us.call(m,"callee")},ao=Array.isArray;function rb(m){return m!=null&&Af(m.length)&&!Sf(m)}var zc=fy||ab;function nb(m,S){return bf(m,S)}function Sf(m){if(!_f(m))return!1;var S=na(m);return S==b||S==D||S==f||S==k}function Af(m){return typeof m=="number"&&m>-1&&m%1==0&&m<=a}function _f(m){var S=typeof m;return m!=null&&(S=="object"||S=="function")}function sa(m){return m!=null&&typeof m=="object"}var Bf=pt?H(pt):zy;function sb(m){return rb(m)?My(m):Vy(m)}function ib(){return[]}function ab(){return!1}r.exports=nb})(gc,gc.exports);var fB=gc.exports;const Pg=Ua(fB);class js{constructor(e,t){u(this,"id");u(this,"log");this.id=e,this.log=t}static async random(){return new js(Vr.random(),await Kt.random())}static get schema(){return R({id:Vr.schema,log:Kt.schema}).transform(js.from)}static from(e){return new js(e.id,e.log)}toBuffer(){return Buffer.concat([this.id.toBuffer(),this.log.toBuffer()])}toString(){return tt(this.toBuffer())}toHumanReadable(){return`${this.id.toHumanReadable()}, ${this.log.toHumanReadable()}`}equals(e){return Pg(this,e)}static fromBuffer(e){const t=J.asReader(e),n=Vr.fromBuffer(t),s=Kt.fromBuffer(t);return new js(n,s)}static fromString(e){return js.fromBuffer(dt(e))}}class Zs{constructor(e,t){u(this,"id");u(this,"log");this.id=e,this.log=t}static async random(){return new Zs(Vr.random(),await zr.random())}static get schema(){return R({id:Vr.schema,log:zr.schema}).transform(Zs.from)}static from(e){return new Zs(e.id,e.log)}toBuffer(){return Buffer.concat([this.id.toBuffer(),this.log.toBuffer()])}toString(){return tt(this.toBuffer())}equals(e){return Pg(this,e)}static fromBuffer(e){const t=J.asReader(e),n=Vr.fromBuffer(t),s=zr.fromBuffer(t);return new Zs(n,s)}static fromString(e){return Zs.fromBuffer(dt(e))}}class Aa{constructor(e,t,n,s,i){u(this,"txHash");u(this,"dataStartIndexForTx");u(this,"logIndexInTx");u(this,"blockNumber");u(this,"log");this.txHash=e,this.dataStartIndexForTx=t,this.logIndexInTx=n,this.blockNumber=s,this.log=i}get isFromPublic(){return this.log instanceof Kt}static get schema(){return R({txHash:Ge.schema,dataStartIndexForTx:se(),logIndexInTx:se(),blockNumber:se(),log:Yt([Bt.schema,Kt.schema])}).transform(({txHash:e,dataStartIndexForTx:t,logIndexInTx:n,blockNumber:s,log:i})=>new Aa(e,t,n,s,i))}toBuffer(){const e=this.log instanceof Kt;return Buffer.concat([this.txHash.toBuffer(),ya(this.dataStartIndexForTx),ya(this.logIndexInTx),ya(this.blockNumber),Sp(e),this.log.toBuffer()])}static fromBuffer(e){const t=J.asReader(e),n=t.readObject(Ge),s=t.readNumber(),i=t.readNumber(),a=t.readNumber(),c=t.readBoolean()?Kt.fromBuffer(t):Bt.fromBuffer(t);return new Aa(n,s,i,a,c)}static async random(e=Math.random()<.5){const t=e?await Kt.random():Bt.random();return new Aa(Ge.random(),1,1,1,t)}equals(e){return this.txHash.equals(e.txHash)&&this.dataStartIndexForTx===e.dataStartIndexForTx&&this.logIndexInTx===e.logIndexInTx&&this.blockNumber===e.blockNumber&&(this.log instanceof Kt&&e.log instanceof Kt||this.log instanceof Bt&&e.log instanceof Bt)&&this.log.equals(e.log)}}class _a{constructor(e,t,n,s,i){u(this,"note");u(this,"recipient");u(this,"contractAddress");u(this,"storageSlot");u(this,"txHash");this.note=e,this.recipient=t,this.contractAddress=n,this.storageSlot=s,this.txHash=i}toBuffer(){return le([this.note,this.recipient,this.contractAddress,this.storageSlot,this.txHash])}static fromBuffer(e){const t=J.asReader(e),n=t.readObject(Tr),s=t.readObject(W),i=t.readObject(W),a=t.readObject(l),o=t.readObject(Ge);return new this(n,s,i,a,o)}static get schema(){return R({note:Tr.schema,recipient:C.AztecAddress,contractAddress:C.AztecAddress,storageSlot:C.Fr,txHash:Ge.schema}).transform(({note:e,recipient:t,contractAddress:n,storageSlot:s,txHash:i})=>new _a(e,t,n,s,i))}toString(){return tt(this.toBuffer())}static fromString(e){return _a.fromBuffer(dt(e))}static async random(){return new _a(Tr.random(),await W.random(),await W.random(),l.random(),Ge.random())}}class Ba extends _a{constructor(t,n,s,i,a,o){super(t,n,s,i,a);u(this,"nonce");this.nonce=o}static get schema(){return R({note:Tr.schema,recipient:C.AztecAddress,contractAddress:C.AztecAddress,storageSlot:C.Fr,txHash:Ge.schema,nonce:C.Fr}).transform(({note:t,recipient:n,contractAddress:s,storageSlot:i,txHash:a,nonce:o})=>new Ba(t,n,s,i,a,o))}toBuffer(){return le([this.note,this.recipient,this.contractAddress,this.storageSlot,this.txHash,this.nonce])}static async random(){return new Ba(Tr.random(),await W.random(),await W.random(),l.random(),Ge.random(),l.random())}static fromBuffer(t){const n=J.asReader(t),s=n.readObject(Tr),i=n.readObject(W),a=n.readObject(W),o=n.readObject(l),c=n.readObject(Ge),f=n.readObject(l);return new this(s,i,a,o,c,f)}static fromString(t){return Ba.fromBuffer(dt(t))}}var dB=function(r){return r[r.ACTIVE=1]="ACTIVE",r[r.ACTIVE_OR_NULLIFIED=2]="ACTIVE_OR_NULLIFIED",r}({});const hB=R({txHash:Ge.schema.optional(),contractAddress:C.AztecAddress.optional(),storageSlot:C.Fr.optional(),recipient:C.AztecAddress.optional(),status:Ya(dB).optional(),siloedNullifier:C.Fr.optional(),scopes:ee(C.AztecAddress).optional()});var mB={space:"",cycles:!1,replacer:(r,e)=>e,stringify:JSON.stringify},ai={isArray:Array.isArray,assign:Object.assign,isObject:r=>typeof r=="object",isFunction:r=>typeof r=="function",isBoolean:r=>typeof r=="boolean",isRegex:r=>r instanceof RegExp,keys:Object.keys};const la=mB,pB=ai.isFunction,gB=ai.isBoolean,yB=ai.isObject,bB=ai.isArray,wB=ai.isRegex,vB=ai.assign,EB=ai.keys;function SB(r){return r==null?r:wB(r)?r.toString():r.toJSON?r.toJSON():r}function AB(r,e){e=e||vB({},la),pB(e)&&(e={compare:e});const t=e.space||la.space,n=gB(e.cycles)?e.cycles:la.cycles,s=e.replacer||la.replacer,i=e.stringify||la.stringify,a=e.compare&&function(c){return function(f){return function(h,d){const v={key:h,value:f[h]},b={key:d,value:f[d]};return c(v,b)}}}(e.compare);n||i(r);const o=[];return function c(f,h,d,v){const b=t?`
`+new Array(v+1).join(t):"",D=t?": ":":";if(d=SB(d),d=s.call(f,h,d),d!==void 0){if(!yB(d)||d===null)return i(d);if(bB(d)){const U=[];for(let ie=0;ie<d.length;ie++){const K=c(d,ie,d[ie],v+1)||i(null);U.push(b+t+K)}return"["+U.join(",")+b+"]"}else{if(n){if(o.indexOf(d)!==-1)return i("[Circular]");o.push(d)}const U=EB(d).sort(a&&a(d)),ie=[];for(let K=0;K<U.length;K++){const I=U[K],x=c(d,I,d[I],v+1);if(!x)continue;const k=i(I)+D+x;ie.push(b+t+k)}return o.splice(o.indexOf(d),1),"{"+ie.join(",")+b+"}"}}}({"":r},"",r,0)}var _B=AB;const Ng=Ua(_B),kg=1,Gi=JE(Vp,l);async function Lg(r){if("privateFunctionRoot"in r&&"utilityFunctionRoot"in r&&"metadataHash"in r){const{privateFunctionRoot:n,utilityFunctionRoot:s,metadataHash:i}=r,a=[n,s,i].map(o=>o.toBuffer());return Gi(Buffer.concat([rf(kg),...a]))}const e=await BB(r),t=Lg(e);return FB().trace("Computed artifact hash",{artifactHash:t,...e}),t}async function BB(r){const e=await Th(r,tr.PRIVATE),t=await Th(r,tr.UTILITY),n=TB(r);return{privateFunctionRoot:e,utilityFunctionRoot:t,metadataHash:n}}function TB(r){return Gi(Buffer.from(Ng({name:r.name,outputs:r.outputs}),"utf-8"))}async function Th(r,e){const t=await xB(r,e);return t!=null&&t.root?l.fromBuffer(t.root):l.ZERO}async function xB(r,e){const t=await IB(r,e);if(t.length===0)return;const n=Math.ceil(Math.log2(t.length));return(await Cc.create(n,Buffer.alloc(32),CB())).computeTree(t.map(i=>i.toBuffer()))}async function IB(r,e){const t=await Promise.all(r.functions.filter(n=>n.functionType===e).map(async n=>({...n,selector:await ze.fromNameAndParameters(n.name,n.parameters)})));return t.sort((n,s)=>n.selector.value-s.selector.value),await Promise.all(t.map(OB))}async function OB(r){const e="selector"in r?r.selector:await ze.fromNameAndParameters(r),t=Gi(r.bytecode).toBuffer(),n="functionMetadataHash"in r?r.functionMetadataHash:RB(r);return Gi(Buffer.concat([rf(kg),e.toBuffer(),n.toBuffer(),t]))}function RB(r){return Gi(Buffer.from(Ng(r.returnTypes),"utf8"))}function FB(){return Fs("circuits:artifact_hash")}function CB(){return(r,e)=>Promise.resolve(Gi(Buffer.concat([r,e])).toBuffer())}async function PB(r){const e=await Nc(r);return xl(r.publicKeys,e)}async function Nc(r){const e="saltedInitializationHash"in r?r.saltedInitializationHash:await NB(r);return wt([r.originalContractClassId,e],nt.PARTIAL_ADDRESS)}function NB(r){return wt([r.salt,r.initializationHash,r.deployer],nt.PARTIAL_ADDRESS)}async function kB(r,e){if(!r)return l.ZERO;const t=await ze.fromNameAndParameters(r.name,r.parameters),n=bg(r,e);return $g(t,n)}async function $g(r,e){const t=await og(e);return wt([r,t],nt.CONSTRUCTOR)}var Nu={exports:{}},ku={},xh;function Hg(){if(xh)return ku;xh=1;function r(I){"@babel/helpers - typeof";return r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},r(I)}function e(I,x,k){return Object.defineProperty(I,"prototype",{writable:!1}),I}function t(I,x){if(!(I instanceof x))throw new TypeError("Cannot call a class as a function")}function n(I,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function");I.prototype=Object.create(x&&x.prototype,{constructor:{value:I,writable:!0,configurable:!0}}),Object.defineProperty(I,"prototype",{writable:!1}),x&&s(I,x)}function s(I,x){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(re,ye){return re.__proto__=ye,re},s(I,x)}function i(I){var x=c();return function(){var re=f(I),ye;if(x){var fe=f(this).constructor;ye=Reflect.construct(re,arguments,fe)}else ye=re.apply(this,arguments);return a(this,ye)}}function a(I,x){if(x&&(r(x)==="object"||typeof x=="function"))return x;if(x!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return o(I)}function o(I){if(I===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return I}function c(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function f(I){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(k){return k.__proto__||Object.getPrototypeOf(k)},f(I)}var h={},d,v;function b(I,x,k){k||(k=Error);function re(fe,Fe,Se){return typeof x=="string"?x:x(fe,Fe,Se)}var ye=function(fe){n(Se,fe);var Fe=i(Se);function Se(Ve,rt,Te){var B;return t(this,Se),B=Fe.call(this,re(Ve,rt,Te)),B.code=I,B}return e(Se)}(k);h[I]=ye}function D(I,x){if(Array.isArray(I)){var k=I.length;return I=I.map(function(re){return String(re)}),k>2?"one of ".concat(x," ").concat(I.slice(0,k-1).join(", "),", or ")+I[k-1]:k===2?"one of ".concat(x," ").concat(I[0]," or ").concat(I[1]):"of ".concat(x," ").concat(I[0])}else return"of ".concat(x," ").concat(String(I))}function U(I,x,k){return I.substr(0,x.length)===x}function ie(I,x,k){return(k===void 0||k>I.length)&&(k=I.length),I.substring(k-x.length,k)===x}function K(I,x,k){return typeof k!="number"&&(k=0),k+x.length>I.length?!1:I.indexOf(x,k)!==-1}return b("ERR_AMBIGUOUS_ARGUMENT",'The "%s" argument is ambiguous. %s',TypeError),b("ERR_INVALID_ARG_TYPE",function(I,x,k){d===void 0&&(d=Ol()),d(typeof I=="string","'name' must be a string");var re;typeof x=="string"&&U(x,"not ")?(re="must not be",x=x.replace(/^not /,"")):re="must be";var ye;if(ie(I," argument"))ye="The ".concat(I," ").concat(re," ").concat(D(x,"type"));else{var fe=K(I,".")?"property":"argument";ye='The "'.concat(I,'" ').concat(fe," ").concat(re," ").concat(D(x,"type"))}return ye+=". Received type ".concat(r(k)),ye},TypeError),b("ERR_INVALID_ARG_VALUE",function(I,x){var k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"is invalid";v===void 0&&(v=ue);var re=v.inspect(x);return re.length>128&&(re="".concat(re.slice(0,128),"...")),"The argument '".concat(I,"' ").concat(k,". Received ").concat(re)},TypeError),b("ERR_INVALID_RETURN_VALUE",function(I,x,k){var re;return k&&k.constructor&&k.constructor.name?re="instance of ".concat(k.constructor.name):re="type ".concat(r(k)),"Expected ".concat(I,' to be returned from the "').concat(x,'"')+" function but got ".concat(re,".")},TypeError),b("ERR_MISSING_ARGS",function(){for(var I=arguments.length,x=new Array(I),k=0;k<I;k++)x[k]=arguments[k];d===void 0&&(d=Ol()),d(x.length>0,"At least one arg needs to be specified");var re="The ",ye=x.length;switch(x=x.map(function(fe){return'"'.concat(fe,'"')}),ye){case 1:re+="".concat(x[0]," argument");break;case 2:re+="".concat(x[0]," and ").concat(x[1]," arguments");break;default:re+=x.slice(0,ye-1).join(", "),re+=", and ".concat(x[ye-1]," arguments");break}return"".concat(re," must be specified")},TypeError),ku.codes=h,ku}var Lu,Ih;function LB(){if(Ih)return Lu;Ih=1;function r(P,F){var Y=Object.keys(P);if(Object.getOwnPropertySymbols){var Z=Object.getOwnPropertySymbols(P);F&&(Z=Z.filter(function(y){return Object.getOwnPropertyDescriptor(P,y).enumerable})),Y.push.apply(Y,Z)}return Y}function e(P){for(var F=1;F<arguments.length;F++){var Y=arguments[F]!=null?arguments[F]:{};F%2?r(Object(Y),!0).forEach(function(Z){t(P,Z,Y[Z])}):Object.getOwnPropertyDescriptors?Object.defineProperties(P,Object.getOwnPropertyDescriptors(Y)):r(Object(Y)).forEach(function(Z){Object.defineProperty(P,Z,Object.getOwnPropertyDescriptor(Y,Z))})}return P}function t(P,F,Y){return F=a(F),F in P?Object.defineProperty(P,F,{value:Y,enumerable:!0,configurable:!0,writable:!0}):P[F]=Y,P}function n(P,F){if(!(P instanceof F))throw new TypeError("Cannot call a class as a function")}function s(P,F){for(var Y=0;Y<F.length;Y++){var Z=F[Y];Z.enumerable=Z.enumerable||!1,Z.configurable=!0,"value"in Z&&(Z.writable=!0),Object.defineProperty(P,a(Z.key),Z)}}function i(P,F,Y){return F&&s(P.prototype,F),Object.defineProperty(P,"prototype",{writable:!1}),P}function a(P){var F=o(P,"string");return I(F)==="symbol"?F:String(F)}function o(P,F){if(I(P)!=="object"||P===null)return P;var Y=P[Symbol.toPrimitive];if(Y!==void 0){var Z=Y.call(P,F);if(I(Z)!=="object")return Z;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(P)}function c(P,F){if(typeof F!="function"&&F!==null)throw new TypeError("Super expression must either be null or a function");P.prototype=Object.create(F&&F.prototype,{constructor:{value:P,writable:!0,configurable:!0}}),Object.defineProperty(P,"prototype",{writable:!1}),F&&ie(P,F)}function f(P){var F=D();return function(){var Z=K(P),y;if(F){var g=K(this).constructor;y=Reflect.construct(Z,arguments,g)}else y=Z.apply(this,arguments);return h(this,y)}}function h(P,F){if(F&&(I(F)==="object"||typeof F=="function"))return F;if(F!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return d(P)}function d(P){if(P===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return P}function v(P){var F=typeof Map=="function"?new Map:void 0;return v=function(Z){if(Z===null||!U(Z))return Z;if(typeof Z!="function")throw new TypeError("Super expression must either be null or a function");if(typeof F<"u"){if(F.has(Z))return F.get(Z);F.set(Z,y)}function y(){return b(Z,arguments,K(this).constructor)}return y.prototype=Object.create(Z.prototype,{constructor:{value:y,enumerable:!1,writable:!0,configurable:!0}}),ie(y,Z)},v(P)}function b(P,F,Y){return D()?b=Reflect.construct.bind():b=function(y,g,p){var E=[null];E.push.apply(E,g);var M=Function.bind.apply(y,E),N=new M;return p&&ie(N,p.prototype),N},b.apply(null,arguments)}function D(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function U(P){return Function.toString.call(P).indexOf("[native code]")!==-1}function ie(P,F){return ie=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Z,y){return Z.__proto__=y,Z},ie(P,F)}function K(P){return K=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Y){return Y.__proto__||Object.getPrototypeOf(Y)},K(P)}function I(P){"@babel/helpers - typeof";return I=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(F){return typeof F}:function(F){return F&&typeof Symbol=="function"&&F.constructor===Symbol&&F!==Symbol.prototype?"symbol":typeof F},I(P)}var x=ue,k=x.inspect,re=Hg(),ye=re.codes.ERR_INVALID_ARG_TYPE;function fe(P,F,Y){return(Y===void 0||Y>P.length)&&(Y=P.length),P.substring(Y-F.length,Y)===F}function Fe(P,F){if(F=Math.floor(F),P.length==0||F==0)return"";var Y=P.length*F;for(F=Math.floor(Math.log(F)/Math.log(2));F;)P+=P,F--;return P+=P.substring(0,Y-P.length),P}var Se="",Ve="",rt="",Te="",B={deepStrictEqual:"Expected values to be strictly deep-equal:",strictEqual:"Expected values to be strictly equal:",strictEqualObject:'Expected "actual" to be reference-equal to "expected":',deepEqual:"Expected values to be loosely deep-equal:",equal:"Expected values to be loosely equal:",notDeepStrictEqual:'Expected "actual" not to be strictly deep-equal to:',notStrictEqual:'Expected "actual" to be strictly unequal to:',notStrictEqualObject:'Expected "actual" not to be reference-equal to "expected":',notDeepEqual:'Expected "actual" not to be loosely deep-equal to:',notEqual:'Expected "actual" to be loosely unequal to:',notIdentical:"Values identical but not reference-equal:"},Q=10;function z(P){var F=Object.keys(P),Y=Object.create(Object.getPrototypeOf(P));return F.forEach(function(Z){Y[Z]=P[Z]}),Object.defineProperty(Y,"message",{value:P.message}),Y}function L(P){return k(P,{compact:!1,customInspect:!1,depth:1e3,maxArrayLength:1/0,showHidden:!1,breakLength:1/0,showProxy:!1,sorted:!0,getters:!0})}function te(P,F,Y){var Z="",y="",g=0,p="",E=!1,M=L(P),N=M.split(`
`),$=L(F).split(`
`),X=0,ge="";if(Y==="strictEqual"&&I(P)==="object"&&I(F)==="object"&&P!==null&&F!==null&&(Y="strictEqualObject"),N.length===1&&$.length===1&&N[0]!==$[0]){var Oe=N[0].length+$[0].length;if(Oe<=Q){if((I(P)!=="object"||P===null)&&(I(F)!=="object"||F===null)&&(P!==0||F!==0))return"".concat(B[Y],`

`)+"".concat(N[0]," !== ").concat($[0],`
`)}else if(Y!=="strictEqualObject"){var Ue=process.stderr&&process.stderr.isTTY?process.stderr.columns:80;if(Oe<Ue){for(;N[0][X]===$[0][X];)X++;X>2&&(ge=`
  `.concat(Fe(" ",X),"^"),X=0)}}}for(var pt=N[N.length-1],jt=$[$.length-1];pt===jt&&(X++<2?p=`
  `.concat(pt).concat(p):Z=pt,N.pop(),$.pop(),!(N.length===0||$.length===0));)pt=N[N.length-1],jt=$[$.length-1];var Ir=Math.max(N.length,$.length);if(Ir===0){var Kr=M.split(`
`);if(Kr.length>30)for(Kr[26]="".concat(Se,"...").concat(Te);Kr.length>27;)Kr.pop();return"".concat(B.notIdentical,`

`).concat(Kr.join(`
`),`
`)}X>3&&(p=`
`.concat(Se,"...").concat(Te).concat(p),E=!0),Z!==""&&(p=`
  `.concat(Z).concat(p),Z="");var Dt=0,H=B[Y]+`
`.concat(Ve,"+ actual").concat(Te," ").concat(rt,"- expected").concat(Te),cs=" ".concat(Se,"...").concat(Te," Lines skipped");for(X=0;X<Ir;X++){var Xt=X-g;if(N.length<X+1)Xt>1&&X>2&&(Xt>4?(y+=`
`.concat(Se,"...").concat(Te),E=!0):Xt>3&&(y+=`
  `.concat($[X-2]),Dt++),y+=`
  `.concat($[X-1]),Dt++),g=X,Z+=`
`.concat(rt,"-").concat(Te," ").concat($[X]),Dt++;else if($.length<X+1)Xt>1&&X>2&&(Xt>4?(y+=`
`.concat(Se,"...").concat(Te),E=!0):Xt>3&&(y+=`
  `.concat(N[X-2]),Dt++),y+=`
  `.concat(N[X-1]),Dt++),g=X,y+=`
`.concat(Ve,"+").concat(Te," ").concat(N[X]),Dt++;else{var Dn=$[X],Yr=N[X],_=Yr!==Dn&&(!fe(Yr,",")||Yr.slice(0,-1)!==Dn);_&&fe(Dn,",")&&Dn.slice(0,-1)===Yr&&(_=!1,Yr+=","),_?(Xt>1&&X>2&&(Xt>4?(y+=`
`.concat(Se,"...").concat(Te),E=!0):Xt>3&&(y+=`
  `.concat(N[X-2]),Dt++),y+=`
  `.concat(N[X-1]),Dt++),g=X,y+=`
`.concat(Ve,"+").concat(Te," ").concat(Yr),Z+=`
`.concat(rt,"-").concat(Te," ").concat(Dn),Dt+=2):(y+=Z,Z="",(Xt===1||X===0)&&(y+=`
  `.concat(Yr),Dt++))}if(Dt>20&&X<Ir-2)return"".concat(H).concat(cs,`
`).concat(y,`
`).concat(Se,"...").concat(Te).concat(Z,`
`)+"".concat(Se,"...").concat(Te)}return"".concat(H).concat(E?cs:"",`
`).concat(y).concat(Z).concat(p).concat(ge)}var he=function(P,F){c(Z,P);var Y=f(Z);function Z(y){var g;if(n(this,Z),I(y)!=="object"||y===null)throw new ye("options","Object",y);var p=y.message,E=y.operator,M=y.stackStartFn,N=y.actual,$=y.expected,X=Error.stackTraceLimit;if(Error.stackTraceLimit=0,p!=null)g=Y.call(this,String(p));else if(process.stderr&&process.stderr.isTTY&&(process.stderr&&process.stderr.getColorDepth&&process.stderr.getColorDepth()!==1?(Se="\x1B[34m",Ve="\x1B[32m",Te="\x1B[39m",rt="\x1B[31m"):(Se="",Ve="",Te="",rt="")),I(N)==="object"&&N!==null&&I($)==="object"&&$!==null&&"stack"in N&&N instanceof Error&&"stack"in $&&$ instanceof Error&&(N=z(N),$=z($)),E==="deepStrictEqual"||E==="strictEqual")g=Y.call(this,te(N,$,E));else if(E==="notDeepStrictEqual"||E==="notStrictEqual"){var ge=B[E],Oe=L(N).split(`
`);if(E==="notStrictEqual"&&I(N)==="object"&&N!==null&&(ge=B.notStrictEqualObject),Oe.length>30)for(Oe[26]="".concat(Se,"...").concat(Te);Oe.length>27;)Oe.pop();Oe.length===1?g=Y.call(this,"".concat(ge," ").concat(Oe[0])):g=Y.call(this,"".concat(ge,`

`).concat(Oe.join(`
`),`
`))}else{var Ue=L(N),pt="",jt=B[E];E==="notDeepEqual"||E==="notEqual"?(Ue="".concat(B[E],`

`).concat(Ue),Ue.length>1024&&(Ue="".concat(Ue.slice(0,1021),"..."))):(pt="".concat(L($)),Ue.length>512&&(Ue="".concat(Ue.slice(0,509),"...")),pt.length>512&&(pt="".concat(pt.slice(0,509),"...")),E==="deepEqual"||E==="equal"?Ue="".concat(jt,`

`).concat(Ue,`

should equal

`):pt=" ".concat(E," ").concat(pt)),g=Y.call(this,"".concat(Ue).concat(pt))}return Error.stackTraceLimit=X,g.generatedMessage=!p,Object.defineProperty(d(g),"name",{value:"AssertionError [ERR_ASSERTION]",enumerable:!1,writable:!0,configurable:!0}),g.code="ERR_ASSERTION",g.actual=N,g.expected=$,g.operator=E,Error.captureStackTrace&&Error.captureStackTrace(d(g),M),g.stack,g.name="AssertionError",h(g)}return i(Z,[{key:"toString",value:function(){return"".concat(this.name," [").concat(this.code,"]: ").concat(this.message)}},{key:F,value:function(g,p){return k(this,e(e({},p),{},{customInspect:!1,depth:0}))}}]),Z}(v(Error),k.custom);return Lu=he,Lu}var Oh=Object.prototype.toString,Dg=function(e){var t=Oh.call(e),n=t==="[object Arguments]";return n||(n=t!=="[object Array]"&&e!==null&&typeof e=="object"&&typeof e.length=="number"&&e.length>=0&&Oh.call(e.callee)==="[object Function]"),n},$u,Rh;function $B(){if(Rh)return $u;Rh=1;var r;if(!Object.keys){var e=Object.prototype.hasOwnProperty,t=Object.prototype.toString,n=Dg,s=Object.prototype.propertyIsEnumerable,i=!s.call({toString:null},"toString"),a=s.call(function(){},"prototype"),o=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],c=function(v){var b=v.constructor;return b&&b.prototype===v},f={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},h=function(){if(typeof window>"u")return!1;for(var v in window)try{if(!f["$"+v]&&e.call(window,v)&&window[v]!==null&&typeof window[v]=="object")try{c(window[v])}catch{return!0}}catch{return!0}return!1}(),d=function(v){if(typeof window>"u"||!h)return c(v);try{return c(v)}catch{return!1}};r=function(b){var D=b!==null&&typeof b=="object",U=t.call(b)==="[object Function]",ie=n(b),K=D&&t.call(b)==="[object String]",I=[];if(!D&&!U&&!ie)throw new TypeError("Object.keys called on a non-object");var x=a&&U;if(K&&b.length>0&&!e.call(b,0))for(var k=0;k<b.length;++k)I.push(String(k));if(ie&&b.length>0)for(var re=0;re<b.length;++re)I.push(String(re));else for(var ye in b)!(x&&ye==="prototype")&&e.call(b,ye)&&I.push(String(ye));if(i)for(var fe=d(b),Fe=0;Fe<o.length;++Fe)!(fe&&o[Fe]==="constructor")&&e.call(b,o[Fe])&&I.push(o[Fe]);return I}}return $u=r,$u}var HB=Array.prototype.slice,DB=Dg,Fh=Object.keys,Co=Fh?function(e){return Fh(e)}:$B(),Ch=Object.keys;Co.shim=function(){if(Object.keys){var e=function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2);e||(Object.keys=function(n){return DB(n)?Ch(HB.call(n)):Ch(n)})}else Object.keys=Co;return Object.keys||Co};var Mg=Co,MB=Mg,Ug=Ml(),jg=Yi,Po=Ul,UB=jg("Array.prototype.push"),Ph=jg("Object.prototype.propertyIsEnumerable"),jB=Ug?Po.getOwnPropertySymbols:null,ZB=function(e,t){if(e==null)throw new TypeError("target must be an object");var n=Po(e);if(arguments.length===1)return n;for(var s=1;s<arguments.length;++s){var i=Po(arguments[s]),a=MB(i),o=Ug&&(Po.getOwnPropertySymbols||jB);if(o)for(var c=o(i),f=0;f<c.length;++f){var h=c[f];Ph(i,h)&&UB(a,h)}for(var d=0;d<a.length;++d){var v=a[d];if(Ph(i,v)){var b=i[v];n[v]=b}}}return n},Hu=ZB,zB=function(){if(!Object.assign)return!1;for(var r="abcdefghijklmnopqrst",e=r.split(""),t={},n=0;n<e.length;++n)t[e[n]]=e[n];var s=Object.assign({},t),i="";for(var a in s)i+=a;return r!==i},VB=function(){if(!Object.assign||!Object.preventExtensions)return!1;var r=Object.preventExtensions({1:2});try{Object.assign(r,"xy")}catch{return r[1]==="y"}return!1},qB=function(){return!Object.assign||zB()||VB()?Hu:Object.assign},Nh=function(r){return r!==r},Zg=function(e,t){return e===0&&t===0?1/e===1/t:!!(e===t||Nh(e)&&Nh(t))},WB=Zg,lf=function(){return typeof Object.is=="function"?Object.is:WB},zg=ql,Vg=Ic,GB=Vg(zg("String.prototype.indexOf")),KB=function(e,t){var n=zg(e,!!t);return typeof n=="function"&&GB(e,".prototype.")>-1?Vg(n):n},Du,kh;function kc(){if(kh)return Du;kh=1;var r=Mg,e=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",t=Object.prototype.toString,n=Array.prototype.concat,s=Wm,i=function(f){return typeof f=="function"&&t.call(f)==="[object Function]"},a=Km(),o=function(f,h,d,v){if(h in f){if(v===!0){if(f[h]===d)return}else if(!i(v)||!v())return}a?s(f,h,d,!0):s(f,h,d)},c=function(f,h){var d=arguments.length>2?arguments[2]:{},v=r(h);e&&(v=n.call(v,Object.getOwnPropertySymbols(h)));for(var b=0;b<v.length;b+=1)o(f,v[b],h[v[b]],d[v[b]])};return c.supportsDescriptors=!!a,Du=c,Du}var Mu,Lh;function YB(){if(Lh)return Mu;Lh=1;var r=lf,e=kc();return Mu=function(){var n=r();return e(Object,{is:n},{is:function(){return Object.is!==n}}),n},Mu}var Uu,$h;function XB(){if($h)return Uu;$h=1;var r=kc(),e=Ic,t=Zg,n=lf,s=YB(),i=e(n(),Object);return r(i,{getPolyfill:n,implementation:t,shim:s}),Uu=i,Uu}var ju,Hh;function qg(){return Hh||(Hh=1,ju=function(e){return e!==e}),ju}var Zu,Dh;function Wg(){if(Dh)return Zu;Dh=1;var r=qg();return Zu=function(){return Number.isNaN&&Number.isNaN(NaN)&&!Number.isNaN("a")?Number.isNaN:r},Zu}var zu,Mh;function JB(){if(Mh)return zu;Mh=1;var r=kc(),e=Wg();return zu=function(){var n=e();return r(Number,{isNaN:n},{isNaN:function(){return Number.isNaN!==n}}),n},zu}var Vu,Uh;function QB(){if(Uh)return Vu;Uh=1;var r=Ic,e=kc(),t=qg(),n=Wg(),s=JB(),i=r(n(),Number);return e(i,{getPolyfill:n,implementation:t,shim:s}),Vu=i,Vu}var qu,jh;function eT(){if(jh)return qu;jh=1;function r(_,O){return i(_)||s(_,O)||t(_,O)||e()}function e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function t(_,O){if(_){if(typeof _=="string")return n(_,O);var ae=Object.prototype.toString.call(_).slice(8,-1);if(ae==="Object"&&_.constructor&&(ae=_.constructor.name),ae==="Map"||ae==="Set")return Array.from(_);if(ae==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ae))return n(_,O)}}function n(_,O){(O==null||O>_.length)&&(O=_.length);for(var ae=0,pe=new Array(O);ae<O;ae++)pe[ae]=_[ae];return pe}function s(_,O){var ae=_==null?null:typeof Symbol<"u"&&_[Symbol.iterator]||_["@@iterator"];if(ae!=null){var pe,ve,Ne,Ae,je=[],qe=!0,Tt=!1;try{if(Ne=(ae=ae.call(_)).next,O!==0)for(;!(qe=(pe=Ne.call(ae)).done)&&(je.push(pe.value),je.length!==O);qe=!0);}catch(Ot){Tt=!0,ve=Ot}finally{try{if(!qe&&ae.return!=null&&(Ae=ae.return(),Object(Ae)!==Ae))return}finally{if(Tt)throw ve}}return je}}function i(_){if(Array.isArray(_))return _}function a(_){"@babel/helpers - typeof";return a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(O){return typeof O}:function(O){return O&&typeof Symbol=="function"&&O.constructor===Symbol&&O!==Symbol.prototype?"symbol":typeof O},a(_)}var o=/a/g.flags!==void 0,c=function(O){var ae=[];return O.forEach(function(pe){return ae.push(pe)}),ae},f=function(O){var ae=[];return O.forEach(function(pe,ve){return ae.push([ve,pe])}),ae},h=Object.is?Object.is:XB(),d=Object.getOwnPropertySymbols?Object.getOwnPropertySymbols:function(){return[]},v=Number.isNaN?Number.isNaN:QB();function b(_){return _.call.bind(_)}var D=b(Object.prototype.hasOwnProperty),U=b(Object.prototype.propertyIsEnumerable),ie=b(Object.prototype.toString),K=ue.types,I=K.isAnyArrayBuffer,x=K.isArrayBufferView,k=K.isDate,re=K.isMap,ye=K.isRegExp,fe=K.isSet,Fe=K.isNativeError,Se=K.isBoxedPrimitive,Ve=K.isNumberObject,rt=K.isStringObject,Te=K.isBooleanObject,B=K.isBigIntObject,Q=K.isSymbolObject,z=K.isFloat32Array,L=K.isFloat64Array;function te(_){if(_.length===0||_.length>10)return!0;for(var O=0;O<_.length;O++){var ae=_.charCodeAt(O);if(ae<48||ae>57)return!0}return _.length===10&&_>=Math.pow(2,32)}function he(_){return Object.keys(_).filter(te).concat(d(_).filter(Object.prototype.propertyIsEnumerable.bind(_)))}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function P(_,O){if(_===O)return 0;for(var ae=_.length,pe=O.length,ve=0,Ne=Math.min(ae,pe);ve<Ne;++ve)if(_[ve]!==O[ve]){ae=_[ve],pe=O[ve];break}return ae<pe?-1:pe<ae?1:0}var F=!0,Y=!1,Z=0,y=1,g=2,p=3;function E(_,O){return o?_.source===O.source&&_.flags===O.flags:RegExp.prototype.toString.call(_)===RegExp.prototype.toString.call(O)}function M(_,O){if(_.byteLength!==O.byteLength)return!1;for(var ae=0;ae<_.byteLength;ae++)if(_[ae]!==O[ae])return!1;return!0}function N(_,O){return _.byteLength!==O.byteLength?!1:P(new Uint8Array(_.buffer,_.byteOffset,_.byteLength),new Uint8Array(O.buffer,O.byteOffset,O.byteLength))===0}function $(_,O){return _.byteLength===O.byteLength&&P(new Uint8Array(_),new Uint8Array(O))===0}function X(_,O){return Ve(_)?Ve(O)&&h(Number.prototype.valueOf.call(_),Number.prototype.valueOf.call(O)):rt(_)?rt(O)&&String.prototype.valueOf.call(_)===String.prototype.valueOf.call(O):Te(_)?Te(O)&&Boolean.prototype.valueOf.call(_)===Boolean.prototype.valueOf.call(O):B(_)?B(O)&&BigInt.prototype.valueOf.call(_)===BigInt.prototype.valueOf.call(O):Q(O)&&Symbol.prototype.valueOf.call(_)===Symbol.prototype.valueOf.call(O)}function ge(_,O,ae,pe){if(_===O)return _!==0?!0:ae?h(_,O):!0;if(ae){if(a(_)!=="object")return typeof _=="number"&&v(_)&&v(O);if(a(O)!=="object"||_===null||O===null||Object.getPrototypeOf(_)!==Object.getPrototypeOf(O))return!1}else{if(_===null||a(_)!=="object")return O===null||a(O)!=="object"?_==O:!1;if(O===null||a(O)!=="object")return!1}var ve=ie(_),Ne=ie(O);if(ve!==Ne)return!1;if(Array.isArray(_)){if(_.length!==O.length)return!1;var Ae=he(_),je=he(O);return Ae.length!==je.length?!1:Ue(_,O,ae,pe,y,Ae)}if(ve==="[object Object]"&&(!re(_)&&re(O)||!fe(_)&&fe(O)))return!1;if(k(_)){if(!k(O)||Date.prototype.getTime.call(_)!==Date.prototype.getTime.call(O))return!1}else if(ye(_)){if(!ye(O)||!E(_,O))return!1}else if(Fe(_)||_ instanceof Error){if(_.message!==O.message||_.name!==O.name)return!1}else if(x(_)){if(!ae&&(z(_)||L(_))){if(!M(_,O))return!1}else if(!N(_,O))return!1;var qe=he(_),Tt=he(O);return qe.length!==Tt.length?!1:Ue(_,O,ae,pe,Z,qe)}else{if(fe(_))return!fe(O)||_.size!==O.size?!1:Ue(_,O,ae,pe,g);if(re(_))return!re(O)||_.size!==O.size?!1:Ue(_,O,ae,pe,p);if(I(_)){if(!$(_,O))return!1}else if(Se(_)&&!X(_,O))return!1}return Ue(_,O,ae,pe,Z)}function Oe(_,O){return O.filter(function(ae){return U(_,ae)})}function Ue(_,O,ae,pe,ve,Ne){if(arguments.length===5){Ne=Object.keys(_);var Ae=Object.keys(O);if(Ne.length!==Ae.length)return!1}for(var je=0;je<Ne.length;je++)if(!D(O,Ne[je]))return!1;if(ae&&arguments.length===5){var qe=d(_);if(qe.length!==0){var Tt=0;for(je=0;je<qe.length;je++){var Ot=qe[je];if(U(_,Ot)){if(!U(O,Ot))return!1;Ne.push(Ot),Tt++}else if(U(O,Ot))return!1}var ln=d(O);if(qe.length!==ln.length&&Oe(O,ln).length!==Tt)return!1}else{var Mn=d(O);if(Mn.length!==0&&Oe(O,Mn).length!==0)return!1}}if(Ne.length===0&&(ve===Z||ve===y&&_.length===0||_.size===0))return!0;if(pe===void 0)pe={val1:new Map,val2:new Map,position:0};else{var us=pe.val1.get(_);if(us!==void 0){var Xr=pe.val2.get(O);if(Xr!==void 0)return us===Xr}pe.position++}pe.val1.set(_,pe.position),pe.val2.set(O,pe.position);var wr=Xt(_,O,ae,Ne,pe,ve);return pe.val1.delete(_),pe.val2.delete(O),wr}function pt(_,O,ae,pe){for(var ve=c(_),Ne=0;Ne<ve.length;Ne++){var Ae=ve[Ne];if(ge(O,Ae,ae,pe))return _.delete(Ae),!0}return!1}function jt(_){switch(a(_)){case"undefined":return null;case"object":return;case"symbol":return!1;case"string":_=+_;case"number":if(v(_))return!1}return!0}function Ir(_,O,ae){var pe=jt(ae);return pe??(O.has(pe)&&!_.has(pe))}function Kr(_,O,ae,pe,ve){var Ne=jt(ae);if(Ne!=null)return Ne;var Ae=O.get(Ne);return Ae===void 0&&!O.has(Ne)||!ge(pe,Ae,!1,ve)?!1:!_.has(Ne)&&ge(pe,Ae,!1,ve)}function Dt(_,O,ae,pe){for(var ve=null,Ne=c(_),Ae=0;Ae<Ne.length;Ae++){var je=Ne[Ae];if(a(je)==="object"&&je!==null)ve===null&&(ve=new Set),ve.add(je);else if(!O.has(je)){if(ae||!Ir(_,O,je))return!1;ve===null&&(ve=new Set),ve.add(je)}}if(ve!==null){for(var qe=c(O),Tt=0;Tt<qe.length;Tt++){var Ot=qe[Tt];if(a(Ot)==="object"&&Ot!==null){if(!pt(ve,Ot,ae,pe))return!1}else if(!ae&&!_.has(Ot)&&!pt(ve,Ot,ae,pe))return!1}return ve.size===0}return!0}function H(_,O,ae,pe,ve,Ne){for(var Ae=c(_),je=0;je<Ae.length;je++){var qe=Ae[je];if(ge(ae,qe,ve,Ne)&&ge(pe,O.get(qe),ve,Ne))return _.delete(qe),!0}return!1}function cs(_,O,ae,pe){for(var ve=null,Ne=f(_),Ae=0;Ae<Ne.length;Ae++){var je=r(Ne[Ae],2),qe=je[0],Tt=je[1];if(a(qe)==="object"&&qe!==null)ve===null&&(ve=new Set),ve.add(qe);else{var Ot=O.get(qe);if(Ot===void 0&&!O.has(qe)||!ge(Tt,Ot,ae,pe)){if(ae||!Kr(_,O,qe,Tt,pe))return!1;ve===null&&(ve=new Set),ve.add(qe)}}}if(ve!==null){for(var ln=f(O),Mn=0;Mn<ln.length;Mn++){var us=r(ln[Mn],2),Xr=us[0],wr=us[1];if(a(Xr)==="object"&&Xr!==null){if(!H(ve,_,Xr,wr,ae,pe))return!1}else if(!ae&&(!_.has(Xr)||!ge(_.get(Xr),wr,!1,pe))&&!H(ve,_,Xr,wr,!1,pe))return!1}return ve.size===0}return!0}function Xt(_,O,ae,pe,ve,Ne){var Ae=0;if(Ne===g){if(!Dt(_,O,ae,ve))return!1}else if(Ne===p){if(!cs(_,O,ae,ve))return!1}else if(Ne===y)for(;Ae<_.length;Ae++)if(D(_,Ae)){if(!D(O,Ae)||!ge(_[Ae],O[Ae],ae,ve))return!1}else{if(D(O,Ae))return!1;for(var je=Object.keys(_);Ae<je.length;Ae++){var qe=je[Ae];if(!D(O,qe)||!ge(_[qe],O[qe],ae,ve))return!1}return je.length===Object.keys(O).length}for(Ae=0;Ae<pe.length;Ae++){var Tt=pe[Ae];if(!ge(_[Tt],O[Tt],ae,ve))return!1}return!0}function Dn(_,O){return ge(_,O,Y)}function Yr(_,O){return ge(_,O,F)}return qu={isDeepEqual:Dn,isDeepStrictEqual:Yr},qu}var Zh;function Ol(){if(Zh)return Nu.exports;Zh=1;function r(g){"@babel/helpers - typeof";return r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p},r(g)}function e(g,p,E){return Object.defineProperty(g,"prototype",{writable:!1}),g}function t(g,p){if(!(g instanceof p))throw new TypeError("Cannot call a class as a function")}var n=Hg(),s=n.codes,i=s.ERR_AMBIGUOUS_ARGUMENT,a=s.ERR_INVALID_ARG_TYPE,o=s.ERR_INVALID_ARG_VALUE,c=s.ERR_INVALID_RETURN_VALUE,f=s.ERR_MISSING_ARGS,h=LB(),d=ue,v=d.inspect,b=ue.types,D=b.isPromise,U=b.isRegExp,ie=qB(),K=lf(),I=KB("RegExp.prototype.test"),x,k;function re(){var g=eT();x=g.isDeepEqual,k=g.isDeepStrictEqual}var ye=!1,fe=Nu.exports=Te,Fe={};function Se(g){throw g.message instanceof Error?g.message:new h(g)}function Ve(g,p,E,M,N){var $=arguments.length,X;if($===0)X="Failed";else if($===1)E=g,g=void 0;else{if(ye===!1){ye=!0;var ge=process.emitWarning?process.emitWarning:console.warn.bind(console);ge("assert.fail() with more than one argument is deprecated. Please use assert.strictEqual() instead or only pass a message.","DeprecationWarning","DEP0094")}$===2&&(M="!=")}if(E instanceof Error)throw E;var Oe={actual:g,expected:p,operator:M===void 0?"fail":M,stackStartFn:N||Ve};E!==void 0&&(Oe.message=E);var Ue=new h(Oe);throw X&&(Ue.message=X,Ue.generatedMessage=!0),Ue}fe.fail=Ve,fe.AssertionError=h;function rt(g,p,E,M){if(!E){var N=!1;if(p===0)N=!0,M="No value argument passed to `assert.ok()`";else if(M instanceof Error)throw M;var $=new h({actual:E,expected:!0,message:M,operator:"==",stackStartFn:g});throw $.generatedMessage=N,$}}function Te(){for(var g=arguments.length,p=new Array(g),E=0;E<g;E++)p[E]=arguments[E];rt.apply(void 0,[Te,p.length].concat(p))}fe.ok=Te,fe.equal=function g(p,E,M){if(arguments.length<2)throw new f("actual","expected");p!=E&&Se({actual:p,expected:E,message:M,operator:"==",stackStartFn:g})},fe.notEqual=function g(p,E,M){if(arguments.length<2)throw new f("actual","expected");p==E&&Se({actual:p,expected:E,message:M,operator:"!=",stackStartFn:g})},fe.deepEqual=function g(p,E,M){if(arguments.length<2)throw new f("actual","expected");x===void 0&&re(),x(p,E)||Se({actual:p,expected:E,message:M,operator:"deepEqual",stackStartFn:g})},fe.notDeepEqual=function g(p,E,M){if(arguments.length<2)throw new f("actual","expected");x===void 0&&re(),x(p,E)&&Se({actual:p,expected:E,message:M,operator:"notDeepEqual",stackStartFn:g})},fe.deepStrictEqual=function g(p,E,M){if(arguments.length<2)throw new f("actual","expected");x===void 0&&re(),k(p,E)||Se({actual:p,expected:E,message:M,operator:"deepStrictEqual",stackStartFn:g})},fe.notDeepStrictEqual=B;function B(g,p,E){if(arguments.length<2)throw new f("actual","expected");x===void 0&&re(),k(g,p)&&Se({actual:g,expected:p,message:E,operator:"notDeepStrictEqual",stackStartFn:B})}fe.strictEqual=function g(p,E,M){if(arguments.length<2)throw new f("actual","expected");K(p,E)||Se({actual:p,expected:E,message:M,operator:"strictEqual",stackStartFn:g})},fe.notStrictEqual=function g(p,E,M){if(arguments.length<2)throw new f("actual","expected");K(p,E)&&Se({actual:p,expected:E,message:M,operator:"notStrictEqual",stackStartFn:g})};var Q=e(function g(p,E,M){var N=this;t(this,g),E.forEach(function($){$ in p&&(M!==void 0&&typeof M[$]=="string"&&U(p[$])&&I(p[$],M[$])?N[$]=M[$]:N[$]=p[$])})});function z(g,p,E,M,N,$){if(!(E in g)||!k(g[E],p[E])){if(!M){var X=new Q(g,N),ge=new Q(p,N,g),Oe=new h({actual:X,expected:ge,operator:"deepStrictEqual",stackStartFn:$});throw Oe.actual=g,Oe.expected=p,Oe.operator=$.name,Oe}Se({actual:g,expected:p,message:M,operator:$.name,stackStartFn:$})}}function L(g,p,E,M){if(typeof p!="function"){if(U(p))return I(p,g);if(arguments.length===2)throw new a("expected",["Function","RegExp"],p);if(r(g)!=="object"||g===null){var N=new h({actual:g,expected:p,message:E,operator:"deepStrictEqual",stackStartFn:M});throw N.operator=M.name,N}var $=Object.keys(p);if(p instanceof Error)$.push("name","message");else if($.length===0)throw new o("error",p,"may not be an empty object");return x===void 0&&re(),$.forEach(function(X){typeof g[X]=="string"&&U(p[X])&&I(p[X],g[X])||z(g,p,X,E,$,M)}),!0}return p.prototype!==void 0&&g instanceof p?!0:Error.isPrototypeOf(p)?!1:p.call({},g)===!0}function te(g){if(typeof g!="function")throw new a("fn","Function",g);try{g()}catch(p){return p}return Fe}function he(g){return D(g)||g!==null&&r(g)==="object"&&typeof g.then=="function"&&typeof g.catch=="function"}function P(g){return Promise.resolve().then(function(){var p;if(typeof g=="function"){if(p=g(),!he(p))throw new c("instance of Promise","promiseFn",p)}else if(he(g))p=g;else throw new a("promiseFn",["Function","Promise"],g);return Promise.resolve().then(function(){return p}).then(function(){return Fe}).catch(function(E){return E})})}function F(g,p,E,M){if(typeof E=="string"){if(arguments.length===4)throw new a("error",["Object","Error","Function","RegExp"],E);if(r(p)==="object"&&p!==null){if(p.message===E)throw new i("error/message",'The error message "'.concat(p.message,'" is identical to the message.'))}else if(p===E)throw new i("error/message",'The error "'.concat(p,'" is identical to the message.'));M=E,E=void 0}else if(E!=null&&r(E)!=="object"&&typeof E!="function")throw new a("error",["Object","Error","Function","RegExp"],E);if(p===Fe){var N="";E&&E.name&&(N+=" (".concat(E.name,")")),N+=M?": ".concat(M):".";var $=g.name==="rejects"?"rejection":"exception";Se({actual:void 0,expected:E,operator:g.name,message:"Missing expected ".concat($).concat(N),stackStartFn:g})}if(E&&!L(p,E,M,g))throw p}function Y(g,p,E,M){if(p!==Fe){if(typeof E=="string"&&(M=E,E=void 0),!E||L(p,E)){var N=M?": ".concat(M):".",$=g.name==="doesNotReject"?"rejection":"exception";Se({actual:p,expected:E,operator:g.name,message:"Got unwanted ".concat($).concat(N,`
`)+'Actual message: "'.concat(p&&p.message,'"'),stackStartFn:g})}throw p}}fe.throws=function g(p){for(var E=arguments.length,M=new Array(E>1?E-1:0),N=1;N<E;N++)M[N-1]=arguments[N];F.apply(void 0,[g,te(p)].concat(M))},fe.rejects=function g(p){for(var E=arguments.length,M=new Array(E>1?E-1:0),N=1;N<E;N++)M[N-1]=arguments[N];return P(p).then(function($){return F.apply(void 0,[g,$].concat(M))})},fe.doesNotThrow=function g(p){for(var E=arguments.length,M=new Array(E>1?E-1:0),N=1;N<E;N++)M[N-1]=arguments[N];Y.apply(void 0,[g,te(p)].concat(M))},fe.doesNotReject=function g(p){for(var E=arguments.length,M=new Array(E>1?E-1:0),N=1;N<E;N++)M[N-1]=arguments[N];return P(p).then(function($){return Y.apply(void 0,[g,$].concat(M))})},fe.ifError=function g(p){if(p!=null){var E="ifError got unwanted exception: ";r(p)==="object"&&typeof p.message=="string"?p.message.length===0&&p.constructor?E+=p.constructor.name:E+=p.message:E+=v(p);var M=new h({actual:p,expected:null,operator:"ifError",message:E,stackStartFn:g}),N=p.stack;if(typeof N=="string"){var $=N.split(`
`);$.shift();for(var X=M.stack.split(`
`),ge=0;ge<$.length;ge++){var Oe=X.indexOf($[ge]);if(Oe!==-1){X=X.slice(0,Oe);break}}M.stack="".concat(X.join(`
`),`
`).concat($.join(`
`))}throw M}};function Z(g,p,E,M,N){if(!U(p))throw new a("regexp","RegExp",p);var $=N==="match";if(typeof g!="string"||I(p,g)!==$){if(E instanceof Error)throw E;var X=!E;E=E||(typeof g!="string"?'The "string" argument must be of type string. Received type '+"".concat(r(g)," (").concat(v(g),")"):($?"The input did not match the regular expression ":"The input was expected to not match the regular expression ")+"".concat(v(p),`. Input:

`).concat(v(g),`
`));var ge=new h({actual:g,expected:p,message:E,operator:N,stackStartFn:M});throw ge.generatedMessage=X,ge}}fe.match=function g(p,E,M){Z(p,E,M,g,"match")},fe.doesNotMatch=function g(p,E,M){Z(p,E,M,g,"doesNotMatch")};function y(){for(var g=arguments.length,p=new Array(g),E=0;E<g;E++)p[E]=arguments[E];rt.apply(void 0,[y,p.length].concat(p))}return fe.strict=ie(y,fe,{equal:fe.strictEqual,deepEqual:fe.deepStrictEqual,notEqual:fe.notStrictEqual,notDeepEqual:fe.notDeepStrictEqual}),fe.strict.strict=fe.strict,Nu.exports}var tT=Ol();let Wu;const rT=2;async function VI(r){const e=await Yg(),t=await Kg(r);return e.computeTree(t)}async function Gg(r){const e=await Yg(),t=await Kg(r);return l.fromBuffer(await e.computeTreeRoot(t))}function Kg(r){const e=[...r].sort((t,n)=>t.selector.value-n.selector.value);return Promise.all(e.map(nT))}async function nT(r){return(await wt([r.selector,r.vkHash],nt.FUNCTION_LEAF)).toBuffer()}async function Yg(){if(!Wu){const r=(await ng(new Array(rT).fill(0))).toBuffer();Wu=await Cc.create(M1,r,async(e,t)=>(await Xi([e,t])).toBuffer())}return Wu}async function sT(r){const e=r.artifactHash,t="privateFunctionsRoot"in r?r.privateFunctionsRoot:await Gg(r.privateFunctions),n="publicBytecodeCommitment"in r?r.publicBytecodeCommitment:await Xg(r.packedBytecode);return{id:await wt([e,t,n],nt.CONTRACT_LEAF),artifactHash:e,privateFunctionsRoot:t,publicBytecodeCommitment:n}}async function qI(r){const e=await Gg(r.privateFunctions),t=await Xg(r.packedBytecode);return{artifactHash:r.artifactHash,privateFunctionsRoot:e,publicBytecodeCommitment:t}}async function Xg(r){const e=yg(r,Tl),t=Math.ceil(e[0].toNumber()/(l.SIZE_IN_BYTES-1));return tT.strict(t<Tl,"Bytecode exceeds maximum deployable size"),t==0?new l(0):await nS(e.slice(0,t+1))}const iT=(r,e)=>r.selector.toField().cmp(e.selector.toField());async function Lc(r){var o;const e="artifactHash"in r?r.artifactHash:await Lg(r),t=r.functions.filter(c=>c.functionType===tr.PUBLIC);if(t.length>1)throw new Error(`Contract should contain at most one public function artifact. Received ${t.length}.`);const n=((o=t[0])==null?void 0:o.bytecode)??Buffer.alloc(0),s=r.functions.filter(c=>c.functionType===tr.PRIVATE),i=await Promise.all(s.map(aT));i.sort(iT);const a={version:1,artifactHash:e,packedBytecode:n,privateFunctions:i};return{...a,...await sT(a)}}async function aT(r){return{selector:await ze.fromNameAndParameters(r.name,r.parameters),vkHash:await oT(r)}}async function oT(r){if(!r.verificationKey)throw new Error(`Private function ${r.name} must have a verification key`);return pA(await $1(Buffer.from(r.verificationKey,"base64")))}const wo=1;class No{constructor(e){u(this,"version",wo);u(this,"salt");u(this,"deployer");u(this,"currentContractClassId");u(this,"originalContractClassId");u(this,"initializationHash");u(this,"publicKeys");if(e.version!==wo)throw new Error(`Unexpected contract class version ${e.version}`);this.salt=e.salt,this.deployer=e.deployer,this.currentContractClassId=e.currentContractClassId,this.originalContractClassId=e.originalContractClassId,this.initializationHash=e.initializationHash,this.publicKeys=e.publicKeys}toBuffer(){return le(rf(this.version),this.salt,this.deployer,this.currentContractClassId,this.originalContractClassId,this.initializationHash,this.publicKeys)}withAddress(e){return{...this,address:e}}static fromBuffer(e){const t=J.asReader(e);return new No({version:t.readUInt8(),salt:t.readObject(l),deployer:t.readObject(W),currentContractClassId:t.readObject(l),originalContractClassId:t.readObject(l),initializationHash:t.readObject(l),publicKeys:t.readObject(Gt)})}static async random(e={}){return new No({version:wo,salt:l.random(),deployer:await W.random(),currentContractClassId:l.random(),originalContractClassId:l.random(),initializationHash:l.random(),publicKeys:await Gt.random(),...e})}static default(){return new No({version:wo,salt:l.zero(),deployer:W.zero(),currentContractClassId:l.zero(),originalContractClassId:l.zero(),initializationHash:l.zero(),publicKeys:Gt.default()})}}async function cT(r,e){const t=e.constructorArgs??[],n=e.salt??l.random(),s=uT(r,e.constructorArtifact),i=e.deployer??W.ZERO,a=await Lc(r),o=s&&(e!=null&&e.skipArgsDecoding)?await $g(await ze.fromNameAndParameters(s==null?void 0:s.name,s==null?void 0:s.parameters),t):await kB(s,t),c=e.publicKeys??Gt.default(),f={currentContractClassId:a.id,originalContractClassId:a.id,initializationHash:o,publicKeys:c,salt:n,deployer:i,version:1};return{...f,address:await PB(f)}}function uT(r,e){if(typeof e=="string"){const t=Pc(r).find(n=>n.name===e);if(!t)throw new Error(`No constructor found with name ${e}`);return t}return e??mg(r)}const lT=1,Jg=R({selector:ze.schema,vkHash:q.Fr}),fT=Jg.and(R({bytecode:q.Buffer})),dT=R({selector:ze.schema,bytecode:q.Buffer}),hT=R({artifactMetadataHash:q.Fr,functionMetadataHash:q.Fr,utilityFunctionsTreeRoot:q.Fr,privateFunctionTreeSiblingPath:ee(q.Fr),privateFunctionTreeLeafIndex:q.Integer,artifactTreeSiblingPath:ee(q.Fr),artifactTreeLeafIndex:q.Integer}),mT=R({artifactMetadataHash:q.Fr,functionMetadataHash:q.Fr,privateFunctionsArtifactTreeRoot:q.Fr,artifactTreeSiblingPath:ee(q.Fr),artifactTreeLeafIndex:q.Integer}),Qg=R({version:st(lT),artifactHash:q.Fr,privateFunctions:ee(Jg),packedBytecode:q.Buffer}),pT=Qg.extend({id:q.Fr}),gT=R({id:q.Fr,privateFunctionsRoot:q.Fr,privateFunctions:ee(fT.and(hT)),utilityFunctions:ee(dT.and(mT))}).and(Qg.omit({privateFunctions:!0})),yT=1,bT=R({version:st(yT),salt:C.Fr,deployer:C.AztecAddress,currentContractClassId:C.Fr,originalContractClassId:C.Fr,initializationHash:C.Fr,publicKeys:Gt.schema}),ff=bT.and(R({address:C.AztecAddress})),wT=R({prevContractClassId:C.Fr,newContractClassId:C.Fr,blockOfChange:se().int().nonnegative()});wT.and(R({address:C.AztecAddress}));const ey=R({rollupAddress:q.EthAddress,registryAddress:q.EthAddress,inboxAddress:q.EthAddress,outboxAddress:q.EthAddress,feeJuiceAddress:q.EthAddress,stakingAssetAddress:q.EthAddress,feeJuicePortalAddress:q.EthAddress,coinIssuerAddress:q.EthAddress,rewardDistributorAddress:q.EthAddress,governanceProposerAddress:q.EthAddress,governanceAddress:q.EthAddress,slashFactoryAddress:q.EthAddress.optional(),feeAssetHandlerAddress:q.EthAddress.optional(),stakingAssetHandlerAddress:q.EthAddress.optional()}),sr=r=>gr.fromString(r),WI={rollupAddress:{env:"ROLLUP_CONTRACT_ADDRESS",description:"The deployed L1 rollup contract address.",parseEnv:sr},registryAddress:{env:"REGISTRY_CONTRACT_ADDRESS",description:"The deployed L1 registry contract address.",parseEnv:sr},inboxAddress:{env:"INBOX_CONTRACT_ADDRESS",description:"The deployed L1 inbox contract address.",parseEnv:sr},outboxAddress:{env:"OUTBOX_CONTRACT_ADDRESS",description:"The deployed L1 outbox contract address.",parseEnv:sr},feeJuiceAddress:{env:"FEE_JUICE_CONTRACT_ADDRESS",description:"The deployed L1 Fee Juice contract address.",parseEnv:sr},stakingAssetAddress:{env:"STAKING_ASSET_CONTRACT_ADDRESS",description:"The deployed L1 staking asset contract address.",parseEnv:sr},feeJuicePortalAddress:{env:"FEE_JUICE_PORTAL_CONTRACT_ADDRESS",description:"The deployed L1 Fee Juice portal contract address.",parseEnv:sr},coinIssuerAddress:{env:"COIN_ISSUER_CONTRACT_ADDRESS",description:"The deployed L1 coinIssuer contract address",parseEnv:sr},rewardDistributorAddress:{env:"REWARD_DISTRIBUTOR_CONTRACT_ADDRESS",description:"The deployed L1 rewardDistributor contract address",parseEnv:sr},governanceProposerAddress:{env:"GOVERNANCE_PROPOSER_CONTRACT_ADDRESS",description:"The deployed L1 governanceProposer contract address",parseEnv:sr},governanceAddress:{env:"GOVERNANCE_CONTRACT_ADDRESS",description:"The deployed L1 governance contract address",parseEnv:sr},slashFactoryAddress:{env:"SLASH_FACTORY_CONTRACT_ADDRESS",description:"The deployed L1 slashFactory contract address",parseEnv:sr},feeAssetHandlerAddress:{env:"FEE_ASSET_HANDLER_CONTRACT_ADDRESS",description:"The deployed L1 feeAssetHandler contract address",parseEnv:sr},stakingAssetHandlerAddress:{env:"STAKING_ASSET_HANDLER_CONTRACT_ADDRESS",description:"The deployed L1 stakingAssetHandler contract address",parseEnv:sr}},df=R({classRegisterer:C.AztecAddress,feeJuice:C.AztecAddress,instanceDeployer:C.AztecAddress,multiCallEntrypoint:C.AztecAddress}),ty=R({nodeVersion:we(),l1ChainId:se().int().nonnegative(),rollupVersion:se().int().nonnegative(),enr:we().optional(),l1ContractAddresses:ey,protocolContractAddresses:df}).transform(r=>({enr:void 0,...r})),Gn=class Gn{constructor(e,t,n){u(this,"address");u(this,"publicKeys");u(this,"partialAddress");this.address=e,this.publicKeys=t,this.partialAddress=n}static async create(e,t,n){const s=new Gn(e,t,n);return await s.validate(),s}static get schema(){return Gr(Gn)}toJSON(){return this.toString()}static async random(){return await this.fromSecretKeyAndPartialAddress(l.random(),l.random())}static async fromSecretKeyAndPartialAddress(e,t){const{publicKeys:n}=await AA(e),s=await xl(n,t);return new Gn(s,n,t)}async getPreaddress(){return of(await this.publicKeys.hash(),this.partialAddress)}static async fromSecretKeyAndInstance(e,t){const n=await Nc(t);return Gn.fromSecretKeyAndPartialAddress(e,n)}async validate(){const e=await xl(this.publicKeys,this.partialAddress);if(!e.equals(this.address))throw new Error(`Address cannot be derived from public keys and partial address (received ${this.address.toString()}, derived ${e.toString()})`)}toReadableString(){return`Address: ${this.address.toString()}
Master Nullifier Public Key: ${this.publicKeys.masterNullifierPublicKey.toString()}
Master Incoming Viewing Public Key: ${this.publicKeys.masterIncomingViewingPublicKey.toString()}
Master Outgoing Viewing Public Key: ${this.publicKeys.masterOutgoingViewingPublicKey.toString()}
Master Tagging Public Key: ${this.publicKeys.masterTaggingPublicKey.toString()}
Partial Address: ${this.partialAddress.toString()}
`}equals(e){return this.address.equals(e.address)&&this.publicKeys.equals(e.publicKeys)&&this.partialAddress.equals(e.partialAddress)}toBuffer(){return le([this.address,this.publicKeys,this.partialAddress])}static fromBuffer(e){const t=J.asReader(e),n=t.readObject(W),s=t.readObject(Gt),i=t.readObject(l);return Gn.create(n,s,i)}static fromString(e){return Gn.fromBuffer(Buffer.from(e.replace(/^0x/i,""),"hex"))}toString(){return tt(this.toBuffer())}};u(Gn,"SIZE_IN_BYTES",32*10);let yc=Gn;const ry=R({logs:ee(Zs.schema),maxLogsHit:et()}),ny=R({logs:ee(js.schema),maxLogsHit:et()}),zh=R({eventSelector:C.EventSelector,abiType:os,fieldNames:ee(we())});var GI=function(r){return r.Encrypted="Encrypted",r.Unencrypted="Unencrypted",r}({});const vT=R({contractInstance:Yt([ff,Na()]),isContractInitialized:et(),isContractPubliclyDeployed:et()}),ET=R({contractClass:Yt([pT,Na()]),isContractClassPubliclyRegistered:et(),artifact:Yt([Ks,Na()])}),ST=R({pxeVersion:we(),protocolContractAddresses:df}),KI={isL1ToL2MessageSynced:ne().args(C.Fr).returns(et()),registerAccount:ne().args(C.Fr,C.Fr).returns(yc.schema),getRegisteredAccounts:ne().returns(ee(yc.schema)),registerSender:ne().args(C.AztecAddress).returns(C.AztecAddress),getSenders:ne().returns(ee(C.AztecAddress)),removeSender:ne().args(C.AztecAddress).returns(Hr()),registerContractClass:ne().args(Ks).returns(Hr()),registerContract:ne().args(R({instance:ff,artifact:WE(Ks)})).returns(Hr()),updateContract:ne().args(C.AztecAddress,Ks).returns(Hr()),getContracts:ne().returns(ee(C.AztecAddress)),proveTx:ne().args(gn.schema,at(rs.schema)).returns(Sa.schema),profileTx:ne().args(gn.schema,Yt([st("gates"),st("full"),st("execution-steps")]),at(et()),at(C.AztecAddress)).returns(hc.schema),simulateTx:ne().args(gn.schema,et(),at(C.AztecAddress),at(et()),at(et()),at(ee(C.AztecAddress))).returns(Si.schema),sendTx:ne().args(_r.schema).returns(Ge.schema),getTxReceipt:ne().args(Ge.schema).returns(ki.schema),getTxEffect:ne().args(Ge.schema).returns(Fg().optional()),getPublicStorageAt:ne().args(C.AztecAddress,C.Fr).returns(C.Fr),getNotes:ne().args(hB).returns(ee(Ba.schema)),getL1ToL2MembershipWitness:ne().args(C.AztecAddress,C.Fr,C.Fr).returns(ka([C.BigInt,Et.schemaFor(af)])),getL2ToL1MembershipWitness:ne().args(se(),C.Fr).returns(ka([C.BigInt,Et.schema])),getBlock:ne().args(se()).returns(Yt([bn.schema,Na()])),getCurrentBaseFees:ne().returns(Ye.schema),simulateUtility:ne().args(we(),ee(qE()),C.AztecAddress,at(ee(Qn.schema)),at(C.AztecAddress),at(ee(C.AztecAddress))).returns(mc.schema),getPublicLogs:ne().args(pc).returns(ny),getContractClassLogs:ne().args(pc).returns(ry),getBlockNumber:ne().returns(se()),getProvenBlockNumber:ne().returns(se()),getNodeInfo:ne().returns(ty),getPXEInfo:ne().returns(ST),getContractMetadata:ne().args(C.AztecAddress).returns(vT),getContractClassMetadata:ne().args(C.Fr,at(et())).returns(ET),getPrivateEvents:ne().args(C.AztecAddress,zh,se(),se(),ee(C.AztecAddress)).returns(ee($a)),getPublicEvents:ne().args(zh,se(),se()).returns(ee($a))};class AT{constructor(){u(this,"start");this.start=performance?performance.now():Date.now()}us(){return this.ms()*1e3}ms(){return(performance?performance.now():Date.now())-this.start}s(){return this.ms()/1e3}}class sy extends Error{}function*_T(){const r=[1,1,1,2,4,8,16,32,64];let e=0;for(;;)yield r[Math.min(e++,r.length-1)]}function*BT(r){for(const e of r)yield e}async function TT(r,e="Operation",t=_T(),n=Fs("foundation:retry"),s=!1){for(;;)try{return await r()}catch(i){if(i instanceof sy)throw i;const a=t.next().value;if(a===void 0)throw i;n==null||n.debug(`${e} failed. Will retry in ${a}s...`),!s&&(n==null||n.error(`Error while retrying ${e}`,i)),await Cg(a*1e3);continue}}async function iy(r,e="",t=0,n=1){const s=new AT;for(;;){const i=await r();if(i)return i;if(await Cg(n*1e3),t&&s.s()>t)throw new oB(e?`Timeout awaiting ${e}`:"Timeout")}}const xT=Fs("json-rpc:json_rpc_client");async function ay(r,e,t={},n=!1){xT.debug(ue.format("JsonRpcClient.fetch",r,"->",e));let s;try{s=await fetch(r,{method:"POST",body:cf(e),headers:{"content-type":"application/json",...t}})}catch(a){const o=`Error fetching from host ${r}: ${ue.inspect(a)}`;throw new Error(o)}let i;try{i=await s.json()}catch{throw s.ok?new Error(`Failed to parse body as JSON: ${await s.text()}`):new Error(s.statusText)}if(!s.ok){const a=`Error ${s.status} from server ${r}: ${i.error.message}`;throw n||s.status>=400&&s.status<500?new sy(a):new Error(a)}return{response:i,headers:s.headers}}function IT(r,e,t){return async(n,s,i={},a)=>await TT(()=>ay(n,s,i,a??e),`JsonRpcClient request to ${n}`,BT(r),t,!1)}const OT=0,RT=Symbol("JsonRpcClient.sendBatch"),Vh=Symbol("JsonRpcClient.clientId");let FT=1;const CT=new Map;function PT(r,e,t={}){const n=t.fetch??ay,s=t.log??Fs("json-rpc:client"),{namespaceMethods:i=!1,batchWindowMS:a=OT}=t;let o=0,c,f=[];const h=async()=>{c!==void 0&&(clearTimeout(c),c=void 0);const D=f;if(f=[],D.length!==0){s.debug(`Executing JSON-RPC batch of size: ${D.length}`,{methods:D.map(({request:U})=>U.method)});try{const{response:U,headers:ie}=await n(r,D.map(({request:K})=>K));if(t.onResponse&&await t.onResponse({response:U,headers:ie}),!Array.isArray(U)||U.length!==D.length){s.warn(`Invalid response received from JSON-RPC server. Expected array of responses of length ${D.length}`,{response:U});for(let K=0;K<D.length;K++){const{request:I,deferred:x}=D[K];x.resolve({id:I.id,jsonrpc:"2.0",error:{code:-32e3,data:U,message:U.message??"Failed request"}})}}else for(let K=0;K<U.length;K++){const I=U[K],{request:x,deferred:k}=D[K];I.id!==x.id?(s.warn(`Invalid response received at index ${K} from JSON-RPC server: id mismatch`,{requestMethod:x.method,requestId:x.id,responseId:I.id}),k.resolve({id:x.id,jsonrpc:"2.0",error:{code:-32001,data:I,message:"RPC id mismatch"}})):k.resolve(I)}}catch(U){s.warn("Failed to fetch from the remote server",U);for(let ie=0;ie<D.length;ie++){const{request:K,deferred:I}=D[ie];I.resolve({id:K.id,jsonrpc:"2.0",error:{code:-32e3,data:U,message:U.message??"Failed request"}})}}}},d=async(D,U)=>{if(!D1(e,D))throw new Error(`Unspecified method ${D} in client schema`);const ie=i?`${i}_${D}`:D,K={jsonrpc:"2.0",id:o++,method:ie,params:U},I=cB();f.push({request:K,deferred:I}),c===void 0&&(c=setTimeout(h,a)),s.debug(ue.format("request",ie,U));const x=await I.promise;if(s.debug(ue.format("result",ie,x)),"error"in x)throw new Error(x.error.message,{cause:x.error});if(![null,void 0,"null","undefined"].includes(x.result))return e[D].returnType().parseAsync(x.result)},v=FT++,b={[Vh]:v,[RT]:h};for(const D of Object.keys(e))b[D]=(...U)=>Object.assign(d(D,U),{[Vh]:v});return CT.set(v,new WeakRef(b)),b}const NT=Ka(["block-mined","block-proposed","block-missed","attestation-sent","attestation-missed"]),oy=ee(R({slot:q.BigInt,status:NT})),kT=ee(oy);fr(kT);const qh=R({timestamp:q.BigInt,slot:q.BigInt,date:we()}),Wh=R({currentStreak:q.Integer,rate:se().optional(),count:q.Integer}),LT=R({address:q.EthAddress,lastProposal:qh.optional(),lastAttestation:qh.optional(),totalSlots:q.Integer,missedProposals:Wh,missedAttestations:Wh,history:oy}),$T=R({stats:fr(LT),lastProcessedSlot:q.BigInt.optional(),initialSlot:q.BigInt.optional(),slotWindow:q.Integer});class HT extends Error{constructor(e,t,n){super(`Expected component version ${e} to be ${t} but received ${n}`),this.name="ComponentsVersionsError"}}function DT(r){return({headers:e})=>{for(const t in r){const n=r[t];if(n!==void 0){const s=e.get(`x-aztec-${t}`);if(s!=null&&s!==n.toString())throw new HT(t,n.toString(),s)}}return Promise.resolve()}}const MT=R({finalisedBlockNumber:se().int().nonnegative(),latestBlockNumber:se().int().nonnegative(),latestBlockHash:we(),oldestHistoricBlockNumber:se().int().nonnegative(),treesAreSynched:et()}),UT={getL2Tips:ne().args().returns(uB),getWorldStateSyncStatus:ne().args().returns(MT),findLeavesIndexes:ne().args(Er,Ya(Ur),ee(C.Fr)).returns(ee(at(Rg(C.BigInt)))),getNullifierSiblingPath:ne().args(Er,C.BigInt).returns(Et.schemaFor(cc)),getNoteHashSiblingPath:ne().args(Er,C.BigInt).returns(Et.schemaFor(ig)),getL1ToL2MessageMembershipWitness:ne().args(Er,C.Fr).returns(ka([C.BigInt,Et.schemaFor(af)]).optional()),isL1ToL2MessageSynced:ne().args(C.Fr).returns(et()),getL2ToL1MessageMembershipWitness:ne().args(Er,C.Fr).returns(ka([C.BigInt,Et.schema])),getArchiveSiblingPath:ne().args(Er,C.BigInt).returns(Et.schemaFor(sg)),getPublicDataSiblingPath:ne().args(Er,C.BigInt).returns(Et.schemaFor(ba)),getNullifierMembershipWitness:ne().args(Er,C.Fr).returns(Ha.schema.optional()),getLowNullifierMembershipWitness:ne().args(Er,C.Fr).returns(Ha.schema.optional()),getPublicDataWitness:ne().args(Er,C.Fr).returns(gi.schema.optional()),getBlock:ne().args(Er).returns(bn.schema.optional()),getBlockNumber:ne().returns(se()),getProvenBlockNumber:ne().returns(se()),isReady:ne().returns(et()),getNodeInfo:ne().returns(ty),getBlocks:ne().args(se(),se()).returns(ee(bn.schema)),getPublishedBlocks:ne().args(se(),se()).returns(ee(lB)),getCurrentBaseFees:ne().returns(Ye.schema),getNodeVersion:ne().returns(we()),getVersion:ne().returns(se()),getChainId:ne().returns(se()),getL1ContractAddresses:ne().returns(ey),getProtocolContractAddresses:ne().returns(df),registerContractFunctionSignatures:ne().args(C.AztecAddress,ee(we())).returns(Hr()),getPrivateLogs:ne().args(se(),se()).returns(ee(Bt.schema)),getPublicLogs:ne().args(pc).returns(ny),getContractClassLogs:ne().args(pc).returns(ry),getLogsByTags:ne().args(ee(C.Fr)).returns(ee(ee(Aa.schema))),sendTx:ne().args(_r.schema).returns(Hr()),getTxReceipt:ne().args(Ge.schema).returns(ki.schema),getTxEffect:ne().args(Ge.schema).returns(Fg().optional()),getPendingTxs:ne().returns(ee(_r.schema)),getPendingTxCount:ne().returns(se()),getTxByHash:ne().args(Ge.schema).returns(_r.schema.optional()),getTxsByHash:ne().args(ee(Ge.schema)).returns(ee(_r.schema)),getPublicStorageAt:ne().args(Er,C.AztecAddress,C.Fr).returns(C.Fr),getBlockHeader:ne().args(at(Er)).returns(ct.schema.optional()),getValidatorsStats:ne().returns($T),simulatePublicCalls:ne().args(_r.schema,at(et())).returns(Wi.schema),isValidTx:ne().args(_r.schema,at(R({isSimulation:at(et()),skipFeeEnforcement:at(et())}))).returns(eB),getContractClass:ne().args(C.Fr).returns(gT.optional()),getContract:ne().args(C.AztecAddress).returns(ff.optional()),getEncodedEnr:ne().returns(we().optional())};function YI(r,e={},t=IT([1,2,3],!1),n=0){return PT(r,UT,{namespaceMethods:"node",fetch:t,batchWindowMS:n,onResponse:DT(e)})}const jT=Yt([R({address:C.AztecAddress,selector:C.FunctionSelector}),R({address:C.AztecAddress}),R({classId:C.Fr,selector:C.FunctionSelector}),R({classId:C.Fr})]),ZT=R({transactionPollingIntervalMS:se().optional(),maxTxsPerBlock:se().optional(),minTxsPerBlock:se().optional(),maxL2BlockGas:se().optional(),publishTxsWithProposals:et().optional(),maxDABlockGas:se().optional(),coinbase:C.EthAddress.optional(),feeRecipient:C.AztecAddress.optional(),acvmWorkingDirectory:we().optional(),acvmBinaryPath:we().optional(),txPublicSetupAllowList:ee(jT).optional(),maxBlockSizeInBytes:se().optional(),governanceProposerPayload:C.EthAddress.optional(),maxL1TxInclusionTimeIntoSlot:se().optional(),enforceTimeTable:et().optional()}),zT=R({nodeUrl:we().optional(),realProofs:et(),proverId:C.Fr.optional(),proverTestDelayType:Ka(["fixed","realistic"]),proverTestDelayMs:se(),proverTestDelayFactor:se(),proverAgentCount:se()});ne().args(ZT.merge(zT).partial()).returns(Hr()),ne().returns(Hr()),ne().args(we()).returns(Hr()),ne().args(se()).returns(Hr()),ne().returns(Hr()),ne().returns(Hr());const XI=["AuthRegistry","ContractInstanceDeployer","ContractClassRegisterer","MultiCallEntrypoint","FeeJuice","Router"],JI={AuthRegistry:new l(1),ContractInstanceDeployer:new l(1),ContractClassRegisterer:new l(1),MultiCallEntrypoint:new l(1),FeeJuice:new l(1),Router:new l(1)},to={AuthRegistry:W.fromBigInt(1n),ContractInstanceDeployer:W.fromBigInt(2n),ContractClassRegisterer:W.fromBigInt(3n),MultiCallEntrypoint:W.fromBigInt(4n),FeeJuice:W.fromBigInt(5n),Router:W.fromBigInt(6n)},QI={AuthRegistry:l.fromHexString("0x124c68f91ebca4ae30e2e315db95e9d4ff2d9c2ac20eb0e090276ebd71183b8a"),ContractInstanceDeployer:l.fromHexString("0x04987ac5bf6dfd35ed81e4e0c9cbc4d97d650c612a4ea55087f6e1ab39a4fef8"),ContractClassRegisterer:l.fromHexString("0x168d24baa470e778a7da8eabcf137d7837292c1e0bca83b615dcd0f084c23ac7"),MultiCallEntrypoint:l.fromHexString("0x16ced0efc954438f573dcdfed72292742a5774f92b53c0891d95f8d768fcfff3"),FeeJuice:l.fromHexString("0x2e5af996ae353ec0e1768a97412152dc85de7e619a64bb6abdb603ef5724eb83"),Router:l.fromHexString("0x1c380a3ce80d9bfd1247a4efc95ca1782d572e660ada6bd7ec90958e36833064")},e2=l.fromHexString("0x2efd3fd6b542f09e9f76c84337f46370f67729ce54c815d35866b4cb2a267203");l.fromHexString("0x20cd27645f65c15a38720ca984aef936592f3938a705db706d068ad13fc58ae9");l.fromHexString("0x0abf338154e355442d9916d630da0491036d5a7b23c42b477c1395ba3bf9b42d");l.fromHexString("0x27774539896271d6dbe0c1de45ddc44709d1e8d9a9fb686ca3c105d87c417bb8");l.fromHexString("0x2ec28b91a5f838506d6042915005ff55cf7a0a5f889a83b11faed33a31b486f2");new l(1534834688047131268740281708431107902615560100979874281215533519862n);function dn(r){if(typeof r!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(r))}function Gh(r,e){for(var t="",n=0,s=-1,i=0,a,o=0;o<=r.length;++o){if(o<r.length)a=r.charCodeAt(o);else{if(a===47)break;a=47}if(a===47){if(!(s===o-1||i===1))if(s!==o-1&&i===2){if(t.length<2||n!==2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){var c=t.lastIndexOf("/");if(c!==t.length-1){c===-1?(t="",n=0):(t=t.slice(0,c),n=t.length-1-t.lastIndexOf("/")),s=o,i=0;continue}}else if(t.length===2||t.length===1){t="",n=0,s=o,i=0;continue}}e&&(t.length>0?t+="/..":t="..",n=2)}else t.length>0?t+="/"+r.slice(s+1,o):t=r.slice(s+1,o),n=o-s-1;s=o,i=0}else a===46&&i!==-1?++i:i=-1}return t}function VT(r,e){var t=e.dir||e.root,n=e.base||(e.name||"")+(e.ext||"");return t?t===e.root?t+n:t+r+n:n}var Hi={resolve:function(){for(var e="",t=!1,n,s=arguments.length-1;s>=-1&&!t;s--){var i;s>=0?i=arguments[s]:(n===void 0&&(n=process.cwd()),i=n),dn(i),i.length!==0&&(e=i+"/"+e,t=i.charCodeAt(0)===47)}return e=Gh(e,!t),t?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(dn(e),e.length===0)return".";var t=e.charCodeAt(0)===47,n=e.charCodeAt(e.length-1)===47;return e=Gh(e,!t),e.length===0&&!t&&(e="."),e.length>0&&n&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return dn(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,t=0;t<arguments.length;++t){var n=arguments[t];dn(n),n.length>0&&(e===void 0?e=n:e+="/"+n)}return e===void 0?".":Hi.normalize(e)},relative:function(e,t){if(dn(e),dn(t),e===t||(e=Hi.resolve(e),t=Hi.resolve(t),e===t))return"";for(var n=1;n<e.length&&e.charCodeAt(n)===47;++n);for(var s=e.length,i=s-n,a=1;a<t.length&&t.charCodeAt(a)===47;++a);for(var o=t.length,c=o-a,f=i<c?i:c,h=-1,d=0;d<=f;++d){if(d===f){if(c>f){if(t.charCodeAt(a+d)===47)return t.slice(a+d+1);if(d===0)return t.slice(a+d)}else i>f&&(e.charCodeAt(n+d)===47?h=d:d===0&&(h=0));break}var v=e.charCodeAt(n+d),b=t.charCodeAt(a+d);if(v!==b)break;v===47&&(h=d)}var D="";for(d=n+h+1;d<=s;++d)(d===s||e.charCodeAt(d)===47)&&(D.length===0?D+="..":D+="/..");return D.length>0?D+t.slice(a+h):(a+=h,t.charCodeAt(a)===47&&++a,t.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(dn(e),e.length===0)return".";for(var t=e.charCodeAt(0),n=t===47,s=-1,i=!0,a=e.length-1;a>=1;--a)if(t=e.charCodeAt(a),t===47){if(!i){s=a;break}}else i=!1;return s===-1?n?"/":".":n&&s===1?"//":e.slice(0,s)},basename:function(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');dn(e);var n=0,s=-1,i=!0,a;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var o=t.length-1,c=-1;for(a=e.length-1;a>=0;--a){var f=e.charCodeAt(a);if(f===47){if(!i){n=a+1;break}}else c===-1&&(i=!1,c=a+1),o>=0&&(f===t.charCodeAt(o)?--o===-1&&(s=a):(o=-1,s=c))}return n===s?s=c:s===-1&&(s=e.length),e.slice(n,s)}else{for(a=e.length-1;a>=0;--a)if(e.charCodeAt(a)===47){if(!i){n=a+1;break}}else s===-1&&(i=!1,s=a+1);return s===-1?"":e.slice(n,s)}},extname:function(e){dn(e);for(var t=-1,n=0,s=-1,i=!0,a=0,o=e.length-1;o>=0;--o){var c=e.charCodeAt(o);if(c===47){if(!i){n=o+1;break}continue}s===-1&&(i=!1,s=o+1),c===46?t===-1?t=o:a!==1&&(a=1):t!==-1&&(a=-1)}return t===-1||s===-1||a===0||a===1&&t===s-1&&t===n+1?"":e.slice(t,s)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return VT("/",e)},parse:function(e){dn(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;var n=e.charCodeAt(0),s=n===47,i;s?(t.root="/",i=1):i=0;for(var a=-1,o=0,c=-1,f=!0,h=e.length-1,d=0;h>=i;--h){if(n=e.charCodeAt(h),n===47){if(!f){o=h+1;break}continue}c===-1&&(f=!1,c=h+1),n===46?a===-1?a=h:d!==1&&(d=1):a!==-1&&(d=-1)}return a===-1||c===-1||d===0||d===1&&a===c-1&&a===o+1?c!==-1&&(o===0&&s?t.base=t.name=e.slice(1,c):t.base=t.name=e.slice(o,c)):(o===0&&s?(t.name=e.slice(1,a),t.base=e.slice(1,c)):(t.name=e.slice(o,a),t.base=e.slice(o,c)),t.ext=e.slice(a,c)),o>0?t.dir=e.slice(0,o-1):s&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};Hi.posix=Hi;var t2=Hi;class ro{constructor(e,t,n,s=[]){u(this,"calls");u(this,"authWitnesses");u(this,"capsules");u(this,"extraHashedArgs");this.calls=e,this.authWitnesses=t,this.capsules=n,this.extraHashedArgs=s}static empty(){return new ro([],[],[])}}function Gu(r){const e=r.map(i=>i.calls).flat(),t=r.map(i=>i.authWitnesses??[]).flat(),n=r.map(i=>i.capsules??[]).flat(),s=r.map(i=>i.extraHashedArgs??[]).flat();return new ro(e,t,n,s)}class qT{constructor(e){u(this,"sender");this.sender=e}getAsset(){return Promise.resolve(to.FeeJuice)}getExecutionPayload(){return Promise.resolve(ro.empty())}getFeePayer(){return Promise.resolve(this.sender)}}function Kh(r,e=.1){return{totalGas:r.gasUsed.totalGas.mul(1+e),teardownGas:r.gasUsed.teardownGas.mul(1+e)}}const ko={ignoreDroppedReceiptsFor:5,timeout:60,interval:1};class hf{constructor(e,t){u(this,"pxeWalletOrNode");u(this,"txHashPromise");this.pxeWalletOrNode=e,this.txHashPromise=t}getTxHash(){return this.txHashPromise}async getReceipt(){const e=await this.getTxHash();return await this.pxeWalletOrNode.getTxReceipt(e)}async wait(e){const t=await this.waitForReceipt(e);if(t.status!==Fo.SUCCESS&&!(e!=null&&e.dontThrowOnRevert))throw new Error(`Transaction ${await this.getTxHash()} was ${t.status}. Reason: ${t.error??"unknown"}`);return t}async waitForReceipt(e){const t=await this.getTxHash(),n=Date.now(),s=(e==null?void 0:e.ignoreDroppedReceiptsFor)??ko.ignoreDroppedReceiptsFor;return await iy(async()=>{const i=await this.pxeWalletOrNode.getTxReceipt(t);if(i.status!==Fo.PENDING){if(i.status===Fo.DROPPED){const a=(Date.now()-n)/1e3;return!s||a>s?i:void 0}return i}},"isMined",(e==null?void 0:e.timeout)??ko.timeout,(e==null?void 0:e.interval)??ko.interval)}}class cy extends _r{constructor(t,n,s){super(n.data,n.clientIvcProof,n.contractClassLogs,n.publicFunctionCalldata);u(this,"wallet");u(this,"timings");this.wallet=t,this.timings=s}getPlainDataTx(){return new _r(this.data,this.clientIvcProof,this.contractClassLogs,this.publicFunctionCalldata)}send(){const t=this.wallet.sendTx(this.getPlainDataTx());return new hf(this.wallet,t)}}class uy{constructor(e,t=[],n=[]){u(this,"wallet");u(this,"authWitnesses");u(this,"capsules");u(this,"log");this.wallet=e,this.authWitnesses=t,this.capsules=n,this.log=Fs("aztecjs:contract_interaction")}async proveInternal(e={}){const t=await this.create(e);return await this.wallet.proveTx(t)}async prove(e={}){const t=await this.proveInternal(e);return new cy(this.wallet,t.toTx(),t.timings)}send(e={}){const t=(async()=>{const n=await this.proveInternal(e);return this.wallet.sendTx(n.toTx())})();return new hf(this.wallet,t)}async estimateGas(e){var a;const t=await this.create({...e,fee:{...e==null?void 0:e.fee,estimateGas:!1}}),n=await this.wallet.simulateTx(t,!0,void 0,void 0,!0),{totalGas:s,teardownGas:i}=Kh(n,(a=e==null?void 0:e.fee)==null?void 0:a.estimatedGasPadding);return{gasLimits:s,teardownGasLimits:i}}async getDefaultFeeOptions(e){var i;const t=((i=e==null?void 0:e.gasSettings)==null?void 0:i.maxFeesPerGas)??(await this.wallet.getCurrentBaseFees()).mul(1+((e==null?void 0:e.baseFeePadding)??.5)),n=(e==null?void 0:e.paymentMethod)??new qT(this.wallet.getAddress()),s=qt.default({...e==null?void 0:e.gasSettings,maxFeesPerGas:t});return this.log.debug("Using L2 gas settings",s),{gasSettings:s,paymentMethod:n}}async getFeeOptions(e,t={},n){const s=await this.getDefaultFeeOptions(t),i=s.paymentMethod,a=s.gasSettings.maxFeesPerGas,o=s.gasSettings.maxPriorityFeesPerGas;let c=s.gasSettings;if(t!=null&&t.estimateGas){const f={paymentMethod:i,gasSettings:c},h=await this.wallet.createTxExecutionRequest(e,f,n),d=await this.wallet.simulateTx(h,!0,void 0,void 0,!0),{totalGas:v,teardownGas:b}=Kh(d,t==null?void 0:t.estimatedGasPadding);c=qt.from({maxFeesPerGas:a,maxPriorityFeesPerGas:o,gasLimits:v,teardownGasLimits:b}),this.log.verbose(`Estimated gas limits for tx: DA=${v.daGas} L2=${v.l2Gas} teardownDA=${b.daGas} teardownL2=${b.l2Gas}`)}return{gasSettings:c,paymentMethod:i}}}class $c extends uy{constructor(t,n,s,i,a=[],o=[],c=[]){super(t,a,o);u(this,"contractAddress");u(this,"functionDao");u(this,"args");u(this,"extraHashedArgs");if(this.contractAddress=n,this.functionDao=s,this.args=i,this.extraHashedArgs=c,i.some(f=>f==null))throw new Error(`All function interaction arguments must be defined and not null. Received: ${i}`)}async create(t={}){if(this.functionDao.functionType===tr.UTILITY)throw new Error("Can't call `create` on a utility  function.");const n=await this.request(t),{fee:s,nonce:i,cancellable:a}=t,o=await this.getFeeOptions(n,s,{nonce:i,cancellable:a});return await this.wallet.createTxExecutionRequest(n,o,{nonce:i,cancellable:a})}async request(t={}){const n=bg(this.functionDao,this.args),s=[{name:this.functionDao.name,args:n,selector:await ze.fromNameAndParameters(this.functionDao.name,this.functionDao.parameters),type:this.functionDao.functionType,to:this.contractAddress,isStatic:this.functionDao.isStatic,returnTypes:this.functionDao.returnTypes}],{authWitnesses:i,capsules:a}=t;return new ro(s,this.authWitnesses.concat(i??[]),this.capsules.concat(a??[]),this.extraHashedArgs)}async simulate(t={}){var o;if(this.functionDao.functionType==tr.UTILITY){const c=await this.wallet.simulateUtility(this.functionDao.name,this.args,this.contractAddress,t.authWitnesses??[],t==null?void 0:t.from);return t.includeMetadata?{meta:{timings:c.timings},result:c.result}:c.result}const n=await this.create(t),s=await this.wallet.simulateTx(n,!0,t.from,t.skipTxValidation,t.skipFeeEnforcement??!0);let i;this.functionDao.functionType==tr.PRIVATE?s.getPrivateReturnValues().nested.length>0?i=s.getPrivateReturnValues().nested[0].values:i=s.getPrivateReturnValues().values:i=(o=s.getPublicReturnValues())==null?void 0:o[0].values;const a=i?dA(this.functionDao.returnTypes,i):[];return t.includeMetadata?{meta:{timings:s.timings},result:a}:a}async profile(t={profileMode:"gates",skipProofGeneration:!0}){if(this.functionDao.functionType==tr.UTILITY)throw new Error("Can't profile a utility function.");const{authWitnesses:n,capsules:s,fee:i}=t,a=await this.create({fee:i,authWitnesses:n,capsules:s});return await this.wallet.profileTx(a,t.profileMode,t.skipProofGeneration,t==null?void 0:t.from)}with({authWitnesses:t=[],capsules:n=[],extraHashedArgs:s=[]}){return new $c(this.wallet,this.contractAddress,this.functionDao,this.args,this.authWitnesses.concat(t),this.capsules.concat(n),this.extraHashedArgs.concat(s))}}class Hc{constructor(e,t,n){u(this,"instance");u(this,"artifact");u(this,"wallet");u(this,"methods");this.instance=e,this.artifact=t,this.wallet=n,this.methods={},Pc(t).forEach(s=>{const i=(...a)=>new $c(this.wallet,this.instance.address,s,a);this.methods[s.name]=Object.assign(i,{selector(){return ze.fromNameAndParameters(s.name,s.parameters)}})})}get address(){return this.instance.address}get partialAddress(){return Nc(this.instance)}withWallet(e){return new Hc(this.instance,this.artifact,e)}}class mf extends Hc{constructor(e,t,n){super(e,t,n)}}async function WT(r){const{contractInstance:e}=await r.getContractMetadata(to.ContractClassRegisterer);if(!e)throw new Error("ContractClassRegisterer is not registered in this wallet's instance");const{artifact:t}=await r.getContractClassMetadata(e.currentContractClassId,!0);return new mf(e,t,r)}async function GT(r){const{contractInstance:e}=await r.getContractMetadata(to.ContractInstanceDeployer);if(!e)throw new Error("ContractInstanceDeployer is not registered in this wallet's instance");const{artifact:t}=await r.getContractClassMetadata(e.currentContractClassId,!0);return new mf(e,t,r)}async function r2(r){const{contractInstance:e}=await r.getContractMetadata(to.FeeJuice);if(!e)throw new Error("FeeJuice is not registered in this wallet's instance");const{artifact:t}=await r.getContractClassMetadata(e.currentContractClassId,!0);return new mf(e,t,r)}async function KT(r,e){const t=await GT(r),{salt:n,currentContractClassId:s,publicKeys:i,deployer:a}=e,o=a.isZero();if(!o&&!r.getAddress().equals(a))throw new Error(`Expected deployer ${a.toString()} does not match sender wallet ${r.getAddress().toString()}`);return t.methods.deploy(n,s,e.initializationHash,i,o)}async function YT(r,e){const{artifactHash:t,privateFunctionsRoot:n,publicBytecodeCommitment:s,packedBytecode:i}=await Lc(e),a=await WT(r),o=yg(i,Tl);return a.methods.register(t,n,s).with({capsules:[new es(to.ContractClassRegisterer,new l(W1),o)]})}class ly extends hf{constructor(t,n,s,i){super(t,n);u(this,"postDeployCtor");u(this,"instanceGetter");u(this,"log");this.postDeployCtor=s,this.instanceGetter=i,this.log=Fs("aztecjs:deploy_sent_tx")}async deployed(t){const n=await this.wait(t),s=await this.instanceGetter();return this.log.info(`Contract ${s.address.toString()} successfully deployed.`),n.contract}async wait(t){const n=await super.wait(t),s=await this.getContractObject(t==null?void 0:t.wallet);return{...n,contract:s}}async getContractObject(t){const s=t??((a=>!!a.createTxExecutionRequest)(this.pxeWalletOrNode)&&this.pxeWalletOrNode);if(!s)throw new Error("A wallet is required for creating a contract instance");const i=await this.instanceGetter();return this.postDeployCtor(i.address,s)}}class XT extends cy{constructor(t,n,s,i,a){super(t,n,a);u(this,"postDeployCtor");u(this,"instanceGetter");this.postDeployCtor=s,this.instanceGetter=i}send(){const t=this.wallet.sendTx(this.getPlainDataTx());return new ly(this.wallet,t,this.postDeployCtor,this.instanceGetter)}}class bc extends uy{constructor(t,n,s,i,a=[],o,c=[],f=[]){super(n,c,f);u(this,"publicKeys");u(this,"artifact");u(this,"postDeployCtor");u(this,"args");u(this,"instance");u(this,"constructorArtifact");this.publicKeys=t,this.artifact=s,this.postDeployCtor=i,this.args=a,this.instance=void 0,this.constructorArtifact=kA(s,o)}async create(t={}){const n=await this.request(t),{fee:s,nonce:i,cancellable:a}=t,o=await this.getFeeOptions(n,s,{nonce:i,cancellable:a});return this.wallet.createTxExecutionRequest(n,o,{nonce:i,cancellable:a})}async request(t={}){const n=await this.getDeploymentExecutionPayload(t);await this.wallet.registerContract({artifact:this.artifact,instance:await this.getInstance(t)});const s=await this.getInitializeExecutionPayload(t),i=[n,s];if(!i.map(o=>o.calls).flat().length)throw new Error(`No function calls needed to deploy contract ${this.artifact.name}`);return Gu(i)}async profile(t={profileMode:"gates",skipProofGeneration:!0}){const n=await this.create(t);return await this.wallet.profileTx(n,t.profileMode,t.skipProofGeneration,t==null?void 0:t.from)}async register(t={}){const n=await this.getInstance(t);return await this.wallet.registerContract({artifact:this.artifact,instance:n}),this.postDeployCtor(n.address,this.wallet)}async getDeploymentExecutionPayload(t={}){const n=[],s=await this.getInstance(t),i=await Lc(this.artifact);if(!s.currentContractClassId.equals(i.id))throw new Error(`Contract class mismatch when deploying contract: got ${s.currentContractClassId.toString()} from instance and ${i.id.toString()} from artifact`);if(!t.skipClassRegistration)if((await this.wallet.getContractClassMetadata(i.id)).isContractClassPubliclyRegistered)this.log.debug(`Skipping registration of already registered contract class ${i.id.toString()} for ${s.address.toString()}`);else{this.log.info(`Creating request for registering contract class ${i.id.toString()} as part of deployment for ${s.address.toString()}`);const a=await YT(this.wallet,this.artifact);n.push(await a.request())}if(!t.skipPublicDeployment){const a=await KT(this.wallet,s);n.push(await a.request())}return Gu(n)}async getInitializeExecutionPayload(t){const n=[];if(this.constructorArtifact&&!t.skipInitialization){const{address:s}=await this.getInstance(t),i=new $c(this.wallet,s,this.constructorArtifact,this.args);n.push(await i.request())}return Gu(n)}send(t={}){const n=super.send(t).getTxHash();return this.log.debug(`Sent deployment tx of ${this.artifact.name} contract`),new ly(this.wallet,n,this.postDeployCtor,()=>this.getInstance(t))}async getInstance(t={}){return this.instance||(this.instance=await cT(this.artifact,{constructorArgs:this.args,salt:t.contractAddressSalt,publicKeys:this.publicKeys,constructorArtifact:this.constructorArtifact,deployer:t.universalDeploy?W.ZERO:this.wallet.getAddress()})),this.instance}async prove(t){const n=await this.proveInternal(t);return new XT(this.wallet,n.toTx(),this.postDeployCtor,()=>this.getInstance(t),n.timings)}estimateGas(t){return super.estimateGas(t)}get address(){var t;return(t=this.instance)==null?void 0:t.address}get partialAddress(){return this.instance&&Nc(this.instance)}with({authWitnesses:t=[],capsules:n=[]}){var s;return new bc(this.publicKeys,this.wallet,this.artifact,this.postDeployCtor,this.args,(s=this.constructorArtifact)==null?void 0:s.name,this.authWitnesses.concat(t),this.capsules.concat(n))}}class Lo extends Hc{static async at(e,t,n){const s=(await n.getContractMetadata(e)).contractInstance;if(s===void 0)throw new Error(`Contract instance at ${e.toString()} has not been registered in the wallet's PXE`);const i=await Lc(t);return i.id.equals(s.currentContractClassId)||(await n.updateContract(e,t),s.currentContractClassId=i.id),new Lo(s,t,n)}static deploy(e,t,n,s){const i=(a,o)=>Lo.at(a,t,o);return new bc(Gt.default(),e,t,i,n,s)}static deployWithPublicKeys(e,t,n,s,i){const a=(o,c)=>Lo.at(o,n,c);return new bc(e,t,n,a,s,i)}}const Yh={provenTimeout:600,interval:ko.interval};async function n2(r,e,t){if(!e.blockNumber)throw new Error(`Cannot wait for proven: receipt of tx ${e.txHash} does not have a block number`);return await iy(async()=>{const n=await r.getProvenBlockNumber();return n>=e.blockNumber?n:void 0},"isProven",(t==null?void 0:t.provenTimeout)??Yh.provenTimeout,(t==null?void 0:t.interval)??Yh.interval)}export{Et as $,eI as A,$c as B,es as C,bc as D,gr as E,tr as F,qT as G,W as H,qt as I,dA as J,ro as K,r2 as L,iI as M,uy as N,Gu as O,to as P,La as Q,W1 as R,TT as S,AT as T,BT as U,cf as V,ue as W,sy as X,Tn as Y,Qe as Z,Ep as _,ze as a,Yx as a$,q1 as a0,Ur as a1,yI as a2,_I as a3,AA as a4,vA as a5,wA as a6,Qn as a7,RI as a8,_r as a9,LI as aA,$I as aB,Pc as aC,NI as aD,kI as aE,yc as aF,YT as aG,KT as aH,hc as aI,ko as aJ,hf as aK,cy as aL,Hc as aM,ly as aN,n2 as aO,Yh as aP,cT as aQ,II as aR,YI as aS,Rm as aT,rx as aU,Ht as aV,Ms as aW,pr as aX,Wr as aY,iS as aZ,Wx as a_,gn as aa,Ge as ab,ki as ac,Fo as ad,$t as ae,It as af,As as ag,bn as ah,Vr as ai,Ba as aj,_a as ak,Tr as al,GI as am,un as an,Vp as ao,Gx as ap,eS as aq,Cg as ar,Vn as as,nn as at,bg as au,aA as av,ag as aw,oA as ax,uA as ay,cA as az,BB as b,Jx as b$,le as b0,J as b1,H1 as b2,sS as b3,ya as b4,R as b5,q as b6,aI as b7,ZI as b8,cB as b9,Xn as bA,tI as bB,Xs as bC,dt as bD,Xe as bE,Ee as bF,mI as bG,dI as bH,Ja as bI,fI as bJ,xI as bK,zx as bL,ba as bM,pn as bN,tn as bO,M1 as bP,Ys as bQ,cI as bR,Je as bS,$r as bT,Br as bU,rI as bV,wa as bW,nI as bX,sI as bY,Ut as bZ,ut as b_,zI as ba,jI as bb,Hs as bc,Bs as bd,Xi as be,fi as bf,Qx as bg,XI as bh,QI as bi,ft as bj,WI as bk,Vx as bl,eE as bm,qx as bn,oB as bo,tt as bp,va as bq,Ts as br,Ea as bs,xs as bt,jr as bu,Is as bv,ms as bw,Ci as bx,Ro as by,Ou as bz,Fs as c,pA as c$,ys as c0,fc as c1,lI as c2,ig as c3,HI as c4,cc as c5,Kn as c6,gA as c7,Wt as c8,ct as c9,xe as cA,hr as cB,En as cC,Ct as cD,vn as cE,Ye as cF,Bt as cG,Fn as cH,Zr as cI,an as cJ,Rn as cK,Li as cL,xr as cM,dc as cN,pI as cO,er as cP,hI as cQ,Ar as cR,Cn as cS,Pn as cT,ur as cU,tT as cV,DI as cW,MI as cX,UI as cY,mr as cZ,$1 as c_,yi as ca,bA as cb,Ss as cc,wt as cd,nt as ce,Ma as cf,Lt as cg,zr as ch,bI as ci,vI as cj,wI as ck,oI as cl,ws as cm,PI as cn,uI as co,sh as cp,Ni as cq,Da as cr,Xx as cs,__ as ct,rs as cu,NA as cv,or as cw,ke as cx,cr as cy,Kx as cz,nT as d,PB as d0,NB as d1,qI as d2,EI as d3,CI as d4,TI as d5,ip as d6,SA as d7,No as d8,hg as d9,dB as da,J_ as db,mA as dc,Sa as dd,Bh as de,Si as df,JI as dg,BI as dh,gI as di,mg as dj,Pd as dk,Yl as dl,AI as dm,FI as dn,OI as dp,og as dq,VI as e,l as f,aT as g,RB as h,OB as i,xB as j,Lc as k,oT as l,WT as m,yg as n,Kl as o,t2 as p,Gt as q,Lo as r,C1 as s,SI as t,IT as u,PT as v,DT as w,e2 as x,KI as y,iy as z};
